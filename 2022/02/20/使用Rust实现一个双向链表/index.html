<!DOCTYPE html>
<html>

<head><meta name="generator" content="Hexo 3.9.0">
  <script type="text/javascript" src="https://cdn.bootcdn.net/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <script type="text/javascript" src="/js/jquery.goup.min.js" defer></script>
  
  <title>ä½¿ç”¨Rustå®ç°ä¸€ä¸ªåŒå‘é“¾è¡¨ - å¼ å°å‡¯çš„åšå®¢</title>
  <meta charset="UTF-8">
  <meta name="description" content="è¬™è™šã¯äººã‚’é€²æ­©ã•ã›ã€ã”ã†ã¾ã‚“ã¯äººã‚’è½å¾Œã•ã›ã‚‹ã€‚ç¤¾ä¼šã®åˆå¿ƒè€…ã‹ã‚‰ã€ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™ï¼">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  

  <link rel="shortcut icon" href="/favicon.ico" type="image/png">
  <meta name="description" content="å¦‚ä½•æ¿€æ€’ä¸€ä¸ªRustçˆ±å¥½è€…ï¼Ÿè®©ä»–ç”¨Rustå®ç°ä¸€ä¸ªåŒå‘é“¾è¡¨å³å¯ï¼æ€»æ‰€å‘¨çŸ¥ï¼ŒRustä¸­æ˜¯ä¸èƒ½åŒæ—¶å­˜åœ¨ä¸¤ä¸ªå¯å˜å¼•ç”¨çš„ï¼Œæ‰€ä»¥åœ¨Rustä¸­å®ç°åŒå‘é“¾è¡¨å°±ä¼šå˜å¾—éå¸¸åäººç±»ï¼ˆå› ä¸ºéœ€è¦åŒæ—¶å­˜åœ¨å‰åèŠ‚ç‚¹åŒæ—¶æŒ‡å‘å¯¹æ–¹çš„æƒ…å†µï¼‰ï¼›åŒæ—¶ï¼ŒåŒå‘é“¾è¡¨ä¹Ÿå¼•å…¥äº†å¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼Œè¿™ä¹Ÿæ˜¯å¯¼è‡´å†…å­˜éš¾ä»¥é‡Šæ”¾çš„ä¸€ä¸ªåœºæ™¯ï¼›æ²¡æƒ³åˆ°ä¸€ä¸ªç®€ç®€å•å•çš„åŒå‘é“¾è¡¨å±…ç„¶æ¶‰åŠå¦‚æ­¤ä¹‹å¤šçš„é—®é¢˜ï¼æœ¬æ–‡å°±ä½¿ç”¨Unsafe Rustå®ç°äº†åŒå‘é“¾è¡¨ï¼›">
<meta name="keywords" content="ç®—æ³•,Rust">
<meta property="og:type" content="article">
<meta property="og:title" content="ä½¿ç”¨Rustå®ç°ä¸€ä¸ªåŒå‘é“¾è¡¨">
<meta property="og:url" content="https://jasonkayzk.github.io/2022/02/20/ä½¿ç”¨Rustå®ç°ä¸€ä¸ªåŒå‘é“¾è¡¨/index.html">
<meta property="og:site_name" content="å¼ å°å‡¯çš„åšå®¢">
<meta property="og:description" content="å¦‚ä½•æ¿€æ€’ä¸€ä¸ªRustçˆ±å¥½è€…ï¼Ÿè®©ä»–ç”¨Rustå®ç°ä¸€ä¸ªåŒå‘é“¾è¡¨å³å¯ï¼æ€»æ‰€å‘¨çŸ¥ï¼ŒRustä¸­æ˜¯ä¸èƒ½åŒæ—¶å­˜åœ¨ä¸¤ä¸ªå¯å˜å¼•ç”¨çš„ï¼Œæ‰€ä»¥åœ¨Rustä¸­å®ç°åŒå‘é“¾è¡¨å°±ä¼šå˜å¾—éå¸¸åäººç±»ï¼ˆå› ä¸ºéœ€è¦åŒæ—¶å­˜åœ¨å‰åèŠ‚ç‚¹åŒæ—¶æŒ‡å‘å¯¹æ–¹çš„æƒ…å†µï¼‰ï¼›åŒæ—¶ï¼ŒåŒå‘é“¾è¡¨ä¹Ÿå¼•å…¥äº†å¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼Œè¿™ä¹Ÿæ˜¯å¯¼è‡´å†…å­˜éš¾ä»¥é‡Šæ”¾çš„ä¸€ä¸ªåœºæ™¯ï¼›æ²¡æƒ³åˆ°ä¸€ä¸ªç®€ç®€å•å•çš„åŒå‘é“¾è¡¨å±…ç„¶æ¶‰åŠå¦‚æ­¤ä¹‹å¤šçš„é—®é¢˜ï¼æœ¬æ–‡å°±ä½¿ç”¨Unsafe Rustå®ç°äº†åŒå‘é“¾è¡¨ï¼›">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://raw.gitmirror.com/JasonkayZK/blog_static/master/images/rust-double-linked-list-1.svg">
<meta property="og:image" content="https://raw.gitmirror.com/JasonkayZK/blog_static/master/images/rust-double-linked-list-2.jpg">
<meta property="og:updated_time" content="2026-02-10T12:07:45.756Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ä½¿ç”¨Rustå®ç°ä¸€ä¸ªåŒå‘é“¾è¡¨">
<meta name="twitter:description" content="å¦‚ä½•æ¿€æ€’ä¸€ä¸ªRustçˆ±å¥½è€…ï¼Ÿè®©ä»–ç”¨Rustå®ç°ä¸€ä¸ªåŒå‘é“¾è¡¨å³å¯ï¼æ€»æ‰€å‘¨çŸ¥ï¼ŒRustä¸­æ˜¯ä¸èƒ½åŒæ—¶å­˜åœ¨ä¸¤ä¸ªå¯å˜å¼•ç”¨çš„ï¼Œæ‰€ä»¥åœ¨Rustä¸­å®ç°åŒå‘é“¾è¡¨å°±ä¼šå˜å¾—éå¸¸åäººç±»ï¼ˆå› ä¸ºéœ€è¦åŒæ—¶å­˜åœ¨å‰åèŠ‚ç‚¹åŒæ—¶æŒ‡å‘å¯¹æ–¹çš„æƒ…å†µï¼‰ï¼›åŒæ—¶ï¼ŒåŒå‘é“¾è¡¨ä¹Ÿå¼•å…¥äº†å¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼Œè¿™ä¹Ÿæ˜¯å¯¼è‡´å†…å­˜éš¾ä»¥é‡Šæ”¾çš„ä¸€ä¸ªåœºæ™¯ï¼›æ²¡æƒ³åˆ°ä¸€ä¸ªç®€ç®€å•å•çš„åŒå‘é“¾è¡¨å±…ç„¶æ¶‰åŠå¦‚æ­¤ä¹‹å¤šçš„é—®é¢˜ï¼æœ¬æ–‡å°±ä½¿ç”¨Unsafe Rustå®ç°äº†åŒå‘é“¾è¡¨ï¼›">
<meta name="twitter:image" content="https://raw.gitmirror.com/JasonkayZK/blog_static/master/images/rust-double-linked-list-1.svg">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdui@0.4.3/dist/css/mdui.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.16.2/styles/atom-one-dark.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">
  
  
  <link rel="stylesheet" href="//at.alicdn.com/t/font_1038733_0xvrvpg9c0r.css">
  <link rel="stylesheet" href="/css/style.css?v=1770725320746">

  <!-- è¿›åº¦æ¡åŠ è½½: nprogress -->
  <link href="https://cdn.bootcss.com/nprogress/0.2.0/nprogress.min.css" rel="stylesheet">
  <script src="https://cdn.bootcss.com/nprogress/0.2.0/nprogress.min.js"></script>

  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6617852905105366" crossorigin="anonymous"></script>
  <!-- Cloudflare Web Analytics -->
   <script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{"token": "73d46a730654451bac205cdc12bea918"}"></script>
  <!-- umami Web Analytics -->
  <script defer src="https://cloud.umami.is/script.js" data-website-id="23fadd4b-d559-4ae0-a4f6-f90680c3d4c0"></script>

  <!-- æœ¬åœ°æœç´¢js -->
  <script type="text/javascript" src="/js/search.js"></script>

  <!-- ç™¾åº¦ç«™ç‚¹ç®¡ç† -->
  <meta name="baidu-site-verification" content="code-SKIvb4A1Qx">

  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-1NWK4EEKDF');
  </script>

  <!-- ç«™å†…é€šçŸ¥ -->
  <link href="https://apps.bdimg.com/libs/bootstrap/3.3.4/css/bootstrap.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" type="text/css" href="/css/default.css">
  <link rel="stylesheet" href="/css/animate.min.css">
  <link rel="stylesheet" href="/css/notification.css">
  <link rel="stylesheet" href="/css/index.css">
<link rel="alternate" href="/atom.xml" title="å¼ å°å‡¯çš„åšå®¢" type="application/atom+xml">
</head>

<!-- æ–‡ç« é˜…è¯»è¿›åº¦æ¡æ ·å¼ -->
<style>
  #content_progress {
      /* Positioning */
      position: fixed;
      left: 0;
      top: 0;
      z-index: 99999;
      width: 100%;
      height: 3px;
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
      border: none;
      background-color: transparent;
      color: #ffaa73;
}

#content_progress::-webkit-progress-bar {
      background-color: transparent;
}

#content_progress::-webkit-progress-value {
      background-color: #ffaa73;
}

#content_progress::-moz-progress-bar {
      background-color:#ffaa73;
}
</style>
<!-- æ–‡ç« é˜…è¯»è¿›åº¦æ¡JS -->
<script>
  document.addEventListener('DOMContentLoaded', function () {
      var winHeight = window.innerHeight,
            docHeight = document.documentElement.scrollHeight,
            progressBar = document.querySelector('#content_progress');
      progressBar.max = docHeight - winHeight;
      progressBar.value = window.scrollY;

      document.addEventListener('scroll', function () {
            progressBar.max = document.documentElement.scrollHeight - window.innerHeight;
            progressBar.value = window.scrollY;
      });
});
</script>

<body class="mdui-drawer-body-left">
  <!-- æ–‡ç« é˜…è¯»è¿›åº¦æ¡ -->
  <progress id="content_progress" value="0"></progress>

  <!-- éŸ³é¢‘æ’­æ”¾ -->
  <!-- <link rel="stylesheet" href="/dist/APlayer.min.css">
  <div id="aplayer"></div>
  <script type="text/javascript" src="/dist/APlayer.min.js"></script>
  <script type="text/javascript" src="/dist/music.js"></script> -->

  
  <div id="nexmoe-background">
    <div class="nexmoe-bg" style="background-image: url(/images/bg.jpg)"></div>
    <div class="mdui-appbar mdui-shadow-0">
      <div class="mdui-toolbar">
        <a mdui-drawer="{target: '#drawer', swipe: true}" title="menu" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">menu</i></a>
        <div class="mdui-toolbar-spacer"></div>
        <a href="/" title="Jasonkay" class="mdui-btn mdui-btn-icon"><img src="/images/avatar4.jpg"></a>
      </div>
    </div>
  </div>
  <div id="nexmoe-header">
    <div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="Jasonkay">
            <img src="/images/avatar4.jpg" alt="Jasonkay">
        </a>
    </div>

    <!-- é»‘ç™½åˆ‡æ¢css -->
    <!-- <style>
        .light-dark-checkbox {
            margin: 0 auto;
        }

        /* The switch - the box around the slider */
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        /* Hide default HTML checkbox */
        .switch .theme-switcher {
            opacity: 0;
            width: 0;
            height: 0;
        }

        /* The slider */
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            transition: 0.4s;
        }

        .slider:before {
            position: absolute;
            content: "ğŸŒ";
            height: 0px;
            width: 0px;
            left: -10px;
            top: 16px;
            line-height: 0px;
            transition: 0.4s;
        }

        .theme-switcher:checked+.slider:before {
            left: 35px;
            content: "ğŸŒ‘";
        }

        .theme-switcher:checked+.slider:before {
            transform: translateX(45px);
        }

        /* Rounded sliders */
        .slider.round {
            border-radius: 40px;
        }

        .slider.round:before {
            border-radius: 50%;
        }

        /* æš—é»‘æ ·å¼ */
        body.night {
            background-color: #263238;
            color: #aaa;
        }
        body.night img {
            filter: brightness(30%);
        }
        article.night {
            background-color: black;
            color: white;
        }
    </style> -->

    <!-- é»‘ç™½å¼€å…³ -->
    <!-- <div class="nexmoe-list-item mdui-list-item">
        <div class="light-dark-checkbox">
            <div>
                é»‘ç™½æ¨¡å¼åˆ‡æ¢(Beta)
            </div>
            <label class="switch">
                <input id="light-dark-input" type="checkbox" onclick="switchTheme();" class="theme-switcher">
                <span class="slider round"></span>
            </label>
        </div>
    </div> -->

    <!-- é»‘ç™½åˆ‡æ¢js -->
    <!-- <script>
        // get hours of the day in 24Hr format (0-23)
        var hr = (new Date()).getHours();

        $(document).ready(function () {
            var theme = sessionStorage.getItem("theme");
            if (theme == "dark") {
                document.body.classList.add('night');
                console.log('å¤œé—´æ¨¡å¼å¼€å¯');
            } else if (theme == "light") {
                document.body.classList.remove('night');
                console.log('å¤œé—´æ¨¡å¼å…³é—­');
            } else {
                setDefaultTheme(hr);
            }
        });

        function switchTheme() {
            if (sessionStorage.getItem("theme") == "dark") {
                sessionStorage.setItem("theme", "light");
                document.body.classList.remove('night');
                console.log('å¤œé—´æ¨¡å¼å…³é—­');
            } else if (sessionStorage.getItem("theme") == "light") {
                sessionStorage.setItem("theme", "dark");
                document.body.classList.add('night');
                console.log('å¤œé—´æ¨¡å¼å¼€å¯');
            } else {
                setDefaultTheme(hr);
            }
        };

        function setDefaultTheme(curHr) {
            // 6:00-18:00 light
            if (curHr >= 6 && curHr <= 18) {
                document.body.classList.remove('night');
                console.log('å¤œé—´æ¨¡å¼å…³é—­');
                sessionStorage.setItem("theme", "light");
                $("#light-dark-input").attr("checked", false);
            } else {
                // 0:00-6:00 & 18:00-00:00 night
                sessionStorage.setItem("theme", "dark");
                document.body.classList.add('night');
                console.log('å¤œé—´æ¨¡å¼å¼€å¯');
                $("#light-dark-input").attr("checked", true);
            }
        }
    </script> -->

    <div class="nexmoe-count">
        <div><span>æ–‡ç« </span>522</div>
        <div><span>æ ‡ç­¾</span>277</div>
        <div><span>åˆ†ç±»</span>67</div>
    </div>
    <ul class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/" title="å›åˆ°é¦–é¡µ">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                å›åˆ°é¦–é¡µ
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/jp/" title="æ—¥è¯­åˆ†ç«™">
            <i class="mdui-list-item-icon nexmoefont icon-calendar-fill"></i>
            <div class="mdui-list-item-content">
                æ—¥è¯­åˆ†ç«™
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/about/" title="å…³äºåšå®¢">
            <i class="mdui-list-item-icon nexmoefont icon-eye-fill"></i>
            <div class="mdui-list-item-content">
                å…³äºåšå®¢
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/archive" title="æ–‡ç« å½’æ¡£">
            <i class="mdui-list-item-icon nexmoefont icon-container"></i>
            <div class="mdui-list-item-content">
                æ–‡ç« å½’æ¡£
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/anki/" title="Ankiç¬”è®°">
            <i class="mdui-list-item-icon nexmoefont icon-tag-fill"></i>
            <div class="mdui-list-item-content">
                Ankiç¬”è®°
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/study/" title="å­¦ä¹ è¿›åº¦">
            <i class="mdui-list-item-icon nexmoefont icon-telegram"></i>
            <div class="mdui-list-item-content">
                å­¦ä¹ è¿›åº¦
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/running/" title="è·‘æ­¥å¥èº«">
            <i class="mdui-list-item-icon nexmoefont icon-dribbble"></i>
            <div class="mdui-list-item-content">
                è·‘æ­¥å¥èº«
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/interview/" title="é¢è¯•ç›¸å…³">
            <i class="mdui-list-item-icon nexmoefont icon-container"></i>
            <div class="mdui-list-item-content">
                é¢è¯•ç›¸å…³
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/algorithm/" title="ç®—æ³•æ€»ç»“">
            <i class="mdui-list-item-icon nexmoefont icon-areachart"></i>
            <div class="mdui-list-item-content">
                ç®—æ³•æ€»ç»“
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/installing/" title="è½¯ä»¶å®‰è£…">
            <i class="mdui-list-item-icon nexmoefont icon-unorderedlist"></i>
            <div class="mdui-list-item-content">
                è½¯ä»¶å®‰è£…
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/board/" title="åˆ›æ„ç™½æ¿">
            <i class="mdui-list-item-icon nexmoefont icon-tag-fill"></i>
            <div class="mdui-list-item-content">
                åˆ›æ„ç™½æ¿
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="http://159.75.131.252:32352/" title="æ‘„å½±åˆ†äº«">
            <i class="mdui-list-item-icon nexmoefont icon-telegram"></i>
            <div class="mdui-list-item-content">
                æ‘„å½±åˆ†äº«
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/chat/" title="ç•…æ‰€æ¬²è¨€">
            <i class="mdui-list-item-icon nexmoefont icon-ellipsis"></i>
            <div class="mdui-list-item-content">
                ç•…æ‰€æ¬²è¨€
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/realtime/" title="å®æ—¶æ•°æ®ç»Ÿè®¡">
            <i class="mdui-list-item-icon nexmoefont icon-time-circle-fill"></i>
            <div class="mdui-list-item-content">
                å®æ—¶æ•°æ®ç»Ÿè®¡
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/py/" title="å‹æƒ…é“¾æ¥">
            <i class="mdui-list-item-icon nexmoefont icon-container"></i>
            <div class="mdui-list-item-content">
                å‹æƒ…é“¾æ¥
            </div>
        </a>
        
    </ul>
    <aside id="nexmoe-sidebar">
  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">ç¤¾äº¤æŒ‰é’®</h3>
    <div class="nexmoe-widget nexmoe-social">
        <a class="mdui-ripple" href="https://space.bilibili.com/23364338" target="_blank" mdui-tooltip="{content: 'å“”å“©å“”å“©'}" style="color: rgb(231, 106, 141);background-color: rgba(231, 106, 141, .15);">
            <i class="nexmoefont icon-bilibili"></i>
        </a><a class="mdui-ripple" href="https://github.com/jasonkayzk/" target="_blank" mdui-tooltip="{content: 'GitHub'}" style="color: rgb(25, 23, 23);background-color: rgba(25, 23, 23, .15);">
            <i class="nexmoefont icon-github"></i>
        </a><a class="mdui-ripple" href="https://steamcommunity.com/id/jasonkayzk/" target="_blank" mdui-tooltip="{content: 'Steam'}" style="color: rgb(29, 161, 242);background-color: rgba(29, 161, 242, .1);">
            <i class="nexmoefont icon-steam"></i>
        </a><a class="mdui-ripple" href="https://twitter.com/Jasonkay_ZK/" target="_blank" mdui-tooltip="{content: 'Twitter'}" style="color: rgb(29, 161, 242);background-color: rgba(29, 161, 242, .1);">
            <i class="nexmoefont icon-twitter"></i>
        </a><a class="mdui-ripple" href="mailto:jasonkayzk@gmail.com" target="_blank" mdui-tooltip="{content: 'Mail'}" style="color: rgb(29, 161, 242);background-color: rgba(29, 161, 242, .1);">
            <i class="nexmoefont icon-mail-fill"></i>
        </a>
    </div>
</div>
  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">ç«™å†…æœç´¢</h3>
    <div class="nexmoe-widget nexmoe-search">
        <form class="site-search-form">
            <input type="text" id="local-search-input" class="st-search-input">
        </form>
        <div id="local-search-result" class="local-search-result-cls">
        </div>
    </div>
</div>

<!-- æ‰§è¡Œæœ¬åœ°æœç´¢è„šæœ¬ -->
<script type="text/javascript">
    var path = "https://cdn.jsdelivr.net/gh/jasonkayzk/JasonkayZK.github.io@master/search.xml";
    searchFunc(path, 'local-search-input', 'local-search-result');
</script>

<style type="text/css">
/* æœç´¢æ¡ */
.site-search-form {
    text-align: center;
}
#local-search-input {
    width: 100%;
}

/* æœç´¢ç»“æœå…³é—­ */
#local-search-close {
    font-size: 22.5px;
    cursor: pointer;
    color: #ff4e6a;
}

.search-result-list > li {
    line-height: 0.75;
    margin-top: -5px;
}

</style>
  
  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">æ ‡ç­¾äº‘</h3>
    <div id="randomtagcloud" class="nexmoe-widget tagcloud">
      <a href="/tags/2048/" style="font-size: 10px;">2048</a> <a href="/tags/ACM/" style="font-size: 10px;">ACM</a> <a href="/tags/AI/" style="font-size: 10px;">AI</a> <a href="/tags/AUFS/" style="font-size: 10px;">AUFS</a> <a href="/tags/Android/" style="font-size: 10.91px;">Android</a> <a href="/tags/AppStore/" style="font-size: 10px;">AppStore</a> <a href="/tags/AppleScript/" style="font-size: 10px;">AppleScript</a> <a href="/tags/Aria2/" style="font-size: 10.91px;">Aria2</a> <a href="/tags/Async/" style="font-size: 10px;">Async</a> <a href="/tags/BFS/" style="font-size: 10.45px;">BFS</a> <a href="/tags/Bash/" style="font-size: 10.45px;">Bash</a> <a href="/tags/BitTorrent/" style="font-size: 10px;">BitTorrent</a> <a href="/tags/BloomFilter/" style="font-size: 10px;">BloomFilter</a> <a href="/tags/Bytebase/" style="font-size: 10px;">Bytebase</a> <a href="/tags/C/" style="font-size: 15.91px;">C++</a> <a href="/tags/CAP/" style="font-size: 10px;">CAP</a> <a href="/tags/CDN/" style="font-size: 10.45px;">CDN</a> <a href="/tags/CGLibåŠ¨æ€ä»£ç†/" style="font-size: 10px;">CGLibåŠ¨æ€ä»£ç†</a> <a href="/tags/CUDA/" style="font-size: 10px;">CUDA</a> <a href="/tags/Cache/" style="font-size: 10px;">Cache</a> <a href="/tags/Caffeine/" style="font-size: 10px;">Caffeine</a> <a href="/tags/Cargo/" style="font-size: 11.82px;">Cargo</a> <a href="/tags/CentOS/" style="font-size: 12.27px;">CentOS</a> <a href="/tags/Cgroups/" style="font-size: 10px;">Cgroups</a> <a href="/tags/Chromeæ‰©å±•/" style="font-size: 10px;">Chromeæ‰©å±•</a> <a href="/tags/Cli/" style="font-size: 10.45px;">Cli</a> <a href="/tags/ClickHouse/" style="font-size: 10px;">ClickHouse</a> <a href="/tags/Cling/" style="font-size: 10px;">Cling</a> <a href="/tags/Clion/" style="font-size: 10px;">Clion</a> <a href="/tags/Colima/" style="font-size: 10px;">Colima</a> <a href="/tags/Container/" style="font-size: 10px;">Container</a> <a href="/tags/DFS/" style="font-size: 10.45px;">DFS</a> <a href="/tags/DLL/" style="font-size: 10.45px;">DLL</a> <a href="/tags/Debian/" style="font-size: 10px;">Debian</a> <a href="/tags/Docker/" style="font-size: 18.64px;">Docker</a> <a href="/tags/Docker-Compose/" style="font-size: 10.45px;">Docker-Compose</a> <a href="/tags/DockerHub/" style="font-size: 10px;">DockerHub</a> <a href="/tags/Dolt/" style="font-size: 10px;">Dolt</a> <a href="/tags/Dubbo/" style="font-size: 10.91px;">Dubbo</a> <a href="/tags/Easegress/" style="font-size: 10px;">Easegress</a> <a href="/tags/ElasticSearch/" style="font-size: 14.09px;">ElasticSearch</a> <a href="/tags/Electron/" style="font-size: 10.45px;">Electron</a> <a href="/tags/English/" style="font-size: 10px;">English</a> <a href="/tags/Excel/" style="font-size: 10px;">Excel</a> <a href="/tags/Express/" style="font-size: 10px;">Express</a> <a href="/tags/FFmpeg/" style="font-size: 10px;">FFmpeg</a> <a href="/tags/FTP/" style="font-size: 10.45px;">FTP</a> <a href="/tags/FaaS/" style="font-size: 10px;">FaaS</a> <a href="/tags/Future/" style="font-size: 10px;">Future</a> <a href="/tags/GC/" style="font-size: 10px;">GC</a> <a href="/tags/GPU/" style="font-size: 10px;">GPU</a> <a href="/tags/GRPC/" style="font-size: 10px;">GRPC</a> <a href="/tags/Gin/" style="font-size: 10px;">Gin</a> <a href="/tags/Git/" style="font-size: 13.64px;">Git</a> <a href="/tags/Gitee/" style="font-size: 10px;">Gitee</a> <a href="/tags/Github/" style="font-size: 14.55px;">Github</a> <a href="/tags/Github-Actions/" style="font-size: 10px;">Github-Actions</a> <a href="/tags/Golang/" style="font-size: 18.18px;">Golang</a> <a href="/tags/Gomod/" style="font-size: 10px;">Gomod</a> <a href="/tags/Goroutine/" style="font-size: 10.91px;">Goroutine</a> <a href="/tags/GraalVM/" style="font-size: 10px;">GraalVM</a> <a href="/tags/Gradle/" style="font-size: 10px;">Gradle</a> <a href="/tags/GraphQL/" style="font-size: 10px;">GraphQL</a> <a href="/tags/HAProxy/" style="font-size: 10px;">HAProxy</a> <a href="/tags/Hadoop/" style="font-size: 10px;">Hadoop</a> <a href="/tags/IDEAé…ç½®/" style="font-size: 10px;">IDEAé…ç½®</a> <a href="/tags/IDç”Ÿæˆå™¨/" style="font-size: 10.45px;">IDç”Ÿæˆå™¨</a> <a href="/tags/IOæ¨¡å‹/" style="font-size: 10px;">IOæ¨¡å‹</a> <a href="/tags/Ingress/" style="font-size: 10.45px;">Ingress</a> <a href="/tags/JDKåŠ¨æ€ä»£ç†/" style="font-size: 10.45px;">JDKåŠ¨æ€ä»£ç†</a> <a href="/tags/JVM/" style="font-size: 10px;">JVM</a> <a href="/tags/Java/" style="font-size: 12.27px;">Java</a> <a href="/tags/JavaWeb/" style="font-size: 10px;">JavaWeb</a> <a href="/tags/JavaåŸºç¡€/" style="font-size: 16.82px;">JavaåŸºç¡€</a> <a href="/tags/Javaæ³¨è§£/" style="font-size: 10px;">Javaæ³¨è§£</a> <a href="/tags/Javaæºç /" style="font-size: 12.27px;">Javaæºç </a> <a href="/tags/Javaé¢è¯•/" style="font-size: 11.36px;">Javaé¢è¯•</a> <a href="/tags/JuiceFS/" style="font-size: 10px;">JuiceFS</a> <a href="/tags/JupyterLab/" style="font-size: 10px;">JupyterLab</a> <a href="/tags/Kafka/" style="font-size: 10.45px;">Kafka</a> <a href="/tags/Kubernetes/" style="font-size: 15.45px;">Kubernetes</a> <a href="/tags/LVS/" style="font-size: 10.91px;">LVS</a> <a href="/tags/Lambdaè¡¨è¾¾å¼/" style="font-size: 10.91px;">Lambdaè¡¨è¾¾å¼</a> <a href="/tags/LevelDB/" style="font-size: 10px;">LevelDB</a> <a href="/tags/Library/" style="font-size: 10.45px;">Library</a> <a href="/tags/Life/" style="font-size: 10px;">Life</a> <a href="/tags/Linux/" style="font-size: 16.36px;">Linux</a> <a href="/tags/LruCache/" style="font-size: 10px;">LruCache</a> <a href="/tags/MacOS/" style="font-size: 10.45px;">MacOS</a> <a href="/tags/Maven/" style="font-size: 12.27px;">Maven</a> <a href="/tags/MongoDB/" style="font-size: 11.82px;">MongoDB</a> <a href="/tags/MySQL/" style="font-size: 13.64px;">MySQL</a> <a href="/tags/Mybatis/" style="font-size: 10.91px;">Mybatis</a> <a href="/tags/NFS/" style="font-size: 10px;">NFS</a> <a href="/tags/NIO/" style="font-size: 10.91px;">NIO</a> <a href="/tags/NPM/" style="font-size: 10px;">NPM</a> <a href="/tags/Namespace/" style="font-size: 10px;">Namespace</a> <a href="/tags/Netty/" style="font-size: 10px;">Netty</a> <a href="/tags/Newman/" style="font-size: 10px;">Newman</a> <a href="/tags/Nginx/" style="font-size: 12.27px;">Nginx</a> <a href="/tags/Node-js/" style="font-size: 11.36px;">Node.js</a> <a href="/tags/Okular/" style="font-size: 10px;">Okular</a> <a href="/tags/P2P/" style="font-size: 10px;">P2P</a> <a href="/tags/POML/" style="font-size: 10px;">POML</a> <a href="/tags/Panic/" style="font-size: 10px;">Panic</a> <a href="/tags/PipelineDB/" style="font-size: 10px;">PipelineDB</a> <a href="/tags/PostgreSQL/" style="font-size: 10.45px;">PostgreSQL</a> <a href="/tags/Postman/" style="font-size: 10.45px;">Postman</a> <a href="/tags/Promise/" style="font-size: 10px;">Promise</a> <a href="/tags/Protobuf/" style="font-size: 10.91px;">Protobuf</a> <a href="/tags/Python/" style="font-size: 11.36px;">Python</a> <a href="/tags/RAII/" style="font-size: 10px;">RAII</a> <a href="/tags/RPC/" style="font-size: 10px;">RPC</a> <a href="/tags/RSS/" style="font-size: 10.91px;">RSS</a> <a href="/tags/React/" style="font-size: 10px;">React</a> <a href="/tags/Redash/" style="font-size: 10px;">Redash</a> <a href="/tags/Redis/" style="font-size: 14.55px;">Redis</a> <a href="/tags/Ruby/" style="font-size: 10px;">Ruby</a> <a href="/tags/Rust/" style="font-size: 18.64px;">Rust</a> <a href="/tags/SPA/" style="font-size: 10px;">SPA</a> <a href="/tags/SQLite/" style="font-size: 10px;">SQLite</a> <a href="/tags/SSE/" style="font-size: 10px;">SSE</a> <a href="/tags/SSH/" style="font-size: 10.45px;">SSH</a> <a href="/tags/Serverless/" style="font-size: 10px;">Serverless</a> <a href="/tags/Shadowsocks/" style="font-size: 10.91px;">Shadowsocks</a> <a href="/tags/Skiplist/" style="font-size: 10px;">Skiplist</a> <a href="/tags/Slice/" style="font-size: 10px;">Slice</a> <a href="/tags/Socket/" style="font-size: 10px;">Socket</a> <a href="/tags/Spring/" style="font-size: 11.82px;">Spring</a> <a href="/tags/Spring-Boot/" style="font-size: 10px;">Spring Boot</a> <a href="/tags/Springæºç /" style="font-size: 10px;">Springæºç </a> <a href="/tags/String/" style="font-size: 10px;">String</a> <a href="/tags/Swagger/" style="font-size: 10px;">Swagger</a> <a href="/tags/TOML/" style="font-size: 10px;">TOML</a> <a href="/tags/Telegraf/" style="font-size: 10px;">Telegraf</a> <a href="/tags/Telegram/" style="font-size: 10px;">Telegram</a> <a href="/tags/Tomcat/" style="font-size: 10.45px;">Tomcat</a> <a href="/tags/TypeScript/" style="font-size: 10px;">TypeScript</a> <a href="/tags/Typora/" style="font-size: 10px;">Typora</a> <a href="/tags/UUID/" style="font-size: 10px;">UUID</a> <a href="/tags/UnionFS/" style="font-size: 10px;">UnionFS</a> <a href="/tags/VMWare/" style="font-size: 13.18px;">VMWare</a> <a href="/tags/VPN/" style="font-size: 10px;">VPN</a> <a href="/tags/WebAssembly/" style="font-size: 10.45px;">WebAssembly</a> <a href="/tags/Websocket/" style="font-size: 10px;">Websocket</a> <a href="/tags/XML/" style="font-size: 10.91px;">XML</a> <a href="/tags/YAML/" style="font-size: 10px;">YAML</a> <a href="/tags/Zookeeper/" style="font-size: 10.91px;">Zookeeper</a> <a href="/tags/apt/" style="font-size: 10px;">apt</a> <a href="/tags/autok3s/" style="font-size: 10px;">autok3s</a> <a href="/tags/cURL/" style="font-size: 10px;">cURL</a> <a href="/tags/chroot/" style="font-size: 10px;">chroot</a> <a href="/tags/cmder/" style="font-size: 10px;">cmder</a> <a href="/tags/grpc/" style="font-size: 10px;">grpc</a> <a href="/tags/hashå†²çª/" style="font-size: 10px;">hashå†²çª</a> <a href="/tags/inoreader/" style="font-size: 10px;">inoreader</a> <a href="/tags/k3s/" style="font-size: 10.45px;">k3s</a> <a href="/tags/kafka/" style="font-size: 10px;">kafka</a> <a href="/tags/keepalived/" style="font-size: 10px;">keepalived</a> <a href="/tags/libp2p/" style="font-size: 10px;">libp2p</a> <a href="/tags/minikube/" style="font-size: 10.45px;">minikube</a> <a href="/tags/ntfy/" style="font-size: 10px;">ntfy</a> <a href="/tags/picocli/" style="font-size: 10px;">picocli</a> <a href="/tags/telnet/" style="font-size: 10px;">telnet</a> <a href="/tags/uv/" style="font-size: 10px;">uv</a> <a href="/tags/vcpkg/" style="font-size: 10px;">vcpkg</a> <a href="/tags/xorm/" style="font-size: 10px;">xorm</a> <a href="/tags/äºŒåˆ†æ³•/" style="font-size: 10px;">äºŒåˆ†æ³•</a> <a href="/tags/äºŒå‰æ ‘/" style="font-size: 15.45px;">äºŒå‰æ ‘</a> <a href="/tags/äºŒç»´ç /" style="font-size: 10px;">äºŒç»´ç </a> <a href="/tags/äº¤å‰ç¼–è¯‘/" style="font-size: 10px;">äº¤å‰ç¼–è¯‘</a> <a href="/tags/äººå·¥æ™ºèƒ½/" style="font-size: 10.91px;">äººå·¥æ™ºèƒ½</a> <a href="/tags/äººç”Ÿæ—¥è®°/" style="font-size: 17.73px;">äººç”Ÿæ—¥è®°</a> <a href="/tags/ä»£ç†æ¨¡å¼/" style="font-size: 10px;">ä»£ç†æ¨¡å¼</a> <a href="/tags/ä½è¿ç®—/" style="font-size: 10.45px;">ä½è¿ç®—</a> <a href="/tags/ä¿¡å·/" style="font-size: 10px;">ä¿¡å·</a> <a href="/tags/ä¿¡æ¯èšåˆ/" style="font-size: 10px;">ä¿¡æ¯èšåˆ</a> <a href="/tags/å†…å­˜ç®¡ç†/" style="font-size: 10.45px;">å†…å­˜ç®¡ç†</a> <a href="/tags/å†…ç½‘ç©¿é€/" style="font-size: 10px;">å†…ç½‘ç©¿é€</a> <a href="/tags/å‡½æ•°å¼æ¥å£/" style="font-size: 10px;">å‡½æ•°å¼æ¥å£</a> <a href="/tags/åˆ†å¸ƒå¼/" style="font-size: 15.91px;">åˆ†å¸ƒå¼</a> <a href="/tags/åŠå…¬/" style="font-size: 10px;">åŠå…¬</a> <a href="/tags/åŠ¨æ€è§„åˆ’/" style="font-size: 11.36px;">åŠ¨æ€è§„åˆ’</a> <a href="/tags/åç¨‹æ± /" style="font-size: 10px;">åç¨‹æ± </a> <a href="/tags/åšå®¢ç®¡ç†/" style="font-size: 13.18px;">åšå®¢ç®¡ç†</a> <a href="/tags/åšå®¢ç¾åŒ–/" style="font-size: 11.82px;">åšå®¢ç¾åŒ–</a> <a href="/tags/åŒæŒ‡é’ˆ/" style="font-size: 10.45px;">åŒæŒ‡é’ˆ</a> <a href="/tags/åå°„/" style="font-size: 12.27px;">åå°„</a> <a href="/tags/å£æ‰/" style="font-size: 10px;">å£æ‰</a> <a href="/tags/å“ˆå¸Œè¡¨/" style="font-size: 10.45px;">å“ˆå¸Œè¡¨</a> <a href="/tags/å›æº¯/" style="font-size: 10.45px;">å›æº¯</a> <a href="/tags/å›æº¯æ³•/" style="font-size: 10px;">å›æº¯æ³•</a> <a href="/tags/å †/" style="font-size: 10.45px;">å †</a> <a href="/tags/å¤šçº¿ç¨‹ä¸‹è½½/" style="font-size: 10.45px;">å¤šçº¿ç¨‹ä¸‹è½½</a> <a href="/tags/å¤§æ•°æ®/" style="font-size: 10px;">å¤§æ•°æ®</a> <a href="/tags/å­—ç¬¦ä¸²/" style="font-size: 13.18px;">å­—ç¬¦ä¸²</a> <a href="/tags/å­—ç¬¦ä¸²å¤„ç†/" style="font-size: 10px;">å­—ç¬¦ä¸²å¤„ç†</a> <a href="/tags/å­¦ä¹ æ¡ˆä¾‹/" style="font-size: 10.45px;">å­¦ä¹ æ¡ˆä¾‹</a> <a href="/tags/å®¹å™¨/" style="font-size: 10px;">å®¹å™¨</a> <a href="/tags/å·¥å…·åˆ†äº«/" style="font-size: 19.09px;">å·¥å…·åˆ†äº«</a> <a href="/tags/å¹¶å‘ç¼–ç¨‹/" style="font-size: 15.45px;">å¹¶å‘ç¼–ç¨‹</a> <a href="/tags/å¹¶è¡Œè®¡ç®—/" style="font-size: 10px;">å¹¶è¡Œè®¡ç®—</a> <a href="/tags/åºåˆ—åŒ–/" style="font-size: 10px;">åºåˆ—åŒ–</a> <a href="/tags/å»ºç­‘/" style="font-size: 10px;">å»ºç­‘</a> <a href="/tags/å¼€å‘è§„èŒƒ/" style="font-size: 10.45px;">å¼€å‘è§„èŒƒ</a> <a href="/tags/å¼€æºåè®®/" style="font-size: 10px;">å¼€æºåè®®</a> <a href="/tags/æ€§èƒ½æŒ‡æ ‡/" style="font-size: 10px;">æ€§èƒ½æŒ‡æ ‡</a> <a href="/tags/æŠ€æœ¯æ‚è°ˆ/" style="font-size: 20px;">æŠ€æœ¯æ‚è°ˆ</a> <a href="/tags/æ’åº/" style="font-size: 11.82px;">æ’åº</a> <a href="/tags/æ¨é€/" style="font-size: 10px;">æ¨é€</a> <a href="/tags/æœç´¢/" style="font-size: 10px;">æœç´¢</a> <a href="/tags/æ“ä½œç³»ç»Ÿ/" style="font-size: 10.91px;">æ“ä½œç³»ç»Ÿ</a> <a href="/tags/æ•™å¸ˆ/" style="font-size: 10.45px;">æ•™å¸ˆ</a> <a href="/tags/æ•™æ¡ˆ/" style="font-size: 10.45px;">æ•™æ¡ˆ</a> <a href="/tags/æ•°å­¦/" style="font-size: 12.73px;">æ•°å­¦</a> <a href="/tags/æ•°æ®åº“/" style="font-size: 15px;">æ•°æ®åº“</a> <a href="/tags/æ•°ç»„/" style="font-size: 13.64px;">æ•°ç»„</a> <a href="/tags/æ–‡å­—éšè—/" style="font-size: 10px;">æ–‡å­—éšè—</a> <a href="/tags/æ–­ç‚¹ç»­ä¼ /" style="font-size: 10px;">æ–­ç‚¹ç»­ä¼ </a> <a href="/tags/æ–°æµªå¾®åš/" style="font-size: 10px;">æ–°æµªå¾®åš</a> <a href="/tags/æ—¥å¿—/" style="font-size: 10px;">æ—¥å¿—</a> <a href="/tags/æ—¥æœ¬èª/" style="font-size: 14.55px;">æ—¥æœ¬èª</a> <a href="/tags/æ—¥è¨˜/" style="font-size: 10.45px;">æ—¥è¨˜</a> <a href="/tags/æœåŠ¡è‡ªå»º/" style="font-size: 10.91px;">æœåŠ¡è‡ªå»º</a> <a href="/tags/æŸ¥æ‰¾/" style="font-size: 10.91px;">æŸ¥æ‰¾</a> <a href="/tags/æ ˆ/" style="font-size: 10.91px;">æ ˆ</a> <a href="/tags/æ­Œè©/" style="font-size: 10px;">æ­Œè©</a> <a href="/tags/æ­£åˆ™è¡¨è¾¾å¼/" style="font-size: 10.91px;">æ­£åˆ™è¡¨è¾¾å¼</a> <a href="/tags/æ±‡ç¼–è¯­è¨€/" style="font-size: 10px;">æ±‡ç¼–è¯­è¨€</a> <a href="/tags/æµ‹è¯•/" style="font-size: 10px;">æµ‹è¯•</a> <a href="/tags/æ»‘çª—/" style="font-size: 10px;">æ»‘çª—</a> <a href="/tags/ç‰ˆæœ¬æ§åˆ¶/" style="font-size: 10px;">ç‰ˆæœ¬æ§åˆ¶</a> <a href="/tags/ç”Ÿæ´»æ€»ç»“/" style="font-size: 10px;">ç”Ÿæ´»æ€»ç»“</a> <a href="/tags/ç¦åˆ©åˆ†äº«/" style="font-size: 10px;">ç¦åˆ©åˆ†äº«</a> <a href="/tags/ç®—æ³•/" style="font-size: 12.73px;">ç®—æ³•</a> <a href="/tags/ç®—æ³•é¢˜ç›®/" style="font-size: 19.55px;">ç®—æ³•é¢˜ç›®</a> <a href="/tags/ç±»åŠ è½½å™¨/" style="font-size: 10.45px;">ç±»åŠ è½½å™¨</a> <a href="/tags/ç´ æ•°/" style="font-size: 10px;">ç´ æ•°</a> <a href="/tags/çº¿æ€§æ¢æµ‹æ³•/" style="font-size: 10px;">çº¿æ€§æ¢æµ‹æ³•</a> <a href="/tags/çº¿ç¨‹æ± /" style="font-size: 10.91px;">çº¿ç¨‹æ± </a> <a href="/tags/ç¼–è¯‘ä¼˜åŒ–/" style="font-size: 10px;">ç¼–è¯‘ä¼˜åŒ–</a> <a href="/tags/ç¼–è¯‘å™¨/" style="font-size: 10px;">ç¼–è¯‘å™¨</a> <a href="/tags/ç½‘ç›˜/" style="font-size: 10px;">ç½‘ç›˜</a> <a href="/tags/ç½‘ç»œçº¿è·¯/" style="font-size: 10px;">ç½‘ç»œçº¿è·¯</a> <a href="/tags/ç¿»è¨³/" style="font-size: 10.45px;">ç¿»è¨³</a> <a href="/tags/è‡ªå¯åŠ¨/" style="font-size: 10px;">è‡ªå¯åŠ¨</a> <a href="/tags/è’™ç‰¹å¡ç½—æ–¹æ³•/" style="font-size: 10px;">è’™ç‰¹å¡ç½—æ–¹æ³•</a> <a href="/tags/è™šæ‹Ÿæœº/" style="font-size: 10.45px;">è™šæ‹Ÿæœº</a> <a href="/tags/è¡—æ™¯/" style="font-size: 10px;">è¡—æ™¯</a> <a href="/tags/è£…é¥°å™¨æ¨¡å¼/" style="font-size: 10px;">è£…é¥°å™¨æ¨¡å¼</a> <a href="/tags/è®¡ç®—æœºç½‘ç»œ/" style="font-size: 10px;">è®¡ç®—æœºç½‘ç»œ</a> <a href="/tags/è®¾è®¡æ¨¡å¼/" style="font-size: 10px;">è®¾è®¡æ¨¡å¼</a> <a href="/tags/è¯¾ç¨‹/" style="font-size: 10px;">è¯¾ç¨‹</a> <a href="/tags/è´Ÿè½½å‡è¡¡/" style="font-size: 12.27px;">è´Ÿè½½å‡è¡¡</a> <a href="/tags/è´ªå¿ƒ/" style="font-size: 10px;">è´ªå¿ƒ</a> <a href="/tags/è·³è·³è›™æ—¥è¯­è¯»åº“/" style="font-size: 10.45px;">è·³è·³è›™æ—¥è¯­è¯»åº“</a> <a href="/tags/è½¯ä»¶å®‰è£…ä¸é…ç½®/" style="font-size: 17.27px;">è½¯ä»¶å®‰è£…ä¸é…ç½®</a> <a href="/tags/è½¯ä»¶æ¨è/" style="font-size: 15px;">è½¯ä»¶æ¨è</a> <a href="/tags/è½¯ä»¶æµ‹è¯•/" style="font-size: 10.45px;">è½¯ä»¶æµ‹è¯•</a> <a href="/tags/è½¯è€ƒ/" style="font-size: 10px;">è½¯è€ƒ</a> <a href="/tags/è¿›åº¦æ¡/" style="font-size: 10.45px;">è¿›åº¦æ¡</a> <a href="/tags/è¿›ç¨‹é€šä¿¡/" style="font-size: 10px;">è¿›ç¨‹é€šä¿¡</a> <a href="/tags/é€†å‘å·¥ç¨‹/" style="font-size: 10px;">é€†å‘å·¥ç¨‹</a> <a href="/tags/é€’å½’/" style="font-size: 10.45px;">é€’å½’</a> <a href="/tags/é‡å®šå‘/" style="font-size: 10px;">é‡å®šå‘</a> <a href="/tags/é‡è£…ç³»ç»Ÿ/" style="font-size: 10px;">é‡è£…ç³»ç»Ÿ</a> <a href="/tags/é“¾è¡¨/" style="font-size: 13.64px;">é“¾è¡¨</a> <a href="/tags/é˜Ÿåˆ—/" style="font-size: 10px;">é˜Ÿåˆ—</a> <a href="/tags/éšæœºå›¾ç‰‡/" style="font-size: 10px;">éšæœºå›¾ç‰‡</a> <a href="/tags/é›†åˆ/" style="font-size: 14.09px;">é›†åˆ</a> <a href="/tags/é›¶å®½å­—ç¬¦/" style="font-size: 10px;">é›¶å®½å­—ç¬¦</a> <a href="/tags/é™æ€ä»£ç†/" style="font-size: 10px;">é™æ€ä»£ç†</a> <a href="/tags/é¢è¯•æ€»ç»“/" style="font-size: 15px;">é¢è¯•æ€»ç»“</a> <a href="/tags/é¡¹ç›®æ€»ç»“/" style="font-size: 10.91px;">é¡¹ç›®æ€»ç»“</a> <a href="/tags/é¡¹ç›®æ„å»º/" style="font-size: 10.91px;">é¡¹ç›®æ„å»º</a> <a href="/tags/é¡¹ç›®éƒ¨ç½²/" style="font-size: 11.36px;">é¡¹ç›®éƒ¨ç½²</a> <a href="/tags/é»‘è‹¹æœ/" style="font-size: 10px;">é»‘è‹¹æœ</a>
    </div>
    
  </div>

  
  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">æ–‡ç« åˆ†ç±»</h3>
    <div class="nexmoe-widget">

      <ul class="category-list">

        


        

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/ACM/">ACM</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Android/">Android</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/C/">C++</a>
          <span class="category-list-count">16</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/CUDA/">CUDA</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Chromeæ‰©å±•/">Chromeæ‰©å±•</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/ClickHouse/">ClickHouse</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Docker/">Docker</a>
          <span class="category-list-count">25</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Dolt/">Dolt</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Dubbo/">Dubbo</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/ElasticSearch/">ElasticSearch</a>
          <span class="category-list-count">8</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Electron/">Electron</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Git/">Git</a>
          <span class="category-list-count">6</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Github/">Github</a>
          <span class="category-list-count">5</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Golang/">Golang</a>
          <span class="category-list-count">31</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/GraalVM/">GraalVM</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/IOåŸºç¡€/">IOåŸºç¡€</a>
          <span class="category-list-count">4</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Java/">Java</a>
          <span class="category-list-count">4</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Javaæºç /">Javaæºç </a>
          <span class="category-list-count">16</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JuiceFS/">JuiceFS</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Kubernetes/">Kubernetes</a>
          <span class="category-list-count">12</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Life/">Life</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Linux/">Linux</a>
          <span class="category-list-count">16</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Maven/">Maven</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/MongoDB/">MongoDB</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/MySQL/">MySQL</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Mybatis/">Mybatis</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/NPM/">NPM</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Netty/">Netty</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Nginx/">Nginx</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Node-js/">Node.js</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/PostgreSQL/">PostgreSQL</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Protobuf/">Protobuf</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Python/">Python</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Redash/">Redash</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Docker/Redis/">Redis</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Ruby/">Ruby</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Rust/">Rust</a>
          <span class="category-list-count">35</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Spring/">Spring</a>
          <span class="category-list-count">5</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/TOML/">TOML</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/TypeScript/">TypeScript</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Websocket/">Websocket</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/äººå·¥æ™ºèƒ½/">äººå·¥æ™ºèƒ½</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/äººç”Ÿæ—¥è®°/">äººç”Ÿæ—¥è®°</a>
          <span class="category-list-count">27</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/åˆ†å¸ƒå¼/">åˆ†å¸ƒå¼</a>
          <span class="category-list-count">10</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/åŠå…¬/">åŠå…¬</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/åšå®¢ç®¡ç†/">åšå®¢ç®¡ç†</a>
          <span class="category-list-count">6</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Mybatis/æŠ€æœ¯æ‚è°ˆ/å­¦ä¹ æ¡ˆä¾‹/">å­¦ä¹ æ¡ˆä¾‹</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/å·¥å…·åˆ†äº«/">å·¥å…·åˆ†äº«</a>
          <span class="category-list-count">41</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/å¹¶å‘ç¼–ç¨‹/">å¹¶å‘ç¼–ç¨‹</a>
          <span class="category-list-count">13</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Mybatis/æŠ€æœ¯æ‚è°ˆ/">æŠ€æœ¯æ‚è°ˆ</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/æ•™å¸ˆ/">æ•™å¸ˆ</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/æ•°æ®åº“/">æ•°æ®åº“</a>
          <span class="category-list-count">8</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/æ—¥æœ¬èª/">æ—¥æœ¬èª</a>
          <span class="category-list-count">11</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/æœåŠ¡è‡ªå»º/">æœåŠ¡è‡ªå»º</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/æ±‡ç¼–è¯­è¨€/">æ±‡ç¼–è¯­è¨€</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/ç®—æ³•/">ç®—æ³•</a>
          <span class="category-list-count">5</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/ç®—æ³•é¢˜ç›®/">ç®—æ³•é¢˜ç›®</a>
          <span class="category-list-count">60</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/è¯¾ç¨‹/">è¯¾ç¨‹</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Redis/è½¯ä»¶å®‰è£…ä¸é…ç½®/">è½¯ä»¶å®‰è£…ä¸é…ç½®</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/è½¯ä»¶æµ‹è¯•/">è½¯ä»¶æµ‹è¯•</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/è½¯è€ƒ/">è½¯è€ƒ</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/é¢è¯•æ€»ç»“/">é¢è¯•æ€»ç»“</a>
          <span class="category-list-count">15</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/é¡¹ç›®æ€»ç»“/">é¡¹ç›®æ€»ç»“</a>
          <span class="category-list-count">3</span>
        </li>

        
      </ul>

    </div>
  </div>


  
  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">æœ€æ–°æ–‡ç« </h3>
    <div class="nexmoe-widget">
      <ul>
        
          <li>
            <a href="/2026/02/10/å†è§2025ï¼Œä½ å¥½2026ï¼/">å†è§2025ï¼Œä½ å¥½2026ï¼</a>
          </li>
        
          <li>
            <a href="/2025/08/20/ä¸‹ä¸€ä»£æç¤ºè¯å·¥ç¨‹è¯­è¨€POMLç®€æ˜æ•™ç¨‹/">ä¸‹ä¸€ä»£æç¤ºè¯å·¥ç¨‹è¯­è¨€POMLç®€æ˜æ•™ç¨‹</a>
          </li>
        
          <li>
            <a href="/2025/07/30/å¼€äº†ä¸€ä¸ªæ–°çš„ä¸“é—¨å­¦ä¹ æ—¥è¯­çš„åšå®¢/">å¼€äº†ä¸€ä¸ªæ–°çš„ä¸“é—¨å­¦ä¹ æ—¥è¯­çš„åšå®¢</a>
          </li>
        
          <li>
            <a href="/2025/07/29/ä¸€ã€å¹¶è¡Œç¼–ç¨‹å¯¼è®ºä¸CUDAå…¥é—¨/">ä¸€ã€å¹¶è¡Œç¼–ç¨‹å¯¼è®ºä¸CUDAå…¥é—¨</a>
          </li>
        
          <li>
            <a href="/2025/07/24/ä¸€äº›å…è´¹çš„GPUèµ„æº/">ä¸€äº›å…è´¹çš„GPUèµ„æº</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
    <div class="nexmoe-copyright">
        <span style="color:#707070;font-size: 14px;">
            æœ¬ç«™æ€»è®¿é—®é‡<span id="busuanzi_value_site_pv"></span>æ¬¡ <br>
            æœ¬ç«™è®¿å®¢æ•°<span id="busuanzi_value_site_uv"></span>äººæ¬¡ <br>
        </span>
        <span id="showsectime" style="color:#707070;font-size: 14px;">
            æœ¬ç«™å·²è¿è¡Œ0å¤©0å°æ—¶0åˆ†0ç§’
        </span>
        <i class="fa fa-heart throb" style="color:#d43f57">â¤</i><br>

        &copy; 2026 Jasonkay
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://nexmoe.com/hexo-theme-nexmoe.html" target="_blank">Nexmoe</a>
    </div>

    <div id="footer-info">

    </div>

    <script type="text/javascript">
        function NewDate(str) {
            str = str.split('-');
            var date = new Date();
            date.setUTCFullYear(str[0], str[1] - 1, str[2]);
            date.setUTCHours(0, 0, 0, 0);
            return date;
        }
        function showsectime() {
            var birthDay = NewDate("2019-09-01");
            var today = new Date();
            var timeold = today.getTime() - birthDay.getTime();
            var sectimeold = timeold / 1000
            var secondsold = Math.floor(sectimeold);
            var msPerDay = 24 * 60 * 60 * 1000; var e_daysold = timeold / msPerDay;
            var daysold = Math.floor(e_daysold);
            var e_hrsold = (daysold - e_daysold) * -24;
            var hrsold = Math.floor(e_hrsold);
            var e_minsold = (hrsold - e_hrsold) * -60;
            var minsold = Math.floor((hrsold - e_hrsold) * -60); var seconds = Math.floor((minsold - e_minsold) * -60).toString();
            document.getElementById("showsectime").innerHTML = "æœ¬ç«™å·²è¿è¡Œ" + daysold + "å¤©" + hrsold + "å°æ—¶" + minsold + "åˆ†" + seconds + "ç§’";
            setTimeout(showsectime, 1000);
        }
        showsectime();
    </script>

</div><!-- .nexmoe-drawer -->
  </div>
  <div id="nexmoe-content">
    <div class="nexmoe-primary">
      <div class="nexmoe-post">
  <div class="nexmoe-post-cover">
    
    <img src="https://img.paulzzh.com/touhou/random?77">
    
    <h1>ä½¿ç”¨Rustå®ç°ä¸€ä¸ªåŒå‘é“¾è¡¨</h1>
  </div>
  <div class="nexmoe-post-meta">
    <a><i class="nexmoefont icon-calendar-fill"></i>2022å¹´02æœˆ20æ—¥</a>
    <a><i class="nexmoefont icon-areachart"></i>18.9k å­—</a>
    <a><i class="nexmoefont icon-areachart"></i><span class="archive-article-date">é˜…è¯»é‡<span id="busuanzi_value_page_pv"></span>
      </span></a>
    <a><i class="nexmoefont icon-time-circle-fill"></i>å¤§æ¦‚ 90 åˆ†é’Ÿ</a>

    
    <a class="nexmoefont icon-appstore-fill -link" href="/categories/Rust/">Rust</a>
    
    
    <a class="nexmoefont icon-tag-fill -link" href="/tags/Rust/">Rust</a> <a class="nexmoefont icon-tag-fill -link" href="/tags/ç®—æ³•/">ç®—æ³•</a>
    
  </div>
  <article>
    
    <div id="toc" class="toc-article">
      <ul class="markdownIt-TOC">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ä½¿ç”¨Rustå®ç°ä¸€ä¸ªåŒå‘é“¾è¡¨"><span class="toc-text">ä½¿ç”¨Rustå®ç°ä¸€ä¸ªåŒå‘é“¾è¡¨</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#å‰è¨€"><span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æ•°æ®ç»“æ„å®šä¹‰"><span class="toc-text">æ•°æ®ç»“æ„å®šä¹‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#é“¾è¡¨èŠ‚ç‚¹å®šä¹‰ï¼šNode"><span class="toc-text">é“¾è¡¨èŠ‚ç‚¹å®šä¹‰ï¼šNode</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#è¡¥å……çŸ¥è¯†ï¼šåå˜"><span class="toc-text">è¡¥å……çŸ¥è¯†ï¼šåå˜</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#OOPä¸­çš„åå˜"><span class="toc-text">OOPä¸­çš„åå˜</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#â‘ -æ„é€ å™¨å‡½æ•°ä¸­çš„åå˜"><span class="toc-text">â‘  æ„é€ å™¨å‡½æ•°ä¸­çš„åå˜</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#â‘¡-ä¸€èˆ¬å‡½æ•°ä¸­çš„åå˜"><span class="toc-text">â‘¡ ä¸€èˆ¬å‡½æ•°ä¸­çš„åå˜</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Rustä¸­çš„ä¸‰ç§å˜åŒ–"><span class="toc-text">Rustä¸­çš„ä¸‰ç§å˜åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#Rustä¸­çš„å­ç±»å‹"><span class="toc-text">Rustä¸­çš„å­ç±»å‹</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Rustä¸­çš„é€†å˜ã€åå˜ã€ä¸å˜"><span class="toc-text">Rustä¸­çš„é€†å˜ã€åå˜ã€ä¸å˜</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#NonNullå’Œ-mut"><span class="toc-text">NonNullå’Œ*mut</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#åŒå‘é“¾è¡¨å®šä¹‰ï¼šLinkedList"><span class="toc-text">åŒå‘é“¾è¡¨å®šä¹‰ï¼šLinkedList</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å…·ä½“æ–¹æ³•å®ç°"><span class="toc-text">å…·ä½“æ–¹æ³•å®ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#â‘ -æ„é€ å‡½æ•°ï¼šnew-å’ŒDefault-Trait"><span class="toc-text">â‘  æ„é€ å‡½æ•°ï¼šnew()å’ŒDefault Trait</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#â‘¡-é¦–å°¾å‹å…¥å…ƒç´ ï¼špush"><span class="toc-text">â‘¡ é¦–å°¾å‹å…¥å…ƒç´ ï¼špush()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#â‘¢-é¦–å°¾å¼¹å‡ºå…ƒç´ ï¼špop"><span class="toc-text">â‘¢ é¦–å°¾å¼¹å‡ºå…ƒç´ ï¼špop()</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#è¡¥å……å†…å®¹ï¼šOption"><span class="toc-text">è¡¥å……å†…å®¹ï¼šOption</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#â‘£-æŸ¥çœ‹é¦–å°¾å…ƒç´ ï¼špeek"><span class="toc-text">â‘£ æŸ¥çœ‹é¦–å°¾å…ƒç´ ï¼špeek()</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#å®ç°-peek-front"><span class="toc-text">å®ç° peek_front()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å®ç°-peek-back"><span class="toc-text">å®ç° peek_back()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å®ç°-peek-front-mut"><span class="toc-text">å®ç° peek_front_mut()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å®ç°-peek-back-mut"><span class="toc-text">å®ç° peek_back_mut()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#â‘¤-æ ¹æ®indexæŸ¥çœ‹å…ƒç´ ï¼šget-by-idx"><span class="toc-text">â‘¤ æ ¹æ®indexæŸ¥çœ‹å…ƒç´ ï¼šget_by_idx()</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#è¡¥å……ï¼šRustä¸­çš„é”™è¯¯å¤„ç†"><span class="toc-text">è¡¥å……ï¼šRustä¸­çš„é”™è¯¯å¤„ç†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#è¡¥å……ï¼šRustä¸­è‡ªå®šä¹‰é”™è¯¯ç±»å‹"><span class="toc-text">è¡¥å……ï¼šRustä¸­è‡ªå®šä¹‰é”™è¯¯ç±»å‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å®ç°ï¼šget-by-idxæ–¹æ³•"><span class="toc-text">å®ç°ï¼šget_by_idxæ–¹æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ä»å¤´éƒ¨å¯»æ‰¾å…ƒç´ "><span class="toc-text">ä»å¤´éƒ¨å¯»æ‰¾å…ƒç´ </span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#è¡¥å……å†…å®¹ï¼šCopy-Trait"><span class="toc-text">è¡¥å……å†…å®¹ï¼šCopy Trait</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ä»å°¾éƒ¨å¯»æ‰¾å…ƒç´ "><span class="toc-text">ä»å°¾éƒ¨å¯»æ‰¾å…ƒç´ </span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#è¿”å›ç¬¬-idx-ä¸ªå…ƒç´ "><span class="toc-text">è¿”å›ç¬¬ idx ä¸ªå…ƒç´ </span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#â‘¥-æ ¹æ®indexè·å–å¯å˜å…ƒç´ ï¼šget-by-idx-mut"><span class="toc-text">â‘¥ æ ¹æ®indexè·å–å¯å˜å…ƒç´ ï¼šget_by_idx_mut()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#â‘¦-åœ¨æŒ‡å®šindex-å‰-æ’å…¥å…ƒç´ "><span class="toc-text">â‘¦ åœ¨æŒ‡å®šindex(å‰)æ’å…¥å…ƒç´ </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#â‘§-åˆ é™¤indexå¤„çš„å…ƒç´ "><span class="toc-text">â‘§ åˆ é™¤indexå¤„çš„å…ƒç´ </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#â‘¨-ä¸‰ç§è¿­ä»£å™¨çš„å®ç°ï¼šiterã€iter-mutå’Œinto-iter"><span class="toc-text">â‘¨ ä¸‰ç§è¿­ä»£å™¨çš„å®ç°ï¼šiterã€iter_mutå’Œinto_iter</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#è¿­ä»£å™¨ç±»å‹å®šä¹‰"><span class="toc-text">è¿­ä»£å™¨ç±»å‹å®šä¹‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#i-å®ç°IntoIter"><span class="toc-text">i.å®ç°IntoIter</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ii-å®ç°Iter"><span class="toc-text">ii.å®ç°Iter</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#iii-å®ç°IterMut"><span class="toc-text">iii.å®ç°IterMut</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#â‘©-æ˜¯å¦åŒ…å«æŸå…ƒç´ ï¼šcontains"><span class="toc-text">â‘© æ˜¯å¦åŒ…å«æŸå…ƒç´ ï¼šcontains()</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Rust-ä¸­å’Œæ¯”è¾ƒç›¸å…³çš„-Trait"><span class="toc-text">Rust ä¸­å’Œæ¯”è¾ƒç›¸å…³çš„ Trait</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#éƒ¨åˆ†ç­‰ä»·å…³ç³»ï¼šPartialEq"><span class="toc-text">éƒ¨åˆ†ç­‰ä»·å…³ç³»ï¼šPartialEq</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ç­‰ä»·å…³ç³»ï¼šEq"><span class="toc-text">ç­‰ä»·å…³ç³»ï¼šEq</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ååºå…³ç³»ï¼šPartialOrd"><span class="toc-text">ååºå…³ç³»ï¼šPartialOrd</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#å…¨åºå…³ç³»ï¼šOrd"><span class="toc-text">å…¨åºå…³ç³»ï¼šOrd</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å£°æ˜èŒƒå‹çº¦æŸ"><span class="toc-text">å£°æ˜èŒƒå‹çº¦æŸ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#â‘ª-ä¸ºå®ç°Debugå…ƒç´ çš„é“¾è¡¨å®ç°éå†è¾“å‡ºï¼štraverse"><span class="toc-text">â‘ª ä¸ºå®ç°Debugå…ƒç´ çš„é“¾è¡¨å®ç°éå†è¾“å‡ºï¼štraverse()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#â‘«-é‡Šæ”¾é“¾è¡¨Drop-Traitå’Œ-clear-æ–¹æ³•"><span class="toc-text">â‘« é‡Šæ”¾é“¾è¡¨Drop Traitå’Œ clear()æ–¹æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#å®ç°clear-æ–¹æ³•"><span class="toc-text">å®ç°clear()æ–¹æ³•</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä¸ºé“¾è¡¨æ·»åŠ æµ‹è¯•ç”¨ä¾‹"><span class="toc-text">ä¸ºé“¾è¡¨æ·»åŠ æµ‹è¯•ç”¨ä¾‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æ€»ç»“"><span class="toc-text">æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#é™„å½•"><span class="toc-text">é™„å½•</span></a></li></ol>
      </ul>
    </div>
    
    <p>å¦‚ä½•æ¿€æ€’ä¸€ä¸ªRustçˆ±å¥½è€…ï¼Ÿè®©ä»–ç”¨Rustå®ç°ä¸€ä¸ªåŒå‘é“¾è¡¨å³å¯ï¼</p>
<p>æ€»æ‰€å‘¨çŸ¥ï¼ŒRustä¸­æ˜¯ä¸èƒ½åŒæ—¶å­˜åœ¨ä¸¤ä¸ªå¯å˜å¼•ç”¨çš„ï¼Œæ‰€ä»¥åœ¨Rustä¸­å®ç°åŒå‘é“¾è¡¨å°±ä¼šå˜å¾—éå¸¸åäººç±»ï¼ˆå› ä¸ºéœ€è¦åŒæ—¶å­˜åœ¨å‰åèŠ‚ç‚¹åŒæ—¶æŒ‡å‘å¯¹æ–¹çš„æƒ…å†µï¼‰ï¼›</p>
<p>åŒæ—¶ï¼ŒåŒå‘é“¾è¡¨ä¹Ÿå¼•å…¥äº†å¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼Œè¿™ä¹Ÿæ˜¯å¯¼è‡´å†…å­˜éš¾ä»¥é‡Šæ”¾çš„ä¸€ä¸ªåœºæ™¯ï¼›</p>
<p>æ²¡æƒ³åˆ°ä¸€ä¸ªç®€ç®€å•å•çš„åŒå‘é“¾è¡¨å±…ç„¶æ¶‰åŠå¦‚æ­¤ä¹‹å¤šçš„é—®é¢˜ï¼</p>
<p>æœ¬æ–‡å°±ä½¿ç”¨Unsafe Rustå®ç°äº†åŒå‘é“¾è¡¨ï¼›</p>
<p>æºä»£ç ï¼š</p>
<ul>
<li><a href="https://github.com/JasonkayZK/rust-learn/blob/algorithm/collection/src/list/linked_list.rs" target="_blank" rel="noopener">https://github.com/JasonkayZK/rust-learn/blob/algorithm/collection/src/list/linked_list.rs</a></li>
</ul>
<br>

<a id="more"></a>

<h1 id="ä½¿ç”¨Rustå®ç°ä¸€ä¸ªåŒå‘é“¾è¡¨"><a href="#ä½¿ç”¨Rustå®ç°ä¸€ä¸ªåŒå‘é“¾è¡¨" class="headerlink" title="ä½¿ç”¨Rustå®ç°ä¸€ä¸ªåŒå‘é“¾è¡¨"></a><strong>ä½¿ç”¨Rustå®ç°ä¸€ä¸ªåŒå‘é“¾è¡¨</strong></h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a><strong>å‰è¨€</strong></h2><p>åœ¨é˜…è¯»æœ¬æ–‡ä¹‹å‰ï¼Œè¯·ç¡®ä¿ä½ æœ‰ä¸€å®šçš„RuståŸºç¡€ï¼Œè‡³å°‘ï¼š</p>
<ul>
<li>å¤§è‡´è¯»è¿‡äº†ï¼š<a href="https://doc.rust-lang.org/book/#the-rust-programming-language" target="_blank" rel="noopener">The Rust Programming Language</a></li>
<li>å¯¹Rustä¸­çš„Unsafeæœ‰ä¸€å®šäº†è§£ï¼Œæœ€å¥½è¯»è¿‡ï¼š<a href="https://doc.rust-lang.org/nomicon/" target="_blank" rel="noopener">The Rustonomicon</a></li>
</ul>
<p>å¯¹äºé“¾è¡¨çš„å®ç°ï¼Œåœ¨Rustä¸­æœ‰å¤šç§æ–¹å¼ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>Box</code> å®ç°ï¼ˆç”±äº <code>Box</code> æœ¬èº«çš„é™åˆ¶ï¼ŒåŸºæœ¬åªèƒ½å®ç°å•å‘é“¾è¡¨ï¼‰ï¼›</li>
<li>ä½¿ç”¨ <code>Rc + RefCell</code> å®ç°ï¼ˆç”±äº <code>RefCell</code> çš„é™åˆ¶ï¼Œè¿­ä»£å™¨æ— æ³•å¾ˆå¥½çš„å®ç°ï¼‰ï¼›</li>
<li>ä½¿ç”¨ <code>Unsafe</code> å®ç°ï¼›</li>
</ul>
<p>å¯¹äºé“¾è¡¨çš„å®ç°ï¼Œç”šè‡³ä¸“é—¨æœ‰ä¸€æœ¬èµ«èµ«æœ‰åçš„ä¹¦ï¼š</p>
<ul>
<li><a href="https://rust-unofficial.github.io/too-many-lists/index.html#learn-rust-with-entirely-too-many-linked-lists" target="_blank" rel="noopener">Learn Rust With Entirely Too Many Linked Lists</a></li>
</ul>
<p>æ¨èå¤§å®¶å…ˆé˜…è¯»å¹¶è·Ÿç€è¿™æœ¬ä¹¦å®ç°å…¶ä¸­çš„å‡ ç§é“¾è¡¨å®ç°ï¼Œå†æ¥é˜…è¯»æœ¬æ–‡ï¼Œç›¸ä¿¡ä½ ä¼šæœ‰æ›´å¤šçš„æ”¶è·ï¼</p>
<blockquote>
<p>  è¿™é‡Œä¹Ÿæä¾›æˆ‘å­¦ä¹ <a href="https://rust-unofficial.github.io/too-many-lists/index.html#learn-rust-with-entirely-too-many-linked-lists" target="_blank" rel="noopener">ã€ŠLearn Rust With Entirely Too Many Linked Listsã€‹</a>è¿™æœ¬ä¹¦çš„æºä»£ç ï¼š</p>
<ul>
<li><a href="https://github.com/JasonkayZK/rust-learn/tree/algorithm/too-many-lists" target="_blank" rel="noopener">https://github.com/JasonkayZK/rust-learn/tree/algorithm/too-many-lists</a></li>
</ul>
</blockquote>
<p>æœ€åï¼Œæœ¬æ–‡å†…å®¹è¶…è¿‡ 2w å­—ï¼Œå¸Œæœ›ä½ èƒ½é™ä¸‹å¿ƒæ¥é€šç¯‡é˜…è¯»ï¼Œç›¸ä¿¡ä½ ä¸€å®šä¼šæœ‰æ‰€æ”¶è·ï¼</p>
<p>é‚£ä¹ˆï¼ŒåºŸè¯ä¸å¤šè¯´ï¼Œä¸‹é¢æ¥ä½¿ç”¨ Unsafe Rust å®ç°ä¸€ä¸ªåŒå‘é“¾è¡¨å§ï¼</p>
<br>

<h2 id="æ•°æ®ç»“æ„å®šä¹‰"><a href="#æ•°æ®ç»“æ„å®šä¹‰" class="headerlink" title="æ•°æ®ç»“æ„å®šä¹‰"></a><strong>æ•°æ®ç»“æ„å®šä¹‰</strong></h2><h3 id="é“¾è¡¨èŠ‚ç‚¹å®šä¹‰ï¼šNode"><a href="#é“¾è¡¨èŠ‚ç‚¹å®šä¹‰ï¼šNode" class="headerlink" title="é“¾è¡¨èŠ‚ç‚¹å®šä¹‰ï¼šNode"></a><strong>é“¾è¡¨èŠ‚ç‚¹å®šä¹‰ï¼šNode</strong></h3><p>é“¾è¡¨çš„èŠ‚ç‚¹å®šä¹‰ã€æ„é€ å‡½æ•°å’ŒIntoè¾…åŠ©å‡½æ•°å¦‚ä¸‹ï¼š</p>
<pre><code class="rust">struct Node&lt;T&gt; {
    val: T,
    next: Option&lt;NonNull&lt;Node&lt;T&gt;&gt;&gt;,
    prev: Option&lt;NonNull&lt;Node&lt;T&gt;&gt;&gt;,
}

impl&lt;T&gt; Node&lt;T&gt; {
    fn new(val: T) -&gt; Node&lt;T&gt; {
        Node {
            val,
            prev: None,
            next: None,
        }
    }

    fn into_val(self: Box&lt;Self&gt;) -&gt; T {
        self.val
    }
}</code></pre>
<p>æˆ‘çŸ¥é“ä½ æœ‰å¾ˆå¤šçš„ç–‘é—®ï¼Œè®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥æ¥çœ‹ï¼›</p>
<p>é¦–å…ˆï¼Œä¸ºäº†é“¾è¡¨çš„é€šç”¨æ€§ï¼Œæ³›å‹æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œå› æ­¤ <code>Node</code> ä¸­å®é™…å­˜æ”¾çš„å€¼ <code>val</code> ä¸ºæ³›å‹ T ç±»å‹ï¼›</p>
<blockquote>
<p>  <font color="#f00"><strong>æ³¨ï¼šæ­¤å¤„ val ä¸ºæ³›å‹ T ç±»å‹ï¼Œè€Œé <code>Option&lt;T&gt;</code> ç±»å‹ï¼›</strong></font></p>
<p>  <font color="#f00"><strong>è¿™ä¹Ÿè¯´æ˜å¦‚æœå­˜åœ¨è¿™ä¸ª Nodeï¼Œåˆ™è¯¥Nodeä¸­å¿…å®šæ˜¯æœ‰å€¼çš„ï¼Œä¿è¯ä¸ä¼šå‡ºç° Node å­˜åœ¨è€Œ val ä¸º null çš„æƒ…å†µï¼›</strong></font></p>
<p>  <font color="#f00"><strong>ï¼ˆå–è€Œä»£ä¹‹ï¼Œå¦‚æœ val çš„å€¼ä¸ºç©ºï¼Œåˆ™è¿™ä¸ª Node å°±åº”è¯¥ä¸º <code>None</code>ï¼‰</strong></font></p>
</blockquote>
<br>

<p>æ¥ä¸‹æ¥ï¼Œæ¥çœ‹è¡¨ç¤ºå‰ä¸€èŠ‚ç‚¹å’Œåä¸€èŠ‚ç‚¹çš„ <code>next</code> å’Œ <code>prev</code> å±æ€§ï¼›</p>
<p><code>next</code> å’Œ <code>prev</code> çš„ç±»å‹ä¸ºï¼š<code>Option&lt;NonNull&lt;Node&lt;T&gt;&gt;&gt;</code>ï¼Œæˆ‘ä»¬ä¸€å±‚ä¸€å±‚çš„æ¥åˆ†æï¼š</p>
<p>é¦–å…ˆï¼š<strong><code>Option&lt;T&gt;</code> è¡¨ç¤ºè¯¥èŠ‚ç‚¹ä¸ºç©ºï¼Œå³ä¸å­˜åœ¨å‰ç½®èŠ‚ç‚¹ï¼ˆæ•´ä¸ªé“¾è¡¨ä¸ºç©ºæ—¶ï¼‰ã€æˆ–ä¸å­˜åœ¨åç½®èŠ‚ç‚¹ï¼ˆé“¾è¡¨çš„å°¾èŠ‚ç‚¹ï¼‰ï¼›</strong></p>
<p>æ¥ä¸‹æ¥ï¼Œ<code>NonNull</code> ä¸º Rust ä¸­çš„ä¸€ä¸ªå†…ç½®ç±»å‹ï¼Œå…¶æ˜¯è£¸æŒ‡é’ˆ <code>*mut T</code> çš„ä¸€ä¸ªåŒ…è£…ï¼Œä½†æ˜¯å’Œ <code>*mut T</code> è£¸æŒ‡é’ˆçš„åŒºåˆ«åœ¨äºï¼š</p>
<ul>
<li><strong><code>NonNull</code>ç±»å‹å³ä½¿ä»æœªè§£å¼•ç”¨æŒ‡é’ˆï¼ŒæŒ‡é’ˆä¹Ÿå¿…é¡»å§‹ç»ˆä¸ºé nullï¼›è¿™æ ·ä¸€æ¥ï¼Œæšä¸¾å°±å¯ä»¥å°†æ­¤å€¼ç”¨ä½œåˆ¤åˆ«ï¼ˆ<code>Option&lt;NonNull&lt;T&gt;&gt;</code> ä¸ <code>*mut T</code> å…·æœ‰ç›¸åŒçš„å¤§å°ï¼‰ï¼› ä½†æ˜¯ï¼Œå¦‚æœæŒ‡é’ˆæœªè§£å¼•ç”¨ï¼Œå®ƒå¯èƒ½ä»ä¼šæ‚¬å‚ï¼</strong></li>
<li><strong>ä¸ <code>*mut T</code> ä¸åŒï¼Œ <code>NonNull&lt;T&gt;</code> å¯ä»¥ä½œä¸º <code>T</code> çš„åå˜ï¼›è¿™æ ·å°±å¯ä»¥åœ¨æ„å»ºåå˜ç±»å‹æ—¶ä½¿ç”¨ <code>NonNull&lt;T&gt;</code>ï¼Œä½†æ˜¯å¦‚æœåœ¨å®é™…ä¸Šä¸åº”è¯¥åå˜çš„ç±»å‹ä¸­ä½¿ç”¨ï¼Œåˆ™ä¼šå¸¦æ¥é£é™©ï¼›</strong></li>
</ul>
<blockquote>
<p>  <strong>ä¸Šè¿°å†…å®¹ï¼Œæ‘˜è‡ª <code>NonNull</code> å®˜æ–¹æ–‡æ¡£ï¼š</strong></p>
<ul>
<li><a href="https://doc.rust-lang.org/std/ptr/struct.NonNull.html" target="_blank" rel="noopener">https://doc.rust-lang.org/std/ptr/struct.NonNull.html</a></li>
</ul>
</blockquote>
<p>ä¸Šé¢è¯´çš„äº‘é‡Œé›¾é‡Œçš„ï¼Œé‚£åˆ°åº•è£¸æŒ‡é’ˆ <code>*mut T</code> å’Œ <code>NonNull</code> æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ</p>
<p><font color="#f00"><strong>ç®€å•æ¥è¯´å°±æ˜¯ <code>NonNull</code> æä¾›äº†æ¯” <code>*mut T</code> æ›´å¤šçš„å†…å®¹ï¼šæ”¯æŒåå˜ç±»å‹ã€ç©ºæŒ‡é’ˆä¼˜åŒ–ï¼Œå¹¶ä¸”å¯ä»¥ä¿è¯æŒ‡é’ˆéç©ºï¼›</strong></font></p>
<p>æŒ‡é’ˆéç©ºå’Œç©ºæŒ‡é’ˆä¼˜åŒ–å¾ˆå¥½ç†è§£ï¼Œä½†æ˜¯è¿™é‡Œéœ€è¦è¡¥å……ä¸€äº›å…³äºå˜é‡ç±»å‹åå˜çš„å†…å®¹<strong>ï¼ˆå·²ç»å¯¹åå˜æ¯”è¾ƒå±æ€§çš„å¯ä»¥ç›´æ¥è·³è¿‡ï¼‰ï¼›</strong></p>
<br>

<h4 id="è¡¥å……çŸ¥è¯†ï¼šåå˜"><a href="#è¡¥å……çŸ¥è¯†ï¼šåå˜" class="headerlink" title="è¡¥å……çŸ¥è¯†ï¼šåå˜"></a><strong>è¡¥å……çŸ¥è¯†ï¼šåå˜</strong></h4><h5 id="OOPä¸­çš„åå˜"><a href="#OOPä¸­çš„åå˜" class="headerlink" title="OOPä¸­çš„åå˜"></a><strong>OOPä¸­çš„åå˜</strong></h5><h6 id="â‘ -æ„é€ å™¨å‡½æ•°ä¸­çš„åå˜"><a href="#â‘ -æ„é€ å™¨å‡½æ•°ä¸­çš„åå˜" class="headerlink" title="â‘  æ„é€ å™¨å‡½æ•°ä¸­çš„åå˜"></a><strong>â‘  æ„é€ å™¨å‡½æ•°ä¸­çš„åå˜</strong></h6><p>è¦è®² Rust ä¸­çš„åå˜ï¼Œé¦–å…ˆè¦ä»é¢å‘å¯¹è±¡è¯´èµ·äº†ï¼ˆå¾ˆå¤šç¼–ç¨‹è¯­è¨€éƒ½å­˜åœ¨åå˜ï¼Œå¦‚<code>C#</code>ï¼‰ï¼›</p>
<p>åœ¨ OOP ä¸­ï¼Œåå˜å¾ˆå¥½ç†è§£ï¼š</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœ <code>Cat</code> æ˜¯ <code>Animal</code> çš„å­ç±»å‹ï¼Œé‚£ä¹ˆ<code>Cat</code>ç±»å‹çš„è¡¨è¾¾å¼å¯ç”¨äºä»»ä½•å‡ºç°<code>Animal</code>ç±»å‹è¡¨è¾¾å¼çš„åœ°æ–¹ï¼›</p>
<blockquote>
<p>  <strong>å¯ä»¥è¯´ï¼š</strong></p>
<p>  <font color="#f00"><strong>å½“æˆ‘ä»¬åŸºäº <code>Animal</code> å®šä¹‰ <code>Cat</code> çš„æ—¶å€™ï¼Œ<code>Cat</code> ç›¸å¯¹äº <code>Animal</code> çš„<a href="https://www.zhihu.com/question/22267682/answer/28974249" target="_blank" rel="noopener">å†…æ¶µå¢åŠ äº†ï¼Œè€Œå¤–å»¶æ”¶ç¼©</a>äº†ï¼›</strong></font></p>
<p>  <font color="#f00"><strong>å¹¶ä¸”å¯ä»¥è®¤ä¸ºï¼šæˆ‘ä»¬è‡³å°‘å¯ä»¥è¯´ä¸€ä¸ªçŒ«æ˜¯ä¸€ä¸ªåŠ¨ç‰©ã€‚æ‰€ä»¥çŒ«æ˜¯åŠ¨ç‰©çš„å­ç±»å‹ï¼Œè®°ä½œ <code>Cat: Animal</code>ï¼›</strong></font></p>
<p>  å› ä¸ºçŒ«è‡³å°‘æ˜¯ä¸€ä¸ªåŠ¨ç‰©ï¼Œé‚£ä¹ˆå¯¹äºæ‰€æœ‰éœ€è¦ä»»ä½•åŠ¨ç‰©çš„åœ°æ–¹ï¼Œæˆ‘éƒ½å¯ä»¥ç»™ä¸€åªçŒ«ï¼š</p>
<pre><code class="ts">  function schrÃ¶dinger(sample: Animal) -&gt; bool { ... }
  let cat = new Cat();
  const alive = schrÃ¶dinger(cat);</code></pre>
<p>  <strong>ä¹Ÿå°±æ˜¯è¯´ï¼šå½“ <code>T: U</code> çš„æ—¶å€™ï¼Œä»»ä½•éœ€è¦å½¢å¼å‚æ•° <code>a: U</code> çš„å‡½æ•°ï¼Œæˆ‘ä»¬éƒ½èƒ½ç»™ä¸€ä¸ªå®é™…å‚æ•° <code>a: T</code>ï¼›</strong></p>
<p>  <font color="#f00"><strong>è¿™æ˜¯å› ä¸ºï¼šå­ç±»å‹è‡³å°‘å¯ä»¥è¢«å½“ä½œå®ƒçš„è¶…ç±»å‹ï¼›</strong></font></p>
</blockquote>
<p>æ‰€è°“çš„ <strong>å˜å‹ï¼ˆvarianceï¼‰</strong> æ˜¯æŒ‡ï¼šå¦‚ä½•æ ¹æ®ç»„æˆç±»å‹ä¹‹é—´çš„å­ç±»å‹å…³ç³»ï¼Œæ¥ç¡®å®šæ›´å¤æ‚çš„ç±»å‹ä¹‹é—´ï¼ˆä¾‹å¦‚ <code>Cat</code> æ•°ç»„ä¹‹äº<code>Animal</code>æ•°ç»„ï¼Œè¿”å›å€¼ä¸º <code>Cat</code> çš„å‡½æ•°ä¹‹äºè¿”å›å€¼ä¸º <code>Animal</code> çš„å‡½æ•°â€¦ç­‰ç­‰ï¼‰çš„å­ç±»å‹å…³ç³»ï¼›</p>
<p>å½“æˆ‘ä»¬ç”¨ç±»å‹æ„é€ å‡ºæ›´å¤æ‚çš„ç±»å‹ï¼ŒåŸæœ¬ç±»å‹çš„å­ç±»å‹æ€§è´¨å¯èƒ½è¢«ä¿æŒã€åè½¬ã€æˆ–å¿½ç•¥ï¼Œå–å†³äº<a href="https://zh.wikipedia.org/wiki/å‹åˆ¥æ§‹é€ å™¨" target="_blank" rel="noopener">ç±»å‹æ„é€ å™¨</a>çš„å˜å‹æ€§è´¨ï¼›</p>
<blockquote>
<p>  <strong>ç±»å‹æ„é€ å™¨å°±æ˜¯ä¸€äº›å¸¦æœ‰æ³›å‹/æ¨¡æ¿å‚æ•°çš„ç±»å‹ï¼›å½“å¡«æ»¡äº†å‚æ•°ï¼Œæ‰ä¼šæˆä¸ºä¸€ä¸ªå®é™…çš„ç±»å‹ï¼›</strong></p>
<p>  æ¯”å¦‚ï¼šå¾ˆç®€å•çš„ã€Œç¬¼å­ã€å°±æ˜¯ <code>Cage&lt;T&gt;</code>ï¼Œå…¶ä¸­ <code>T</code> å°±æ˜¯ç±»å‹å‚æ•°ï¼›</p>
<p>  è¿˜æœ‰å®¹å™¨ç±»å‹ï¼Œæ¯”å¦‚ <code>List&lt;T&gt;</code>ï¼›</p>
</blockquote>
<p>ç°åœ¨å›é¡¾ä¸€ä¸‹ï¼Œæˆ‘ä»¬ç°åœ¨çŸ¥é“ä¸€äº›ç±»å‹ä¹‹é—´çš„å…³ç³»ï¼Œä¹Ÿå³æ˜¯è¯´æˆ‘ä»¬çŸ¥é“ <code>Cat</code> æ˜¯ <code>Animal</code> çš„å­ç±»å‹ï¼›é‚£ä¹ˆå¯¹äºä»»æ„çš„ï¼ˆä¸€å…ƒï¼‰ç±»å‹æ„é€ å™¨ <code>M</code>ï¼Œ <code>M&lt;Cat&gt;</code> å’Œ <code>M&lt;Animal&gt;</code> å¯èƒ½ä¼šæœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿï¼ˆ<a href="https://link.zhihu.com/?target=https%3A//zh.wikipedia.org/wiki/%E5%8D%8F%E5%8F%98%E4%B8%8E%E9%80%86%E5%8F%98" target="_blank" rel="noopener">Wiki</a>ï¼‰</p>
<ul>
<li><strong>åå˜ï¼ˆcovarianceï¼‰ï¼š<code>M&lt;Cat&gt;: M&lt;Animal&gt;</code> å®ƒä»¬ç»´æŒå†…éƒ¨å‚æ•°çš„å…³ç³»ä¸å˜ï¼›</strong></li>
<li><strong>é€†å˜ï¼ˆcontravarianceï¼‰ï¼š<code>M&lt;Animal&gt;: M&lt;Cat&gt;</code> å®ƒä»¬çš„å…³ç³»è¢«åè½¬äº†ï¼›</strong></li>
<li><strong>ä¸å˜ï¼ˆinvarianceï¼‰ï¼šä¸¤è€…æ²¡æœ‰ä»»ä½•å­ç±»å‹å…³ç³»ï¼›</strong></li>
</ul>
<p>ç›´è§‰ä¸Šæ¥è¯´ï¼Œåªè¦æœ‰åå˜å°±å¤Ÿäº†ï¼š</p>
<p>è–›å®šè°”æƒ³è¦ä¸€ä¸ªç¬¼å­ï¼Œé‡Œé¢è£…ç€ä¸€ç§åŠ¨ç‰©ï¼Œä»–ä¸å…³å¿ƒæ˜¯ä»€ä¹ˆåŠ¨ç‰©ï¼ˆ<code>Cage&lt;Animal&gt;</code>ï¼‰ï¼Œä½ ç»™è–›å®šè°”ä¸€åªè£…ç€çŒ«çš„ç¬¼å­ï¼ˆ<code>Cage&lt;Cat&gt;</code>ï¼‰ï¼Œè–›å®šè°”æŠŠè¿™ä¸ªçŒ«å½“ä½œä¸€ç§åŠ¨ç‰©åšå®éªŒï¼›</p>
<p>ä¹Ÿå°±æ˜¯è¯´åœ¨éœ€è¦ <code>Cage&lt;Animal&gt;</code> çš„åœ°æ–¹éƒ½å¯ä»¥ç»™ä¸€ä¸ª <code>Cage&lt;Cat&gt;</code> ï¼›</p>
<p>ç„¶è€Œï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸å¯¹çš„ï¼</p>
<p>è€ƒè™‘è¿™æ ·ä¸€ä¸ªæƒ…å†µï¼š</p>
<pre><code class="ts">let cage: Cage&lt;Cat&gt; = new Cage();
function capture(x: Cage&lt;Animal&gt;) {
    x.inner = new Dog();
}
capture(cat);</code></pre>
<p>å› ä¸ºåå˜è§„åˆ™ï¼Œå¯¹ <code>capture</code> æ¥è¯´ç¬¼å­æ˜¯ï¼š <code>Cage&lt;Animal&gt;</code>ï¼Œå¾€ç¬¼å­é‡Œå¡ä¸€ä¸ªç‹—ï¼Œå®Œå…¨æ²¡é—®é¢˜ï¼›</p>
<p>ä½†æ˜¯å¯¹äºè°ƒç”¨è€…æ¥è¯´ï¼Œç¬¼å­çš„ç±»å‹è¿˜æ˜¯ <code>Cage&lt;Cat&gt;</code>ï¼Œè¿™å°±ç ´åäº†ç±»å‹å®‰å…¨ï¼šä½ æ¥ä¸‹æ¥çš„ä»£ç æœŸæœ›è¿™æ˜¯è£…çŒ«çš„ç¬¼å­ï¼Œå…¶å®é‡Œé¢è£…äº†ä¸€ä¸ªç‹—ï¼</p>
<p><font color="#f00"><strong>æ‰€ä»¥ï¼šå¦‚æœä¸€ä¸ªå®¹å™¨æ˜¯åªè¯»çš„ï¼Œæ‰èƒ½åå˜ï¼Œä¸ç„¶å¾ˆå®¹æ˜“å°±èƒ½æŠŠä¸€äº›ç‰¹æ®Šçš„å®¹å™¨åå˜åˆ°æ›´ä¸€èˆ¬çš„å®¹å™¨ï¼Œå†å¾€é‡Œé¢å¡è¿›ä¸åº”è¯¥å¡çš„ç±»å‹ï¼›</strong></font></p>
<p>å†è€ƒè™‘ <code>Cage&lt;T&gt;</code> å¯¹ <code>T</code> é€†å˜çš„æƒ…å†µï¼š<code>Cage&lt;Animal&gt;: Cage&lt;Dog&gt;</code>ï¼›</p>
<p>ä¹Ÿå°±æ˜¯è¯´å½“å‡½æ•°éœ€è¦ <code>Cage&lt;Dog&gt;</code>çš„æ—¶å€™ï¼Œæ€»èƒ½ä¼ ç»™å‡½æ•°ä¸€ä¸ª <code>Cage&lt;Animal&gt;</code>ï¼Œå‡½æ•°å½“ä½œ <code>Cage&lt;Dog&gt;</code> æ¥å¤„ç†ï¼</p>
<p>ä¸€èˆ¬æ¥è¯´è¿™å¾ˆè’è°¬ï¼Œ<code>Cage&lt;Animal&gt;</code> é‡Œé¢çš„åŠ¨ç‰©å¯èƒ½æ˜¯ä¸€åªçŒ«ï¼Œå¼ºè¡Œå½“ä½œä¸€ä¸ªç‹—æ¥å¤„ç†è‚¯å®šä¼šçˆ†ç‚¸ï¼›</p>
<p>ä½†æ˜¯å¯¹äºä¸Šé¢çš„ <code>capture</code> å‡½æ•°æ˜¯æœ‰æ„ä¹‰çš„ï¼Œå®ƒä¸å…³å¿ƒç¬¼å­é‡Œæœ‰ä»€ä¹ˆï¼Œåªå¾€é‡Œé¢å¡ä¸€ä¸ªå‡†å¤‡å¥½çš„ç‹—ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼š<font color="#f00"><strong>å¯¹äºåªå†™çš„ç±»å‹å¯ä»¥ç”¨é€†å˜ï¼›</strong></font></p>
<p><font color="#f00"><strong>é‚£ä¹ˆå¯¹äºå¯è¯»åˆå¯å†™çš„ç±»å‹ï¼Œå½“ç„¶å°±æ˜¯ä¸å˜äº†ï¼šæˆ‘ä»¬ä¸èƒ½åšå‡ºä»»ä½•å‡å®šï¼Œä¸ç„¶æœ‰å¯èƒ½çˆ†ç‚¸ï¼›**</strong></font></p>
<br>

<h6 id="â‘¡-ä¸€èˆ¬å‡½æ•°ä¸­çš„åå˜"><a href="#â‘¡-ä¸€èˆ¬å‡½æ•°ä¸­çš„åå˜" class="headerlink" title="â‘¡ ä¸€èˆ¬å‡½æ•°ä¸­çš„åå˜"></a><strong>â‘¡ ä¸€èˆ¬å‡½æ•°ä¸­çš„åå˜</strong></h6><p>è¿˜æœ‰ä¸€ç§ç‰¹æ®Šçš„ç±»å‹ï¼Œè§„åˆ™æœ‰ç‚¹å¥‡å¼‚ï¼Œé‚£å°±æ˜¯<strong>å‡½æ•°ç±»å‹</strong>ï¼šè€ƒè™‘ä¸€å…ƒå‡½æ•°ï¼ŒæŒ‰ç…§å‡½æ•°çš„ç®­å¤´è®°æ³•ï¼ŒæŠŠå‡½æ•°ç±»å‹è®°ä½œ <code>T -&gt; U</code>ï¼Œå…¶ä¸­ <code>T</code> æ˜¯é€†å˜çš„è€Œ <code>U</code> æ˜¯åå˜çš„ï¼›</p>
<p>è¿”å›å€¼æ˜¯åå˜çš„å¾ˆå¥½ç†è§£ï¼šæˆ‘éœ€è¦å‡½æ•° <code>F</code> æœ€ç»ˆè¿”å›ä¸€åªåŠ¨ç‰©ï¼Œé‚£ä¹ˆæœ€ç»ˆè¿”å›ä¸€åªçŒ«çš„å‡½æ•°æ˜¯å¯æ¥å—çš„ï¼›ï¼ˆå¯ä»¥ä¸æ–­åœ°æ‰©å¤§ç±»å‹åŸŸï¼‰</p>
<p>å½“å‚æ•°æ˜¯é€†å˜å¯èƒ½æœ‰ç‚¹å¥‡æ€ªäº†ï¼šè€ƒè™‘éœ€è¦è®¡ç®—çŒ«çš„å¹´é¾„çš„æƒ…å†µï¼š <code>Cat -&gt; Age</code>ï¼š</p>
<p>ç»™ä¸€ä¸ªé€šç”¨çš„ï¼Œå¯ä»¥è®¡ç®—æ‰€æœ‰åŠ¨ç‰©çš„å¹´é¾„çš„å‡½æ•° <code>Animal -&gt; Age</code> æ¥ä»£æ›¿ä¹Ÿæ˜¯å¾ˆå¥½çš„ï¼š<code>Animal -&gt; Age</code> çš„å®šä¹‰åŸŸ <code>Animal</code> ä¸­é‚£äº› <code>Cat</code> ä»¥å¤–çš„å€¼è¢«æˆªå–æ‰äº†ï¼ˆæˆ‘ä»¬åªä¼šä¼  <code>Cat</code>ï¼‰ï¼Œå°±å˜æˆå¾ˆæ£’çš„ <code>Cat -&gt; Age</code>ï¼›</p>
<p>æ‰€ä»¥ä»»ä½•æ—¶å€™ï¼Œå¯¹éœ€è¦ä¸€ä¸ªä¸€å…ƒå‡½æ•° <code>T: U, T -&gt; V</code> çš„æƒ…å†µï¼Œå®ƒçš„å‚æ•° <code>T</code> å¯ä»¥ç”¨ <code>U</code> æ¥ä»£æ›¿ï¼Œåªéœ€è¦ç®€å•åœ°æ— è§† <code>U</code> ç±»å‹é™¤ <code>T</code> ä»¥å¤–çš„å–å€¼å°±è¡Œäº†ï¼›</p>
<blockquote>
<p>  <strong>ä¸‹é¢ä¸€æ®µè¯æ‘˜è‡ªç»´åŸºç™¾ç§‘ï¼Œè¯´çš„æ˜¯åŒä¸€ä¸ªæ„æ€ï¼š</strong></p>
<p>  <font color="#f00"><strong>æŸäº›ç¼–ç¨‹è¯­è¨€éœ€è¦æŒ‡æ˜ä»€ä¹ˆæ—¶å€™ä¸€ä¸ªå‡½æ•°ç±»å‹æ˜¯å¦ä¸€ä¸ªå‡½æ•°ç±»å‹çš„å­ç±»å‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼šåœ¨ä¸€ä¸ªæœŸæœ›æŸä¸ªå‡½æ•°ç±»å‹çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œä»€ä¹ˆæ—¶å€™å¯ä»¥å®‰å…¨åœ°ä½¿ç”¨å¦ä¸€ä¸ªå‡½æ•°ç±»å‹ï¼›</strong></font></p>
<p>  <font color="#f00"><strong>æˆ‘ä»¬å¯ä»¥è¯´ï¼šå‡½æ•°f å¯ä»¥å®‰å…¨æ›¿æ¢å‡½æ•°gï¼Œå¦‚æœä¸å‡½æ•°g ç›¸æ¯”ï¼Œå‡½æ•°f æ¥å—æ›´ä¸€èˆ¬çš„å‚æ•°ç±»å‹ï¼Œè¿”å›æ›´ç‰¹åŒ–çš„ç»“æœç±»å‹ï¼›</strong></font></p>
<p>  ä¾‹å¦‚ï¼š</p>
<p>  å‡½æ•°ç±»å‹<code>Cat-&gt;Cat</code>å¯å®‰å…¨ç”¨äºæœŸæœ› <code>Cat-&gt;Animal</code> çš„åœ°æ–¹ï¼›</p>
<p>  ç±»ä¼¼åœ°ï¼Œå‡½æ•°ç±»å‹ <code>Animal-&gt;Animal</code> å¯ç”¨äºæœŸæœ› <code>Cat-&gt;Animal</code> çš„åœ°æ–¹ï¼›</p>
<p>  å…¸å‹åœ°ï¼Œåœ¨ <code>Animal a=Fn(Cat(...))</code> è¿™ç§è¯­å¢ƒä¸‹è¿›è¡Œè°ƒç”¨ï¼Œç”±äº Cat æ˜¯ Animal çš„å­ç±»ï¼Œæ‰€ä»¥å³ä½¿ Fn æ¥å—ä¸€åª Animal ä¹ŸåŒæ ·æ˜¯å®‰å…¨çš„ï¼</p>
<p>  ä¸€èˆ¬è§„åˆ™æ˜¯ï¼š</p>
<blockquote>
<p>  <strong>S1 â†’ S2 â‰¦ T1 â†’ T2 å½“T1 â‰¦ S1ä¸”S2 â‰¦ T2</strong></p>
</blockquote>
<p>  æ¢å¥è¯è¯´ï¼Œ<strong>ç±»å‹æ„é€ ç¬¦â†’å¯¹è¾“å…¥ç±»å‹æ˜¯é€†å˜çš„è€Œå¯¹è¾“å‡ºç±»å‹æ˜¯åå˜çš„ï¼›</strong></p>
<p>  è¿™ä¸€è§„åˆ™é¦–å…ˆè¢«<a href="https://zh.wikipedia.org/wiki/åå˜ä¸é€†å˜#cite_note-1" target="_blank" rel="noopener">Luca Cardelliæ­£å¼æå‡º</a>ï¼›</p>
</blockquote>
<p>ç»¼åˆèµ·æ¥ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼š</p>
<p><img src="https://raw.gitmirror.com/JasonkayZK/blog_static/master/images/rust-double-linked-list-1.svg" alt="rust-double-linked-list-1.svg"></p>
<br>

<h5 id="Rustä¸­çš„ä¸‰ç§å˜åŒ–"><a href="#Rustä¸­çš„ä¸‰ç§å˜åŒ–" class="headerlink" title="Rustä¸­çš„ä¸‰ç§å˜åŒ–"></a><strong>Rustä¸­çš„ä¸‰ç§å˜åŒ–</strong></h5><p>ä¸Šé¢è®²è¿°äº† OOP ä¸­çš„åå˜ï¼Œå†æ¥çœ‹ Rust å¯¹äºåå˜çš„å®šä¹‰ï¼›</p>
<p>ä¼—æ‰€å‘¨çŸ¥ï¼ŒRust ä¸­æ˜¯ä¸å­˜åœ¨ç±»ä¼¼äº OOP ä¸­çš„ç»§æ‰¿çš„ï¼ˆä¸å…‰Rustæ²¡æœ‰ï¼ŒåŒä¸€æ—¶æœŸçš„Goç­‰è¯­è¨€éƒ½æ²¡æœ‰ï¼ï¼‰ï¼Œä¸ç®—Traitçš„è¯ï¼Œç»“æ„ä½“æˆ–è€…æšä¸¾ä¹‹é—´ä¹Ÿéƒ½æ²¡æœ‰å­ç±»å‹å…³ç³»ï¼›</p>
<p>ä½†æ˜¯Rustä¸­æœ‰ <code>lifetime</code>ï¼Œ<code>lifetime</code>æ˜¯å’Œé€šå¸¸ç±»å‹å¹³è¡Œçš„å¦ä¸€å¥—ç±»å‹ï¼ˆå¦ä¸€ä¸ªèŒƒç•´ï¼‰ï¼Œè€Œ<strong>Rustä¸­çš„å­ç±»å‹å°±æ˜¯å¯¹äºlifetimeè€Œè¨€çš„ï¼</strong></p>
<br>

<h6 id="Rustä¸­çš„å­ç±»å‹"><a href="#Rustä¸­çš„å­ç±»å‹" class="headerlink" title="Rustä¸­çš„å­ç±»å‹"></a><strong>Rustä¸­çš„å­ç±»å‹</strong></h6><p>å­ç±»å‹æ˜¯ä¸€ç§åºå…³ç³»ï¼Œä¸ä¸€å®šæ˜¯åƒç»§æ‰¿é‚£æ ·çš„è¶…ç±»å‹ç›´æ¥åŒ…å«å­ç±»å‹ï¼ˆåŠ¨ç‰©åŒ…å«çŒ«ï¼‰ï¼›</p>
<p>åœ¨ lifetime ä¸­ï¼Œå¤–å±‚çš„ lifetime æ˜¯å®ƒæ‰€åŒ…å«çš„å†…å±‚ lifetime çš„å­ç±»å‹ï¼š <code>&#39;big: &#39;small</code>ï¼š</p>
<blockquote>
<p>  <font color="#f00"><strong>æ³¨æ„ï¼š<code>å¤–å±‚çš„ lifetime æ˜¯å®ƒæ‰€åŒ…å«çš„å†…å±‚ lifetime çš„å­ç±»å‹</code>ï¼Œè¿™é‡Œçš„é¡ºåºå’Œç›´è§‰ä¸Šæ˜¯ç›¸åçš„ï¼</strong></font></p>
</blockquote>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://raw.gitmirror.com/JasonkayZK/blog_static/master/images/rust-double-linked-list-2.jpg" alt="rust-double-linked-list-2.jpg"></p>
<p>è¿™å¼ å›¾ä¸­çš„å­ç±»å‹å…³ç³»åº”å½“æ˜¯ï¼š</p>
<ul>
<li><code>&#39;static: &#39;big: &#39;small_1</code>ï¼›</li>
<li><code>&#39;static: &#39;big: &#39;small_2</code>ï¼›</li>
</ul>
<p><strong>å³ï¼š<code>&#39;static</code> æ˜¯æ‰€æœ‰lifetimeçš„å­ç±»å‹ï¼</strong></p>
<blockquote>
<p>  <strong>lifetime å°±æ˜¯ä½œç”¨åŸŸï¼Œä½œç”¨åŸŸæ˜¯å¾ˆæ ‡å‡†çš„åµŒå¥—å…³ç³»ï¼Œæ‰€ä»¥Rustçš„è§„åˆ™æœ‰ç‚¹åç›´è§‰ï¼›</strong></p>
<p>  å¯¹äºé›†åˆï¼Œå­é›†æ‰©å¼ åˆ°è¶…é›†å¾€å¾€æ˜¯æ°å½“çš„ï¼Œä½†ä¸€ä¸ªä½œç”¨åŸŸæœ¬èº«ä¸åº”è¯¥è¢«å½“ä½œä¸€ä¸ªé›†åˆï¼›</p>
<p>  æˆ‘ä»¬å¯ä»¥è¯´ï¼šä¸€åªçŒ«<strong>è‡³å°‘</strong>æ˜¯ä¸€ä¸ªåŠ¨ç‰©ï¼›</p>
<p>  ä½†å¯¹äºlifetimeï¼šä¸èƒ½è¯´ <code>&#39;small_1</code> <strong>è‡³å°‘</strong>æ˜¯ <code>&#39;big</code>ï¼Œè€Œåº”è¯¥è¯´ <code>&#39;big</code> <strong>è‡³å°‘</strong>æ˜¯<code>&#39;small_1</code>ï¼Œä¹Ÿ<strong>è‡³å°‘</strong>æ˜¯ <code>&#39;small_2</code>ï¼›</p>
</blockquote>
<p><font color="#f00"><strong>lifetime å­˜åœ¨çš„æ„ä¹‰å°±æ˜¯ï¼šç•Œå®šèµ„æºä¸åº”è¯¥è¶…å‡ºä¸€ä¸ªèŒƒå›´ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼šæ‰©å¼  lifetime å¾€å¾€æ˜¯å±é™©çš„ï¼Œè€Œæ”¶ç¼©ï¼ˆåªè¯»å¼•ç”¨ï¼‰lifetimeæ˜¯å®‰å…¨çš„ï¼›</strong></font></p>
<blockquote>
<p>  <strong>æ­¤å¤„å¦‚æœéµå¾ªç›´è§‰ï¼ŒæŒ‰ç…§åµŒå¥—å…³ç³»æ’åˆ—ï¼š</strong></p>
<p>  <strong>ä¹Ÿå°±æ˜¯ <code>&#39;small_1: &#39;big: &#39;static</code>ï¼Œå°çš„ä½œç”¨åŸŸ <code>&#39;small_1</code> å°±å¯ä»¥åå˜åˆ°å…¨å±€ä½œç”¨åŸŸ <code>&#39;static</code> ï¼›</strong></p>
<p>  <strong>é‚£ä¹ˆåœ¨è¢«è¯»å–çš„å¯¹è±¡è¢«é”€æ¯åï¼Œç¼–è¯‘å™¨è¿˜å…è®¸ä»£ç ç»§ç»­è¯•å›¾è¯»å–å®ƒï¼Œå°±ä¼šçˆ†ç‚¸ï¼Œæ•´ä¸ªlifetimeç³»ç»Ÿå°±å¤±æ•ˆäº†ï¼</strong></p>
</blockquote>
<p>å¯ä»¥é€šè¿‡ä¸‹é¢å‡ ä¸ªæ–¹å¼æ¥ç†è§£ï¼š</p>
<ol>
<li><strong><code>&#39;small_1</code> çš„ lifetime ä»£è¡¨ã€ŒåŒ…å« <code>&#39;small_1</code> çš„ä½œç”¨åŸŸçš„é›†åˆã€ï¼›è€Œ <code>&#39;static</code> å°±æ˜¯ã€ŒåŒ…å«å…¨å±€ä½œç”¨åŸŸçš„é›†åˆã€åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼›æ‰€ä»¥å¾ˆæ˜¾ç„¶åè€…æ˜¯å‰è€…çš„å­é›†ï¼Œå› ä¸ºå…¨å±€ä½œç”¨åŸŸåŒ…å«äº† <code>&#39;small_1</code>ï¼›</strong></li>
<li><strong>è¶Šå°çš„ä½œç”¨åŸŸï¼ŒåŒ…å«äº†å®ƒçš„å¤–å±‚ä½œç”¨åŸŸå°±è¶Šå¤šï¼›</strong></li>
<li><strong>lifetime ç±»å‹æ‰€å…³è”çš„ä½œç”¨åŸŸæ˜¯å†…æ¶µè€Œä¸æ˜¯å¤–å»¶ï¼Œå†…æ¶µå¢å¤šåˆ™å¤–å»¶å‡å°‘ï¼›æ­£å¦‚ <code>Cat</code> å°±æ˜¯ <code>Animal</code> å¢å¤šå†…æ¶µè€Œæ¥çš„ï¼Œå®ƒçš„å¤–å»¶åªæœ‰å„ç§çŒ«ï¼Œè€Œ <code>Animal</code> çš„å¤–å»¶æœ‰å„ç§åŠ¨ç‰©ï¼›</strong></li>
</ol>
<br>

<h6 id="Rustä¸­çš„é€†å˜ã€åå˜ã€ä¸å˜"><a href="#Rustä¸­çš„é€†å˜ã€åå˜ã€ä¸å˜" class="headerlink" title="Rustä¸­çš„é€†å˜ã€åå˜ã€ä¸å˜"></a><strong>Rustä¸­çš„é€†å˜ã€åå˜ã€ä¸å˜</strong></h6><blockquote>
<p>  <strong><a href="https%3A//doc.rust-lang.org/nomicon/subtyping.html">æ­»çµä¹¦ï¼šsubtype</a>åŸæ–‡è¯¦ç»†åœ°è®²äº†è¿™ä¸€å—ï¼</strong></p>
</blockquote>
<p>ç®€è€Œè¨€ä¹‹ï¼Œåœ¨Rustä¸­ï¼š</p>
<ul>
<li><font color="#f00"><strong>åå˜ï¼ˆcovarianceï¼‰ï¼š<code>M&lt;&#39;small&gt;: M&lt;&#39;small&gt;</code> å³ç»´æŒ lifetime è¶Šæ¥è¶Šæ”¶ç´§ï¼›</strong></font></li>
<li><font color="#f00"><strong>é€†å˜ï¼ˆcontravarianceï¼‰ï¼š<code>M&lt;&#39;big&gt;: M&lt;&#39;small&gt;</code>ï¼Œlifetimeåè½¬ï¼Œåœ¨Rustä¸­éå¸¸å°‘è§ï¼</strong></font></li>
<li><font color="#f00"><strong>ä¸å˜ï¼ˆinvarianceï¼‰ï¼šä¸¤è€…çš„ lifetime å¹¶æ²¡æœ‰ç›´æ¥å…³ç³»ï¼›</strong></font></li>
</ul>
<p>æˆ‘ä»¬å·²çŸ¥ï¼š</p>
<p><strong><code>&amp;</code> å’Œ <code>&amp;mut</code> éƒ½æ˜¯ä¸€ä¸ªç±»å‹æ„é€ å™¨ï¼Œæ¥å—ä¸€ä¸ªlifetime <code>&#39;a</code> å’Œå¦ä¸€ä¸ªç±»å‹ <code>T</code>ï¼š</strong></p>
<p>æœ‰ä¸€èˆ¬è§„å¾‹ï¼š</p>
<ul>
<li><p><font color="#f00"><strong>â‘  <code>&amp;&#39;a T</code> å¯¹ <code>&#39;a</code> å’Œ <code>T</code> åå˜ï¼Œå› ä¸º <code>&amp;</code> æ˜¯åªè¯»çš„ï¼Œä¼ å‚æ•°çš„æ—¶å€™ï¼Œè¯•å›¾æ”¶ç¼©lifetimeæ˜¯å®‰å…¨çš„ï¼›</strong></font></p>
</li>
<li><p><font color="#f00"><strong>â‘¡ <code>&amp;&#39;a mut T</code> å¯¹ <code>&#39;a</code> åå˜ï¼Œå¯¹ <code>T</code> ä¸å˜ï¼š</strong></font></p>
</li>
</ul>
<p>è¿™æ˜¯å› ä¸ºï¼šä¼ å‚æ•°çš„æ—¶å€™ï¼Œæ”¶ç´§ä¸€ä¸ªå¯å˜ä½œç”¨åŸŸçš„èŒƒå›´æ˜¯å®‰å…¨çš„ï¼Œè°ƒç”¨è€…è¿˜ç»´æŒç€æœªæ”¶ç´§çš„ä½œç”¨åŸŸï¼›</p>
<ul>
<li><font color="#f00"><strong>â‘¢ <code>fn(T) -&gt; U</code> æ˜¯å¯¹ <code>T</code> é€†å˜å¯¹ <code>U</code> åå˜ï¼š</strong></font></li>
</ul>
<p>åŸå› å’Œä¸Šæ–‡æ‰€è¿°ä¸€æ ·ï¼šå½“ä¼ å…¥çš„å‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥å®‰å…¨åœ°æ”¶ç¼©è¿™ä¸ªå‡½æ•°çš„å®šä¹‰åŸŸï¼Œæ‰©å¼ è¿™ä¸ªå‡½æ•°çš„é™ªåŸŸï¼Œ<strong>é™¤æ­¤å¤„å¤–Rustä¸­åº”è¯¥æ²¡æœ‰é€†å˜ï¼›</strong></p>
<ul>
<li><font color="#f00"><strong>â‘£ åªè¯»æˆ–æ‹¥æœ‰ï¼ˆowningï¼‰çš„å®¹å™¨éƒ½æ˜¯åå˜çš„ï¼Œå¦‚ï¼š<code>Box</code>, <code>Vec</code>éƒ½æ˜¯åå˜çš„ï¼š</strong></font></li>
</ul>
<p>è¿™åœ¨åˆ«çš„è¯­è¨€ä¸­ä¼šçˆ†ç‚¸ï¼Œä½†æ˜¯Rustå¯¹å¯å˜æ€§çš„é™åˆ¶å¯¼è‡´å¯ä»¥å®‰å…¨åœ°å½“ä½œåå˜ï¼š</p>
<p>å½“æˆ‘ä»¬æ‹¿åˆ°ä¸€ä¸ªå®¹å™¨çš„æ‰€æœ‰æƒçš„æ—¶å€™ï¼Œå¤–éƒ¨åˆ«å¤„å°±æ— æ³•è®¿é—®äº†ï¼Œå¯ä»¥å®‰å…¨åœ°å¯¹å®ƒåå˜è€Œä¸ç”¨æ‹…å¿ƒçˆ†ç‚¸ï¼›</p>
<ul>
<li><font color="#f00"><strong>â‘¤ <code>Cell&lt;T&gt;``RefCell&lt;T&gt;</code>ï¼Œåœ¨å†…éƒ¨æ˜¯å¯è¯»å†™çš„ï¼Œæ‰€ä»¥æ˜¯ä¸å˜ï¼›</strong></font></li>
</ul>
<p>æ­£å¦‚æ–‡ä¸­çš„ä¾‹å­ä¸€æ ·ï¼š</p>
<pre><code class="rust">fn overwrite&lt;T: Copy&gt;(covarianced: &amp;mut T, short: &amp;mut T) {
    *covarianced = *short;
}

fn main() {
    let mut forever: &amp;&#39;static str = &quot; æˆ‘ä¼šæ´»åˆ°ä¸–ç•Œæœ«æ—¥ &quot;;
    &#39;small {
        let short = String::from(&quot; æˆ‘é©¬ä¸Šæ­»äº† &quot;);
        overwrite(&amp;mut forever, &amp;mut &amp;*short);
    }
    // çˆ†ç‚¸ï¼ç”¨åˆ°äº†å·²ç»è¢«é‡Šæ”¾çš„å†…å­˜
    println!(&quot;{}&quot;, forever);
}</code></pre>
<p>å¦‚æœåœ¨ä¸€æ¬¡å‡½æ•°è°ƒç”¨æ—¶ï¼š</p>
<p>ä¸€ä¸ª <code>forever: &amp;mut &amp;&#39;static T</code> èƒ½å¤Ÿåå˜åˆ° <code>covarianced: &amp;mut &amp;&#39;small T</code> ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠä¸€ä¸ª <code>short: &amp;&#39;small T</code> å­˜è¿›åå˜åçš„å‚æ•° <code>covarianced: &amp;mut &amp;&#39;small T</code>ï¼›</p>
<p>è¿™å¯¹äºè°ƒç”¨è€…æ¥è¯´ï¼Œå¼•ç”¨ <code>covarianced</code> çš„ç±»å‹ä¾ç„¶æ˜¯ <code>&amp;mut &amp;&#39;static T</code>ï¼Œå´å­˜äº†ä¸€ä¸ªæ›´çŸ­å‘½çš„å¼•ç”¨ <code>short</code>ï¼›</p>
<p>å½“ <code>short</code> è¢«é”€æ¯çš„æ—¶å€™ï¼Œ<code>a</code> è¿˜ç»´æŒç€å¼•ç”¨ï¼Œå°±â€¦ä¼šç‚¸ï¼›</p>
<p>è‡³äºè¿™é‡Œä¸ºä»€ä¹ˆä¸èƒ½ç”¨é€†å˜ï¼ŒåŸå› å¾ˆç®€å•ï¼Œå°±æ˜¯ <code>&amp;mut T</code> ï¼Œ<code>T</code> æ˜¯å¯è¯»å¯å†™çš„ï¼Œå¦‚æœèƒ½æ‰©å¼  <code>T</code> çš„ä½œç”¨åŸŸï¼ˆé€†å˜ï¼‰ï¼Œè¯»å–å‡ºæ¥å­˜åˆ°åˆ«çš„åœ°æ–¹è¿˜æ˜¯ä¼šç‚¸ï¼›</p>
<blockquote>
<p>  if variance would allow you to store a short-lived value in a longer-lived slot, then invariance must be used.</p>
</blockquote>
<blockquote>
<p>  å…·ä½“åå˜ã€é€†å˜å’Œä¸å˜ç›¸å…³å†…å®¹å¯ä»¥é˜…è¯»ï¼š</p>
<ul>
<li><a href="https://zh.wikipedia.org/wiki/%E5%8D%8F%E5%8F%98%E4%B8%8E%E9%80%86%E5%8F%98" target="_blank" rel="noopener">ç»´åŸºç™¾ç§‘-åå˜ä¸é€†å˜</a></li>
<li><a href="https://doc.rust-lang.org/nomicon/vec/vec-layout.html" target="_blank" rel="noopener">https://doc.rust-lang.org/nomicon/vec/vec-layout.html</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/41814387" target="_blank" rel="noopener">é€†å˜ã€åå˜ä¸å­ç±»å‹ï¼Œä»¥åŠRust</a></li>
<li><a href="https://link.zhihu.com/?target=https%3A//doc.rust-lang.org/nomicon/subtyping.html" target="_blank" rel="noopener">æ­»çµä¹¦ï¼šlifetimeçš„å­ç±»å‹åŠé€†å˜åå˜</a></li>
<li><a href="https://ehsanmkermani.com/2019/03/16/variance-in-rust-an-intuitive-explanation/" target="_blank" rel="noopener">Variance in Rust: An intuitive explanation</a></li>
</ul>
</blockquote>
<br>

<h5 id="NonNullå’Œ-mut"><a href="#NonNullå’Œ-mut" class="headerlink" title="NonNullå’Œ*mut"></a><strong><code>NonNull</code>å’Œ<code>*mut</code></strong></h5><p>NonNullçš„å®˜æ–¹æ³¨é‡Šå¦‚ä¸‹ï¼š</p>
<pre><code>*mut T but non-zero and covariant.
This is often the correct thing to use when building data structures using raw pointers, but is ultimately more dangerous to use because of its additional properties. If you&#39;re not sure if you should use NonNull&lt;T&gt;, just use *mut T!
Unlike *mut T, the pointer must always be non-null, even if the pointer is never dereferenced. This is so that enums may use this forbidden value as a discriminant -- Option&lt;NonNull&lt;T&gt;&gt; has the same size as *mut T. However the pointer may still dangle if it isn&#39;t dereferenced.
Unlike *mut T, NonNull&lt;T&gt; was chosen to be covariant over T. This makes it possible to use NonNull&lt;T&gt; when building covariant types, but introduces the risk of unsoundness if used in a type that shouldn&#39;t actually be covariant. (The opposite choice was made for *mut T even though technically the unsoundness could only be caused by calling unsafe functions.)
Covariance is correct for most safe abstractions, such as Box, Rc, Arc, Vec, and LinkedList. This is the case because they provide a public API that follows the normal shared XOR mutable rules of Rust.
If your type cannot safely be covariant, you must ensure it contains some additional field to provide invariance. Often this field will be a PhantomData type like PhantomData&lt;Cell&lt;T&gt;&gt; or PhantomData&lt;&amp;&#39;a mut T&gt;.
Notice that NonNull&lt;T&gt; has a From instance for &amp;T. However, this does not change the fact that mutating through a (pointer derived from a) shared reference is undefined behavior unless the mutation happens inside an UnsafeCell&lt;T&gt;. The same goes for creating a mutable reference from a shared reference. When using this From instance without an UnsafeCell&lt;T&gt;, it is your responsibility to ensure that as_mut is never called, and as_ptr is never used for mutation.</code></pre><p><strong>é¦–å…ˆï¼ŒNonNullå°±æ˜¯ <code>*mut T</code>ï¼Œä½†æ˜¯ä¸ä¼šç­‰äºé›¶ï¼›</strong></p>
<p>éšåï¼ŒNonNullæ˜¯åå˜ï¼š<strong>ã€å³æœ‰ä¸€ä¸ªå­ç”Ÿå‘½å‘¨æœŸ<code>Small</code>å’Œçˆ¶ç”Ÿå‘½å‘¨æœŸ <code>Longer</code>ï¼ŒNonNullç»´æŒäº† <code>NonNull&lt;Small&gt;</code> ä¹Ÿæ˜¯<code>NonNull&lt;Longer&gt;</code>çš„ç”Ÿå‘½å‘¨æœŸçš„å…³ç³»ï¼ã€‘ï¼›</strong></p>
<p><strong>åŒæ—¶ï¼Œ<code>NonNull&lt;T&gt;</code> ä¸ä¼šæ‹¥æœ‰ <code>T</code>ï¼Œå› ä¸ºå…¶æœ¬èº«åªæ˜¯ä¸€ä¸ªæŒ‡é’ˆ<code>*mut T</code>ï¼Œæ²¡æœ‰æ‹¥æœ‰çš„è¯­ä¹‰ï¼›</strong></p>
<blockquote>
<p>  <strong>å› æ­¤éœ€è¦å€ŸåŠ© PhantomData è¿›è¡Œæ ‡æ³¨ï¼›</strong></p>
</blockquote>
<p><strong>æœ€åï¼ŒNonNull å¯ä»¥åšç©ºæŒ‡é’ˆä¼˜åŒ–ï¼š</strong></p>
<blockquote>
<p>  <code>Option&lt;Rc&lt;T&gt;&gt;</code>è·Ÿ<code>Rc&lt;T&gt;</code>å ç”¨ç›¸åŒçš„å†…å­˜å¤§å°ï¼Œè¿™ä¸ªå«<a href="https://link.zhihu.com/?target=https%3A//rust-lang.github.io/unsafe-code-guidelines/layout/enums.html%23discriminant-elision-on-option-like-enums" target="_blank" rel="noopener">discriminant elision</a>ï¼›</p>
<p>  <strong>ç©ºæŒ‡é’ˆä¼˜åŒ–èƒ½å¤Ÿå®ç°çš„åŸå› åœ¨äºï¼š</strong></p>
<p>  <font color="#f00"><strong>å› ä¸º enum é€šå¸¸éœ€è¦ä¸€ä¸ªæ ‡å¿—ï¼ˆdiscriminantï¼‰æ¥åŒºåˆ†ç©¶ç«Ÿæ˜¯å“ªä¸€ä¸ªvariantï¼Œä½†æ˜¯Optionåªæœ‰ä¸¤ä¸ªvariantçš„enumï¼Œå…¶ä¸­ä¸€ä¸ªvariantï¼Œæœ‰ä¸€äº›éæ³•çš„å€¼ï¼ˆå«nichesï¼‰ï¼Œè¿™äº›éæ³•çš„å€¼å¯ä»¥å……å½“Noneä¸€æ ·çš„variantï¼Œæ‰€ä»¥å°±ä¸ç”¨æ ‡å¿—äº†ï¼Œä»è€Œenumä¸variantå ç”¨ä¸€æ ·çš„å¤§å°ï¼›</strong></font></p>
</blockquote>
<br>

<p>æœ€åï¼Œå†æ¥å›é¡¾ <code>next</code> å’Œ <code>prev</code> çš„ç±»å‹ä¸ºï¼š<code>Option&lt;NonNull&lt;Node&lt;T&gt;&gt;&gt;</code>ï¼›</p>
<p>å³ï¼Œ <code>next</code> å’Œ <code>prev</code> æœ€ç»ˆæŒ‡å‘äº†å¦ä¸€ä¸ªå’Œè‡ªå·±ç›¸åŒçš„ç±»å‹ï¼š<code>Node&lt;T&gt;</code>ï¼›</p>
<p>è¿™æ˜¯åˆç†çš„ï¼Œå› ä¸ºåœ¨æ•´ä¸ª <code>Node</code> ç±»å‹ä¸­ï¼Œæ‰€æœ‰çš„å±æ€§çš„å¤§å°åœ¨ç¼–è¯‘æœŸéƒ½æ˜¯å¯ä»¥è¢«ç¡®å®šçš„<strong>ï¼ˆæ³›å‹ç±»å‹T åœ¨ç¼–è¯‘å™¨è¢«ç»‘å®šï¼Œè€Œ <code>next</code> å’Œ <code>prev</code> ä¸ºä¸¤ä¸ªå›ºå®šå¤§å°çš„è£¸æŒ‡é’ˆï¼‰</strong>ï¼</p>
<pre><code class="rust">struct Node&lt;T&gt; {
    val: T,
    next: Option&lt;NonNull&lt;Node&lt;T&gt;&gt;&gt;,
    prev: Option&lt;NonNull&lt;Node&lt;T&gt;&gt;&gt;,
}</code></pre>
<blockquote>
<p>  <strong>æ³¨æ„ï¼šRustçš„ç¼–è¯‘å™¨è¦æ±‚ï¼Œåœ¨ç¼–è¯‘æœŸæ‰€æœ‰çš„å±æ€§çš„å¤§å°éƒ½æ˜¯ç¡®å®šçš„ï¼</strong></p>
<p>  ä¾‹å¦‚ï¼Œä¸‹é¢çš„ä»£ç æ˜¯æ— æ³•é€šè¿‡ç¼–è¯‘çš„ï¼š</p>
<pre><code class="rust">  struct WrongNode&lt;T&gt; {
      data: T,
      next: WrongNode&lt;T&gt;,
  }</code></pre>
<p>  å› ä¸º <code>next</code> å­—æ®µæ‹¥æœ‰çš„å¤§å°å¯èƒ½æ˜¯æ— é™çš„ï¼Œæ— æ³•è®¡ç®—ï¼›</p>
<p>  è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆé€šå¸¸æƒ…å†µä¸‹ï¼Œå•å‘é“¾è¡¨éœ€è¦å€ŸåŠ©æ™ºèƒ½æŒ‡é’ˆ Box å°†ç»“æ„ä½“è½¬åŒ–ä¸ºæŒ‡é’ˆï¼š</p>
<pre><code class="rust">  struct WrongNode&lt;T&gt; {
      data: T,
      next: Box&lt;WrongNode&lt;T&gt;&gt;,
  }</code></pre>
<p>  <strong>ä½†æ˜¯åœ¨åŒå‘é“¾è¡¨ä¸­ï¼Œä½¿ç”¨ Box æ˜¯è¡Œä¸é€šçš„ï¼Œå› ä¸ºä¼šå‡ºç°ä¸€ä¸ªèŠ‚ç‚¹åŒæ—¶å­˜åœ¨å¤šä¸ªå¯å˜å¼•ç”¨çš„æƒ…å†µï¼Œå› æ­¤éœ€è¦ä½¿ç”¨è£¸æŒ‡é’ˆï¼›</strong></p>
</blockquote>
<p>æœ€åï¼Œä¸€ä¸ªç®€å•çš„æ„é€ å‡½æ•°ï¼Œå’Œ into è½¬æ¢å‡½æ•°ï¼Œç”¨äºå°† Box ä¸­çš„ <code>Node&lt;T&gt;</code> è½¬ä¸ºå«æœ‰æ‰€æœ‰æƒçš„ <code>T</code> ç±»å‹ï¼Œè¿™ä¸ªå‡½æ•°ä¸‹é¢ä¼šç”¨åˆ°ï¼š</p>
<pre><code class="rust">impl&lt;T&gt; Node&lt;T&gt; {
    fn new(val: T) -&gt; Node&lt;T&gt; {
        Node {
            val,
            prev: None,
            next: None,
        }
    }

    fn into_val(self: Box&lt;Self&gt;) -&gt; T {
        self.val
    }
}</code></pre>
<p>é“¾è¡¨èŠ‚ç‚¹çš„å…·ä½“å†…å®¹å¤§æ¦‚å°±æ˜¯è¿™ä¹ˆå¤šï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹æ•´ä¸ªåŒå‘é“¾è¡¨çš„å®šä¹‰ï¼›</p>
<br>

<h3 id="åŒå‘é“¾è¡¨å®šä¹‰ï¼šLinkedList"><a href="#åŒå‘é“¾è¡¨å®šä¹‰ï¼šLinkedList" class="headerlink" title="åŒå‘é“¾è¡¨å®šä¹‰ï¼šLinkedList"></a><strong>åŒå‘é“¾è¡¨å®šä¹‰ï¼šLinkedList</strong></h3><p>åŒå‘é“¾è¡¨çš„å®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre><code class="rust">pub struct LinkedList&lt;T&gt; {
    length: usize,
    head: Option&lt;NonNull&lt;Node&lt;T&gt;&gt;&gt;,
    tail: Option&lt;NonNull&lt;Node&lt;T&gt;&gt;&gt;,
    _marker: PhantomData&lt;Box&lt;Node&lt;T&gt;&gt;&gt;,
}</code></pre>
<p>åœ¨åŒå‘é“¾è¡¨ä¸­ï¼Œå®šä¹‰äº†ï¼š</p>
<ul>
<li><strong>é“¾è¡¨çš„å¤´å°¾èŠ‚ç‚¹ï¼š</strong><code>head</code> å’Œ <code>tail</code>ï¼Œç±»å‹å’Œä¸Šé¢çš„ <code>Node</code> å†…éƒ¨çš„æŒ‡é’ˆä¸€æ ·ï¼š<code>Option&lt;NonNull&lt;Node&lt;T&gt;&gt;&gt;</code>ï¼Œè¿™é‡Œä¸å†ä»‹ç»ï¼›</li>
<li><strong>lengthï¼š</strong>ç»´æŠ¤åŒå‘é“¾è¡¨çš„å½“å‰é•¿åº¦ï¼›</li>
</ul>
<p>é‡ç‚¹æ¥çœ‹ä¸€ä¸‹ï¼š<strong>_marker</strong>ï¼›</p>
<p><strong>_marker</strong> è¢«å£°æ˜ä¸º <code>PhantomData&lt;Box&lt;Node&lt;T&gt;&gt;&gt;</code> ç±»å‹ï¼Œå¯¹äº PhantomData çš„è¯´æ˜å¦‚ä¸‹ï¼š</p>
<pre><code>Zero-sized type used to mark things that &quot;act like&quot; they own a T.
Adding a PhantomData&lt;T&gt; field to your type tells the compiler that your type acts as though it stores a value of type T, even though it doesn&#39;t really. This information is used when computing certain safety properties.</code></pre><p>å³ <strong>_marker</strong> æ˜¯ä¸€ä¸ªæ ‡æ³¨å­—æ®µï¼Œå…¶ç›®çš„å°±æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨ï¼šLinkedList æ‹¥æœ‰ <code>Box&lt;Node&lt;T&gt;&gt;</code>ï¼Œæ˜ç¤ºç¼–è¯‘å™¨æˆ‘ä»¬å¾ˆå¯èƒ½åœ¨LinkedList çš„ drop å‡½æ•°é‡Œé¢ä¹Ÿ drop æ‰ <code>Box&lt;Node&lt;T&gt;&gt;</code>ï¼›</p>
<blockquote>
<p>  ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„åœºæ™¯å¦‚ä¸‹ï¼š</p>
<p>  <strong>ç”±äºåœ¨ LinkedList ä¸­ï¼Œ<code>head</code> å’Œ <code>tail</code> éƒ½ä»¥æŒ‡é’ˆçš„å½¢å¼å­˜åœ¨ï¼›</strong></p>
<p>  <strong>è€Œåœ¨å®ç°è¿­ä»£å™¨æ—¶ï¼Œå¿…é¡»è¦æ±‚æ ‡æ³¨å½“å‰æ³›å‹ <code>T</code> çš„å£°æ˜å‘¨æœŸï¼Œæ­¤æ—¶æˆ‘ä»¬å°±éœ€è¦é€šè¿‡ä½¿ç”¨<code>PhantomData</code> å¯¹å˜é‡çš„æ‰€æœ‰æƒè¿›è¡Œå£°æ˜ï¼Œå¹¶å¯¹ç”Ÿå‘½å‘¨æœŸè¿›è¡Œæ ‡æ³¨ï¼</strong></p>
</blockquote>
<p>ä»¥ä¸Šå°±æ˜¯æˆ‘ä»¬è¦å®ç°çš„åŒå‘é“¾è¡¨çš„å®Œæ•´å®šä¹‰ï¼›</p>
<blockquote>
<p>  <strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</strong></p>
<p>  <font color="#f00"><strong>ä¸ºäº†ä½“ç°å°è£…æ€§ï¼ŒNode å’Œ LinkedList ä¸­çš„æ‰€æœ‰å­—æ®µéƒ½æ˜¯å¯¹å¤–ä¸å¯è§çš„ï¼</strong></font></p>
</blockquote>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬ä¼šé€æ­¥å®ç°åŒå‘é“¾è¡¨çš„ç›¸å…³APIï¼Œå¹¶å°½é‡å¯¹æ€§èƒ½åšä¼˜åŒ–ï¼›</p>
<br>

<h2 id="å…·ä½“æ–¹æ³•å®ç°"><a href="#å…·ä½“æ–¹æ³•å®ç°" class="headerlink" title="å…·ä½“æ–¹æ³•å®ç°"></a><strong>å…·ä½“æ–¹æ³•å®ç°</strong></h2><h3 id="â‘ -æ„é€ å‡½æ•°ï¼šnew-å’ŒDefault-Trait"><a href="#â‘ -æ„é€ å‡½æ•°ï¼šnew-å’ŒDefault-Trait" class="headerlink" title="â‘  æ„é€ å‡½æ•°ï¼šnew()å’ŒDefault Trait"></a><strong>â‘  æ„é€ å‡½æ•°ï¼šnew()å’ŒDefault Trait</strong></h3><p>æ„é€ å‡½æ•°çš„å®ç°éå¸¸ç®€å•ï¼š</p>
<pre><code class="rust">impl&lt;T&gt; LinkedList&lt;T&gt; {
    pub fn new() -&gt; Self {
        Self {
            length: 0,
            head: None,
            tail: None,
            _marker: PhantomData,
        }
    }
}

impl&lt;T&gt; Default for LinkedList&lt;T&gt; {
    fn default() -&gt; Self {
        Self::new()
    }
}</code></pre>
<p>åœ¨ <code>new()</code> æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬ç›´æ¥åˆ›å»ºäº†ä¸€ä¸ª LinkedList ç±»å‹çš„å¯¹è±¡ï¼ˆ<strong>æ­¤å¤„çš„<code>Self</code>ä»£æŒ‡çš„å°±æ˜¯ LinkedList ç±»å‹</strong>ï¼‰å¹¶è¿”å›ï¼›</p>
<blockquote>
<p>  <strong>æ³¨æ„åˆ°ï¼š</strong></p>
<p>  <strong>åœ¨ç»™<code>_marker</code>è¿›è¡Œèµ‹å€¼æ—¶ï¼Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨äº†PhantomDataï¼›</strong></p>
<p>  <font color="#f00"><strong>è¿™æ˜¯å› ä¸ºå®é™…ä¸ŠPhantomDataæ˜¯ä¸€ä¸ªZSTï¼ˆZero-Size Typeï¼‰ï¼Œå³æ— å†…å­˜å¤§å°ç±»å‹ï¼›</strong></font></p>
<p>  ä» <code>PhantomData</code> çš„å®šä¹‰ä¸­æˆ‘ä»¬ä¹Ÿèƒ½çœ‹å‡ºæ¥ï¼š</p>
<pre><code class="rust">  #[lang = &quot;phantom_data&quot;]
  #[stable(feature = &quot;rust1&quot;, since = &quot;1.0.0&quot;)]
  pub struct PhantomData&lt;T: ?Sized&gt;;</code></pre>
<p>  <font color="#f00"><strong>å¾—ç›ŠäºRustçš„ä¼˜åŒ–ï¼Œè¿™äº›ç»“æ„ä½“åœ¨ç¼–è¯‘åéƒ½æ˜¯ä¸ä¼šå ç”¨å†…å­˜å¤§å°çš„ï¼</strong></font></p>
<p>  <font color="#f00"><strong>å› æ­¤ï¼Œæˆ‘ä»¬çš„ <code>_marker</code> å­—æ®µåœ¨ç¼–è¯‘åï¼Œç”šè‡³ä¸ä¼šå ç”¨å†…å­˜ç©ºé—´ï¼</strong></font></p>
</blockquote>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸º LinkedList ç®€å•å®ç°äº† <code>Default</code> Traitï¼Œè¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼åˆ›å»ºå‡ºä¸€ä¸ª LinkedListï¼š</p>
<pre><code class="rust">let list: LinkedList&lt;i32&gt; = LinkedList::default();
let list: LinkedList&lt;i32&gt; = LinkedList::new();</code></pre>
<br>

<h3 id="â‘¡-é¦–å°¾å‹å…¥å…ƒç´ ï¼špush"><a href="#â‘¡-é¦–å°¾å‹å…¥å…ƒç´ ï¼špush" class="headerlink" title="â‘¡ é¦–å°¾å‹å…¥å…ƒç´ ï¼špush()"></a><strong>â‘¡ é¦–å°¾å‹å…¥å…ƒç´ ï¼špush()</strong></h3><p>åœ¨å°†ä¸€ä¸ªå…ƒç´ å‹å…¥åŒå‘é“¾è¡¨æ—¶ï¼Œéœ€è¦æ³¨æ„ï¼šæˆ‘ä»¬éœ€è¦è·å–å…ƒç´ å®Œæ•´çš„æ‰€æœ‰æƒï¼›</p>
<p>å…·ä½“åœ¨é“¾è¡¨å¤´éƒ¨å‹å…¥å…ƒç´ çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="rust">/// Adds the given node to the front of the list.
pub fn push_front(&amp;mut self, val: T) {
    // Use box to help generate raw ptr
    let mut node = Box::new(Node::new(val));
    node.next = self.head;
    node.prev = None;
    let node = NonNull::new(Box::into_raw(node));

    match self.head {
        None =&gt; self.tail = node,
        Some(head) =&gt; unsafe { (*head.as_ptr()).prev = node },
    }

    self.head = node;
    self.length += 1;
}</code></pre>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬ä½¿ç”¨å…¥å‚ä¸­çš„ <code>val</code> åˆ›å»ºäº†ä¸€ä¸ªé“¾è¡¨èŠ‚ç‚¹Nodeï¼Œå¹¶ä½¿ç”¨ <code>Box</code> åŒ…è£…ï¼ˆ<strong>è¿™ä¹ˆåšæ˜¯æ–¹ä¾¿æˆ‘ä»¬åé¢ç›´æ¥ä» Box è·å–åˆ°è£¸æŒ‡é’ˆ</strong>ï¼‰ï¼›</p>
<p>éšåï¼Œå¯¹ node è¿›è¡Œèµ‹å€¼ï¼š</p>
<p>ç”±äºæ˜¯åœ¨å¤´éƒ¨æ’å…¥ï¼Œå› æ­¤æ–°èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå…ƒç´ ä¾¿æ˜¯å½“å‰é“¾è¡¨çš„å¤´èŠ‚ç‚¹ï¼Œè€Œæ–°èŠ‚ç‚¹çš„ä¸Šä¸€ä¸ªå…ƒç´ æ˜¯ç©ºï¼ˆå› ä¸ºå½“å‰èŠ‚ç‚¹ä¼šæˆä¸ºæ–°çš„é“¾è¡¨çš„å¤´èŠ‚ç‚¹ï¼‰ï¼›</p>
<blockquote>
<p>  <strong>è¿™é‡Œå¾—ç›ŠäºRustä¸­å„ç§æ™ºèƒ½æŒ‡é’ˆéƒ½å®ç°äº† <code>Deref</code> Traitï¼Œå¹¶ä¸”ç¼–è¯‘å™¨ä¼šå¯¹å…·ä½“çš„ç±»å‹è¿›è¡Œä¸€ç³»åˆ— <code>ref/deref</code> çš„ç±»å‹æ¨å¯¼ï¼ˆè¿™ä¸€ç‚¹å’ŒGolangæä¸ºç›¸ä¼¼ï¼‰ï¼›</strong></p>
<p>  <strong>å› æ­¤ï¼Œå°½ç®¡æˆ‘ä»¬ä½¿ç”¨ <code>Box</code> å¯¹ Node è¿›è¡Œäº†ä¸€å±‚åŒ…è£…ï¼Œä½† node ä½¿ç”¨èµ·æ¥å’ŒæœªåŒ…è£…çš„ä½“éªŒå®Œå…¨ä¸€è‡´ï¼</strong></p>
</blockquote>
<p>æ¥ä¸‹æ¥ï¼Œä½¿ç”¨ <code>Box::into_raw(node)</code>ï¼Œå°† node è½¬ä¸ºè£¸æŒ‡é’ˆï¼›</p>
<p>ä¸‹é¢æ˜¯ <code>Box::into_raw</code> çš„å®˜æ–¹æ–‡æ¡£ï¼š</p>
<pre><code>Consumes the Box, returning a wrapped raw pointer.
æ¶ˆè´¹Boxï¼Œå¹¶è¿”å›ä¸€ä¸ªè£¸æŒ‡é’ˆã€‚

The pointer will be properly aligned and non-null.
ï¼ˆå‡½æ•°ä¿è¯ï¼‰æŒ‡é’ˆåœ¨å†…å­˜ä¸­æ­£ç¡®å¯¹é½å¹¶ä¸”éç©ºã€‚

After calling this function, the caller is responsible for the memory previously managed by the Box. 
è°ƒç”¨æ­¤å‡½æ•°åï¼Œè°ƒç”¨è€…è´Ÿè´£ä¹‹å‰ç”± Box ç®¡ç†çš„å†…å­˜ã€‚

In particular, the caller should properly destroy T and release the memory, taking into account the memory layout used by Box. The easiest way to do this is to convert the raw pointer back into a Box with the Box::from_raw function, allowing the Box destructor to perform the cleanup.
ç‰¹åˆ«æ˜¯ï¼Œè°ƒç”¨è€…åº”è¯¥é€‚å½“åœ°é”€æ¯ T å¹¶é‡Šæ”¾å†…å­˜ï¼ŒåŒæ—¶è€ƒè™‘åˆ° Box ä½¿ç”¨çš„å†…å­˜å¸ƒå±€ã€‚æœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨ Box::from_raw å‡½æ•°å°†åŸå§‹æŒ‡é’ˆè½¬æ¢å› Boxï¼Œä»è€Œå…è®¸ Box ææ„å‡½æ•°æ‰§è¡Œæ¸…ç†ã€‚

Note: this is an associated function, which means that you have to call it as Box::into_raw(b) instead of b.into_raw(). This is so that there is no conflict with a method on the inner type.
æ³¨æ„ï¼šè¿™æ˜¯ä¸€ä¸ªå…³è”å‡½æ•°ï¼Œè¿™æ„å‘³ç€æ‚¨å¿…é¡»å°†å…¶ç§°ä¸º Box::into_raw(b) è€Œä¸æ˜¯ b.into_raw()ã€‚è¿™æ ·å°±ä¸ä¼šä¸å†…éƒ¨ç±»å‹çš„æ–¹æ³•å‘ç”Ÿå†²çªã€‚</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œ<strong>å½“å¯¹æŸä¸ªè¢« Box åŒ…è£…çš„å˜é‡è°ƒç”¨äº† <code>Box::into_raw</code> åï¼Œå˜é‡å°†ä¼šè¢«è½¬åŒ–ä¸ºè£¸æŒ‡é’ˆï¼ŒåŒæ—¶æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜çš„ç®¡ç†æƒä¼šè¢«äº¤ç»™æˆ‘ä»¬è‡ªå·±ï¼›</strong></p>
<p>ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ</p>
<p><strong>é€šå¸¸æƒ…å†µä¸‹åœ¨Rustä¸­ï¼Œå½“ä¸€ä¸ªå˜é‡é€€å‡ºäº†è‡ªå·±çš„ä½œç”¨åŸŸåï¼ŒRustä¾¿ä¼šè‡ªåŠ¨è°ƒç”¨å…¶ <code>drop</code> å‡½æ•°é‡Šæ”¾å…¶å ç”¨çš„å†…å­˜ï¼ˆè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå°½ç®¡Rustæ²¡æœ‰GCï¼Œæ²¡æœ‰freeå‡½æ•°ï¼Œä¹Ÿèƒ½ä¿è¯å†…å­˜çš„å®‰å…¨çš„åŸå› ï¼‰ï¼›</strong></p>
<p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬å¯¹æŸä¸ªè¢« Box åŒ…è£…çš„å˜é‡è°ƒç”¨äº† <code>Box::into_raw</code> åï¼Œä¹‹å‰çš„å˜é‡ä¾¿è¢«è½¬ä¸ºäº†ä¸€ä¸ªè£¸æŒ‡é’ˆï¼</p>
<p>æ­¤æ—¶æˆ‘ä»¬åªèƒ½é€šè¿‡è¿™ä¸ªè£¸æŒ‡é’ˆå»è®¿é—®åŸæ¥çš„å˜é‡ï¼›</p>
<blockquote>
<p>  <strong>å®é™…ä¸Š <code>Box::new()</code> å°±æ˜¯åˆ›å»ºäº†ä¸€ä¸ªæŒ‡å‘å…·ä½“å˜é‡å€¼çš„æŒ‡é’ˆï¼›</strong></p>
<p>  <strong>è€Œ Box ä½œä¸ºæ™ºèƒ½æŒ‡é’ˆï¼Œåœ¨é€€å‡ºä½œç”¨åŸŸåï¼Œä¼šç›´æ¥é‡Šæ”¾æŒ‡é’ˆçš„å†…å­˜ï¼Œä»¥åŠæŒ‡é’ˆæŒ‡å‘çš„å˜é‡çš„å†…å­˜ï¼ˆç±»ä¼¼äºC++ä¸­çš„ unique_prt ï¼‰</strong></p>
</blockquote>
<p><code>Box::into_raw</code> æ‰€åšçš„å…¶å®å°±æ˜¯æ¶ˆè´¹æ‰ Box å¹¶è¿”å›æŒ‡é’ˆï¼Œå¹¶ä¸”ä¿è¯ä¸ä¼šåƒ Box é€€å‡ºä½œç”¨åŸŸåé‡Šæ”¾æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ï¼ˆ<strong>å¦åˆ™æš´éœ²çš„æŒ‡é’ˆæŒ‡å‘çš„æ˜¯é‡å†…å­˜ï¼Œä¹‹åå–æ•°æ®ä¼šå‡ºé—®é¢˜ï¼Œå¹¶ä¸”é‡Šæ”¾ä¹Ÿä¼šå‡ºé—®é¢˜ï¼</strong>ï¼‰ï¼›</p>
<p><strong>å› æ­¤ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±ä¿å­˜è¿™ä¸ªè£¸æŒ‡é’ˆï¼Œå¹¶åœ¨é€‚å½“æ—¶å€™é‡Šæ”¾è¿™ä¸ªè£¸æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ï¼</strong></p>
<p>é‚£ä¹ˆå¦‚ä½•é‡Šæ”¾ç”± Box è½¬æ¢æ‰€å¾—çš„è£¸æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜å‘¢ï¼Ÿ</p>
<p>æ–‡æ¡£å†™çš„ä¹Ÿéå¸¸æ¸…æ¥šï¼š</p>
<p><font color="#f00"><strong>æœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨ <code>Box::from_raw</code> å‡½æ•°å°†åŸå§‹æŒ‡é’ˆè½¬æ¢å› Boxï¼Œä»è€Œå…è®¸ Box ææ„å‡½æ•°æ‰§è¡Œæ¸…ç†ï¼›</strong></font></p>
<p><font color="#f00"><strong>æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å°†è£¸æŒ‡é’ˆå†è½¬ä¸ºå®é™…çš„ Boxï¼Œç„¶åé€šè¿‡ Box é€€å‡ºä½œç”¨åŸŸåç›´æ¥é‡Šæ”¾å†…å­˜å³å¯ï¼›</strong></font></p>
<blockquote>
<p>  <strong>æ³¨ï¼šä¸Šé¢çš„æŠ€å·§åœ¨ Unsafe Rust ä¸­éå¸¸å¸¸è§ï¼</strong></p>
<p>  <strong>åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä¼šå¤§é‡ä½¿ç”¨ï¼</strong></p>
</blockquote>
<br>

<p>åœ¨å°† node è½¬ä¸ºè£¸æŒ‡é’ˆåï¼Œæ¥ä¸‹æ¥åˆ¤æ–­å½“å‰é“¾è¡¨çš„å¤´èŠ‚ç‚¹æ˜¯å¦ä¸ºç©ºï¼š</p>
<pre><code class="rust">match self.head {
    None =&gt; self.tail = node,
    Some(head) =&gt; unsafe { (*head.as_ptr()).prev = node },
}</code></pre>
<p>å¦‚æœä¸ºç©ºï¼Œåˆ™å°†é“¾è¡¨çš„å°¾èŠ‚ç‚¹ä¹ŸæŒ‡å‘è¿™ä¸ªæ–°èŠ‚ç‚¹å³å¯ï¼›</p>
<p>å¦‚æœå¤´èŠ‚ç‚¹ä¸ä¸ºç©ºï¼Œåˆ™éœ€è¦å°†å½“å‰é“¾è¡¨å¤´èŠ‚ç‚¹çš„å‰ä¸€ä¸ªå…ƒç´ èµ‹å€¼ä¸ºæ–°çš„èŠ‚ç‚¹ï¼›</p>
<p><strong>æ³¨æ„ï¼Œè¿™é‡Œä½¿ç”¨åˆ°äº† <code>unsafe</code>ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦å°†é“¾è¡¨ä¸­çš„å¤´æŒ‡é’ˆ <code>head</code> è£¸æŒ‡é’ˆè¿›è¡Œè§£å¼•ç”¨å¹¶ä¿®æ”¹å…¶ <code>prev</code> å€¼ï¼›</strong></p>
<blockquote>
<p>  <font color="#f00"><strong>Rustä¸­ï¼Œåªæœ‰äº”ç±»å¯ä»¥åœ¨ Unsafe Rust ä¸­è¿›è¡Œè€Œä¸èƒ½åœ¨ Safe Rust ä¸­è¿›è¡Œçš„æ“ä½œï¼š</strong></font></p>
<ul>
<li><p><strong>è§£å¼•ç”¨è£¸æŒ‡é’ˆ</strong></p>
</li>
<li><p><strong>è°ƒç”¨ä¸å®‰å…¨çš„å‡½æ•°æˆ–æ–¹æ³•</strong></p>
</li>
<li><p><strong>è®¿é—®æˆ–ä¿®æ”¹å¯å˜é™æ€å˜é‡</strong></p>
</li>
<li><p><strong>å®ç°ä¸å®‰å…¨ trait</strong></p>
</li>
<li><p><strong>è®¿é—® <code>union</code> çš„å­—æ®µ</strong></p>
<p>åŒæ—¶ï¼Œ<strong><code>unsafe</code> å¹¶ä¸ä¼šå…³é—­å€Ÿç”¨æ£€æŸ¥å™¨æˆ–ç¦ç”¨ä»»ä½•å…¶ä»– Rust å®‰å…¨æ£€æŸ¥ï¼šå¦‚æœåœ¨ä¸å®‰å…¨ä»£ç ä¸­ä½¿ç”¨å¼•ç”¨ï¼Œå®ƒä»ä¼šè¢«æ£€æŸ¥ï¼›<code>unsafe</code> å…³é”®å­—åªæ˜¯æä¾›äº†é‚£äº”ä¸ªä¸ä¼šè¢«ç¼–è¯‘å™¨æ£€æŸ¥å†…å­˜å®‰å…¨çš„åŠŸèƒ½ï¼Œä½ ä»ç„¶èƒ½åœ¨ä¸å®‰å…¨å—ä¸­è·å¾—æŸç§ç¨‹åº¦çš„å®‰å…¨ï¼›</strong></p>
<p>å†è€…ï¼Œ<strong><code>unsafe</code> ä¸æ„å‘³ç€å—ä¸­çš„ä»£ç å°±ä¸€å®šæ˜¯å±é™©çš„æˆ–è€…å¿…ç„¶å¯¼è‡´å†…å­˜å®‰å…¨é—®é¢˜ï¼šå…¶æ„å›¾åœ¨äºä½œä¸ºç¨‹åºå‘˜ä½ å°†ä¼šç¡®ä¿ <code>unsafe</code> å—ä¸­çš„ä»£ç ä»¥æœ‰æ•ˆçš„æ–¹å¼è®¿é—®å†…å­˜ï¼›</strong></p>
</li>
</ul>
</blockquote>
<p>åœ¨ä¿®æ”¹äº†å½“å‰é“¾è¡¨å¤´èŠ‚ç‚¹çš„ <code>prev</code> åï¼Œæˆ‘ä»¬å°†æ–°çš„èŠ‚ç‚¹è®¾ä¸ºé“¾è¡¨çš„å¤´èŠ‚ç‚¹ï¼Œç„¶åå°†é“¾è¡¨é•¿åº¦åŠ ä¸€ï¼Œä¾¿å®Œæˆäº†ï¼š</p>
<pre><code class="rust">self.head = node;
self.length += 1;</code></pre>
<br>

<p>ç›¸å¯¹åº”çš„ï¼Œæˆ‘ä»¬æœ‰ <code>push_back</code>ï¼š</p>
<pre><code class="rust">pub fn push_back(&amp;mut self, val: T) {
    // Use box to help generate raw ptr
    let mut node = Box::new(Node::new(val));
    node.next = None;
    node.prev = self.tail;
    let node = NonNull::new(Box::into_raw(node));

    match self.tail {
        None =&gt; self.head = node,
        // Not creating new mutable (unique!) references overlapping `element`.
        Some(tail) =&gt; unsafe { (*tail.as_ptr()).next = node },
    }

    self.tail = node;
    self.length += 1;
}</code></pre>
<p>å’Œä¸Šé¢éå¸¸ç±»ä¼¼ï¼Œè¿™é‡Œä¸å¤šèµ˜è¿°äº†ï¼›</p>
<br>

<h3 id="â‘¢-é¦–å°¾å¼¹å‡ºå…ƒç´ ï¼špop"><a href="#â‘¢-é¦–å°¾å¼¹å‡ºå…ƒç´ ï¼špop" class="headerlink" title="â‘¢ é¦–å°¾å¼¹å‡ºå…ƒç´ ï¼špop()"></a><strong>â‘¢ é¦–å°¾å¼¹å‡ºå…ƒç´ ï¼špop()</strong></h3><p><code>pop()</code> å‡½æ•°ä¼šå°†å¤´éƒ¨æˆ–è€…å°¾éƒ¨çš„å…ƒç´ å¼¹å‡ºï¼›</p>
<p>æ‰€è°“å¼¹å‡ºå°±æ˜¯ï¼šå°†å…ƒç´ ä»é“¾è¡¨ä¸­åˆ é™¤ï¼Œå¹¶ä¸”è¿”å›å…·æœ‰æ‰€æœ‰æƒçš„ <code>T</code>ï¼ˆå¦‚æœå­˜åœ¨çš„è¯ï¼‰ï¼›</p>
<p>åŒæ—¶ï¼Œä¸ºäº†ç¡®åˆ‡çš„è¡¨è¾¾æ˜¯å¦å­˜åœ¨å…ƒç´ ï¼Œè¿”å›å€¼æˆ‘ä»¬ä½¿ç”¨ <code>Option&lt;T&gt;</code> ç±»å‹è¡¨ç¤ºï¼›</p>
<p>ä¸‹é¢æ¥å®ç°ä»å¤´éƒ¨å¼¹å‡ºå…ƒç´ çš„æ–¹æ³• <code>pop_front</code>ï¼›</p>
<p>ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="rust">/// Removes the first element and returns it, or `None` if the list is
/// empty.
///
/// This operation should compute in *O*(1) time.
pub fn pop_front(&amp;mut self) -&gt; Option&lt;T&gt; {
    self.head.map(|node| {
        self.length -= 1;

        unsafe {
            let node = Box::from_raw(node.as_ptr());

            self.head = node.next;

            match self.head {
                None =&gt; self.tail = None,
                Some(head) =&gt; (*head.as_ptr()).prev = None,
            }
            node.into_val()
        }
    })
}</code></pre>
<blockquote>
<p>  <strong>æ³¨æ„åˆ°ä¸Šé¢çš„ä»£ç é£æ ¼ï¼Œåªæ˜¯è°ƒç”¨äº† <code>self.head.map()</code> å³å®Œæˆäº†æ‰€æœ‰åŠŸèƒ½ï¼›</strong></p>
<p>  <strong>è¿™ç§å‡½æ•°å¼ç¼–ç¨‹çš„é£æ ¼åœ¨Rustä¸­éå¸¸å¸¸è§ï¼›</strong></p>
</blockquote>
<h4 id="è¡¥å……å†…å®¹ï¼šOption"><a href="#è¡¥å……å†…å®¹ï¼šOption" class="headerlink" title="è¡¥å……å†…å®¹ï¼šOption"></a><strong>è¡¥å……å†…å®¹ï¼šOption</strong></h4><p>åœ¨è§£é‡Šä¸Šé¢çš„ä»£ç ä¹‹å‰ï¼Œè¿™é‡Œéœ€è¦è¡¥å……ä¸€äº›å…³äº <code>Option</code> çš„çŸ¥è¯†ï¼š</p>
<p>åœ¨ Rust ä¸­æ‰€æœ‰çš„å˜é‡ä¸€å®šéƒ½ä¸ä¸º Nullï¼Œå³ä¸ä¼šå‘ç”Ÿç©ºæŒ‡é’ˆï¼›</p>
<p>ä¾‹å¦‚ï¼Œä¸‹é¢çš„ç»“æ„ä½“ï¼š</p>
<pre><code class="rust">struct Foo {
    x: String,
    y: String,
}

let foo = Foo {
    x: &quot;foo&quot;.to_string(),
    y: &quot;bar&quot;.to_string(),
};</code></pre>
<p>å¦‚æœä¸å¯¹ x æˆ– y åˆå§‹åŒ–ï¼Œåˆ™å°†å¯¼è‡´ç¼–è¯‘é”™è¯¯ï¼</p>
<p><strong>è€Œ Null å€¼çš„è¯­ä¹‰å°±æ˜¯é€šè¿‡æšä¸¾ç±»å‹ Option æ¥æ˜¾ç¤ºæ ‡æ³¨çš„ï¼</strong></p>
<p>Option çš„å®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre><code class="rust">#[derive(Copy, PartialEq, PartialOrd, Eq, Ord, Debug, Hash)]
#[rustc_diagnostic_item = &quot;Option&quot;]
#[stable(feature = &quot;rust1&quot;, since = &quot;1.0.0&quot;)]
pub enum Option&lt;T&gt; {
    /// No value.
    #[lang = &quot;None&quot;]
    #[stable(feature = &quot;rust1&quot;, since = &quot;1.0.0&quot;)]
    None,
    /// Some value of type `T`.
    #[lang = &quot;Some&quot;]
    #[stable(feature = &quot;rust1&quot;, since = &quot;1.0.0&quot;)]
    Some(#[stable(feature = &quot;rust1&quot;, since = &quot;1.0.0&quot;)] T),
}</code></pre>
<p>å…¶ä¸­ï¼Œ<code>None</code> å³å¯¹åº”äº†è¯­ä¹‰ä¸Šçš„ <code>Null</code>ï¼Œè€Œ <code>Some(T)</code> è¡¨ç¤ºå­˜åœ¨ä¸€ä¸ªå€¼ï¼›</p>
<blockquote>
<p>  <font color="#f00"><strong>æ³¨æ„åˆ°ï¼Œåœ¨ Option ä¸­ä¹Ÿå­˜åœ¨ç©ºæŒ‡é’ˆä¼˜åŒ–ï¼</strong></font></p>
<p>  <font color="#f00"><strong>å› æ­¤ <code>Option&lt;T&gt;</code> å ç”¨çš„å†…å­˜å¤§å°å’Œ <code>T</code> æ˜¯å®Œå…¨ç›¸åŒçš„ï¼</strong></font></p>
</blockquote>
<blockquote>
<p>  <font color="#f00"><strong>æšä¸¾ Option åœ¨è®¾è®¡ä¸Šçš„æ€è€ƒï¼š</strong></font></p>
<p>  <font color="#f00"><strong>å¦‚æœä½ ç¡®å®šæŸä¸ªå˜é‡ä¸€å®šä¸ä¸ºç©ºï¼Œåˆ™æ— éœ€ä½¿ç”¨ Option æ¥åŒ…è£…ç±»å‹ï¼Œæ­¤æ—¶åœ¨ä½¿ç”¨æ—¶ï¼Œå®Œå…¨ä¸éœ€è¦æ‹…å¿ƒä¼šäº§ç”Ÿç©ºæŒ‡é’ˆç­‰å¼‚å¸¸ï¼›</strong></font></p>
<p>  <font color="#f00"><strong>åªæœ‰åœ¨ä½ ä¸ç¡®å®šæŸä¸ªå˜é‡æ˜¯å¦ä¸€å®šæœ‰å€¼æ—¶ï¼Œæ‰éœ€è¦ä½¿ç”¨ Option è¿›è¡ŒåŒ…è£…ï¼›</strong></font></p>
<p>  åœ¨ä½¿ç”¨ Option æ—¶ï¼š</p>
<p>  <font color="#f00"><strong>ç”±äº <code>Option&lt;T&gt;</code> ç±»å‹å’Œ <code>T</code> ç±»å‹æ˜¯å®Œå…¨ä¸åŒçš„ä¸¤ä¸ªç±»å‹ï¼ŒRust ä¼šè¦æ±‚ä½¿ç”¨è€…æ˜¾å¼çš„å¤„ç†ç©ºæŒ‡é’ˆçš„æƒ…å†µï¼ˆå–å€¼ä¸º<code>None</code>çš„æƒ…å†µï¼‰ï¼Œå› æ­¤æå¤§çš„é¿å…äº†ç©ºæŒ‡é’ˆçš„è¡Œä¸ºï¼</strong></font></p>
<p>  è§ï¼š</p>
<ul>
<li><a href="https://cloud.tencent.com/developer/article/1677524" target="_blank" rel="noopener">åæ‚”å‘æ˜Nullï¼šå ªç§°CSå²ä¸Šæœ€ä¸¥é‡é”™è¯¯ï¼Œè‡³å°‘é€ æˆ10äº¿ç¾é‡‘æŸå¤±</a></li>
</ul>
</blockquote>
<p>ä¾‹å¦‚ï¼Œä¿®æ”¹ä¸Šé¢çš„ä¾‹å­ï¼š</p>
<pre><code class="rust">struct Foo {
    x: Option&lt;String&gt;,
    y: Option&lt;String&gt;,
}

let foo = Foo {
    x: Option::from(&quot;foo&quot;.to_string()),
    y: None,
};</code></pre>
<p>æ­¤æ—¶å°±å¯ä»¥è¡¨ç¤ºä¸€ä¸ªNoneå€¼ï¼›</p>
<br>

<p>ç®€å•ä»‹ç»äº† <code>Option</code> åï¼Œä¸‹é¢æ¥çœ‹ä¸€ä¸‹ <code>self.head.map()</code>ï¼›</p>
<p>åœ¨ Rust ä¸­ï¼Œå¯èƒ½ä¼šå­˜åœ¨å¾ˆå¤š Optionï¼Œå¦‚æœéœ€è¦å°†ä¸€ä¸ª Option è¿›è¡Œå¤„ç†åï¼Œå†è¿”å›å¦ä¸€ä¸ª Option é€šå¸¸éœ€è¦ä¸‰ä¸ªæ­¥éª¤ï¼š</p>
<p><code>åˆ¤æ–­ Option A æ˜¯ Some</code> =&gt; <code>è§£å‡º A</code> =&gt; <code>å¤„ç†Aï¼Œå¾—åˆ°ç»“æœB</code> =&gt; <code>åˆ¤æ–­Bæ˜¯å¦ä¸ºNone</code> =&gt; <code>åŒ…è£…å¹¶è¿”å› Option B</code></p>
<p>æ•´ä¸ªæ­¥éª¤å¼‚å¸¸ç¹æ‚ï¼š</p>
<pre><code class="rust">struct Foo {
    x: Option&lt;String&gt;,
    y: Option&lt;String&gt;,
}

let a = Foo {
    x: Option::from(&quot;foo&quot;.to_string()),
    y: None,
};

let mut b: String = &quot;&quot;.to_string();
if a.x.is_some() {
    b = a.x.unwrap();
}

let res = if b.ends_with(&quot;0&quot;) {
    Some(b)
} else {
    None
};

println!(&quot;{:?}&quot;, res); // None</code></pre>
<p>è€ƒè™‘åˆ°è¿™ç§åœºæ™¯éå¸¸å¸¸è§ï¼Œå› æ­¤ Rust åœ¨ Option ä¸­æä¾›äº† <code>map</code> æ–¹æ³•ï¼š</p>
<pre><code class="rust">pub const fn map&lt;U, F&gt;(self, f: F) -&gt; Option&lt;U&gt;
where
F: ~const FnOnce(T) -&gt; U,
F: ~const Drop,
{
    match self {
        Some(x) =&gt; Some(f(x)),
        None =&gt; None,
    }
}</code></pre>
<p>ç”¨äºå°†ä¸€ä¸ª <code>Option&lt;T&gt;</code> ç±»å‹è½¬æ¢ä¸º <code>Option&lt;U&gt;</code> ç±»å‹ï¼›</p>
<p>å› æ­¤ï¼Œä¸Šé¢çš„ä¾‹å­å¯ä»¥ç›´æ¥è¢«ç®€åŒ–ä¸ºï¼š</p>
<pre><code class="rust">let res = a.x.map(|str| {
    if str.ends_with(&quot;o&quot;) {
        str
    } else {
        None
    }
});</code></pre>
<br>

<p>ç»è¿‡ä¸Šé¢çš„è¡¥å……çŸ¥è¯†å¯ä»¥çŸ¥é“ï¼Œ<code>self.head.map()</code> ä¼šå¤„ç†æ•´ä¸ªå¼¹å‡ºé€»è¾‘ï¼Œå¹¶å°†å¤´èŠ‚ç‚¹è½¬æ¢ä¸ºè¿”å›å€¼å¼¹å‡ºï¼›</p>
<p>å¦‚æœ head ä¸ºç©ºï¼Œ<code>map</code> å‡½æ•°ä¼šç›´æ¥è¿”å› Noneï¼›</p>
<p>ä¸‹é¢å…·ä½“æ¥çœ‹ <code>map</code> å‡½æ•°ä¸­ Lambdaè¡¨è¾¾å¼çš„é€»è¾‘ï¼š</p>
<pre><code class="rust">|node| {
    self.length -= 1;

    unsafe {
        let node = Box::from_raw(node.as_ptr());

        self.head = node.next;

        match self.head {
            None =&gt; self.tail = None,
            Some(head) =&gt; (*head.as_ptr()).prev = None,
        }
        node.into_val()
    }
}</code></pre>
<p>æ­¤æ—¶ï¼Œnode è¡¨ç¤ºå·²ç»ä» Option ä¸­è§£å‡ºæ¥çš„ç±»å‹ï¼Œå³ï¼š<code>NonNull&lt;Node&lt;T&gt;&gt;</code>ï¼Œè£¸æŒ‡é’ˆç±»å‹ï¼›</p>
<p>æ ¹æ®æˆ‘ä»¬ä¹‹å‰è¯´çš„ï¼Œé¦–å…ˆä½¿ç”¨ <code>Box::from_raw</code> å°†è£¸æŒ‡é’ˆè¿˜åŸä¸º <code>Box&lt;Node&lt;T&gt;&gt;</code> ç±»å‹ï¼ˆä¸ºè¿”å›å¤´èŠ‚ç‚¹æ•°æ®åšå‡†å¤‡ï¼‰ï¼›</p>
<p>ç„¶åå°†é“¾è¡¨çš„å¤´èŠ‚ç‚¹æŒ‡å‘å½“å‰èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼›</p>
<p>éšåï¼Œä¿®æ”¹é“¾è¡¨å¤´èŠ‚ç‚¹çš„å†…å®¹ï¼š</p>
<p>åˆ¤æ–­å½“å‰é“¾è¡¨å¤´èŠ‚ç‚¹æ˜¯å¦ä¸º Noneï¼ˆå¼¹å‡ºå…ƒç´ åæ˜¯å¦å˜ä¸ºç©ºé“¾è¡¨ï¼‰ï¼š</p>
<ul>
<li>å¦‚æœé“¾è¡¨ä¸ºç©ºï¼Œåˆ™å°†å°¾èŠ‚ç‚¹ä¹Ÿç½®ä¸º <code>None</code>ï¼›</li>
<li>å¦åˆ™é“¾è¡¨ä¸ä¸ºç©ºï¼Œå°†å½“å‰é“¾è¡¨å¤´èŠ‚ç‚¹çš„ <code>prev</code> ç½®ä¸º <code>None</code>ï¼ˆè¡¨ç¤ºå½“å‰ èŠ‚ç‚¹å·²ç»å˜ä¸ºé“¾è¡¨çš„å¤´èŠ‚ç‚¹ï¼‰ï¼›</li>
</ul>
<p>æœ€åï¼Œä½¿ç”¨å‰æ–‡æåˆ°çš„ <code>into_val</code> å‡½æ•°ï¼Œå°† <code>Box&lt;Node&lt;T&gt;&gt;</code> ä¸­çš„å€¼å–å‡ºï¼Œå®Œæˆï¼›</p>
<br>

<p>åŒæ ·çš„ï¼Œå°¾éƒ¨å¼¹å‡ºä¸€ä¸ªå…ƒç´ ï¼š</p>
<pre><code class="rust">/// Removes the last element from a list and returns it, or `None` if
/// it is empty.
///
/// This operation should compute in *O*(1) time.
pub fn pop_back(&amp;mut self) -&gt; Option&lt;T&gt; {
  self.tail.map(|node| {
    self.length -= 1;

    unsafe {
      let node = Box::from_raw(node.as_ptr());

      self.tail = node.prev;

      match self.tail {
        None =&gt; self.head = None,
        Some(tail) =&gt; (*tail.as_ptr()).next = None,
      }
      node.into_val()
    }
  })
}</code></pre>
<br>

<h3 id="â‘£-æŸ¥çœ‹é¦–å°¾å…ƒç´ ï¼špeek"><a href="#â‘£-æŸ¥çœ‹é¦–å°¾å…ƒç´ ï¼špeek" class="headerlink" title="â‘£ æŸ¥çœ‹é¦–å°¾å…ƒç´ ï¼špeek()"></a><strong>â‘£ æŸ¥çœ‹é¦–å°¾å…ƒç´ ï¼špeek()</strong></h3><p>ç”±äºåœ¨ Rust ä¸­æ˜¯åŒºåˆ†å…ƒç´ æ‰€æœ‰æƒï¼Œå¹¶ä¸”åŒºåˆ†å¯å˜å’Œä¸å¯å˜å¼•ç”¨çš„ï¼ˆæœªæ ‡æ³¨ <code>mut</code> é»˜è®¤ä¸ºä¸å¯å˜å¼•ç”¨ï¼‰ï¼›</p>
<p>å› æ­¤åœ¨ Rust ä¸­å®ç° <code>peek()</code> å’Œåœ¨å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­ç•¥æœ‰ä¸åŒï¼</p>
<p>æˆ‘ä»¬éœ€è¦åˆ†åˆ«å®ç°ï¼š</p>
<ul>
<li><code>peek()</code>ï¼šè¿”å›ä¸å¯å˜å¼•ç”¨ç±»å‹ï¼›</li>
<li><code>peek_mut()</code>ï¼šè¿”å›å¯å˜å¼•ç”¨ç±»å‹ï¼›</li>
</ul>
<blockquote>
<p>  <font color="#f00"><strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šä¸Šé¢ä¸¤ä¸ªæ–¹æ³•ä»…ä»…è¿”å›å…ƒç´ çš„å¼•ç”¨ï¼Œè€Œå…ƒç´ çš„æ‰€æœ‰æƒè¿˜æ˜¯åœ¨é“¾è¡¨ä¸­ï¼›</strong></font></p>
</blockquote>
<h4 id="å®ç°-peek-front"><a href="#å®ç°-peek-front" class="headerlink" title="å®ç° peek_front()"></a><strong>å®ç° <code>peek_front()</code></strong></h4><p>å…ˆæ¥å®ç° <code>peek_front()</code>ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="rust">pub fn peek_front(&amp;self) -&gt; Option&lt;&amp;T&gt; {
    unsafe {
      self.head.as_ref().map(|node| &amp;node.as_ref().val)
    }
}</code></pre>
<p>ä»£ç éå¸¸ç®€æ´ï¼Œåªæœ‰ä¸€è¡Œï¼›æˆ‘ä»¬ä¸€ä¸ªæ–¹æ³•ä¸€ä¸ªæ–¹æ³•çš„æ¥çœ‹ï¼›</p>
<p>é¦–å…ˆï¼Œå’Œä¹‹å‰ç±»ä¼¼ï¼ŒOption æä¾›äº† <code>as_ref</code> æ–¹æ³•ï¼Œå¯ä»¥å°† <code>Option&lt;T&gt;</code> è½¬ä¸º <code>Option&lt;&amp;T&gt;</code> è€Œä¸ç”¨é¢‘ç¹çš„æ‹†åŒ…å†åŒ…è£…ï¼›</p>
<p>ä¹‹åå†æ¬¡è°ƒç”¨ <code>map</code> æ–¹æ³•ï¼ˆ<strong>æ³¨æ„ï¼Œæ­¤æ—¶ node çš„ç±»å‹ä¸º <code>&amp;NonNull&lt;Node&lt;T&gt;&gt;</code>ï¼Œå³è£¸æŒ‡é’ˆçš„å¼•ç”¨ç±»å‹</strong>ï¼‰ï¼Œ<strong>å°†å½“å‰ Option ä¸­çš„ è£¸æŒ‡é’ˆå¼•ç”¨è½¬ä¸º <code>Option&lt;&amp;T&gt;</code> ï¼Œå³NodeèŠ‚ç‚¹çš„å¼•ç”¨ï¼›</strong></p>
<p>åœ¨ä¸Šé¢çš„ <code>&amp;node.as_ref().val</code> ä¸­ï¼š</p>
<p>é¦–å…ˆ <code>node.as_ref()</code> åšçš„äº‹æƒ…æ˜¯ï¼š</p>
<pre><code class="rust">#[stable(feature = &quot;nonnull&quot;, since = &quot;1.25.0&quot;)]
#[rustc_const_unstable(feature = &quot;const_ptr_as_ref&quot;, issue = &quot;91822&quot;)]
#[must_use]
#[inline]
pub const unsafe fn as_ref&lt;&#39;a&gt;(&amp;self) -&gt; &amp;&#39;a T {
  // SAFETY: the caller must guarantee that `self` meets all the
  // requirements for a reference.
  unsafe { &amp;*self.as_ptr() }
}</code></pre>
<p>å³ï¼Œ<code>as_ref</code> ä¼šå°†è£¸æŒ‡é’ˆè§£å¼•ç”¨ï¼Œå¹¶å°†å®é™…çš„NodeèŠ‚ç‚¹å…ƒç´ çš„å¼•ç”¨è¿”å›ï¼Œå³ï¼š<code>&amp;Node&lt;T&gt;</code>;</p>
<blockquote>
<p>  <strong>è¿™é‡Œç›´æ¥æ”¯æŒè¿™ä¸ªæ“ä½œçš„åŸå› æ˜¯å› ä¸ºï¼š</strong></p>
<p>  <font color="#f00"><strong>æˆ‘ä»¬ä½¿ç”¨äº† <code>NonNull</code> ç±»å‹ï¼Œä¿è¯äº†æŒ‡é’ˆä¸€å®šä¸ä¸ºç©ºï¼Œå³ï¼šè£¸æŒ‡é’ˆä¸€å®šä¸ä¸ºç©ºæŒ‡é’ˆï¼</strong></font></p>
</blockquote>
<p>éšåï¼Œæˆ‘ä»¬å–å‡º <code>node.as_ref().val</code> å³ï¼š<strong>è£¸æŒ‡é’ˆå¯¹åº”NodeèŠ‚ç‚¹çš„ val å­—æ®µï¼Œæˆ‘ä»¬çœŸæ­£è¿”å›çš„å…ƒç´ ï¼</strong></p>
<p><strong>æœ€å <code>&amp;node.as_ref().val</code> è¡¨ç¤ºå– node èŠ‚ç‚¹ val å…ƒç´ çš„å¼•ç”¨ï¼</strong></p>
<blockquote>
<p>  <strong>æ€»ç»“ï¼š</strong></p>
<p>  <strong><code>&amp;node.as_ref().val</code> çš„é¡ºåºä¸ºï¼š</strong></p>
<pre><code class="rust">  &amp;((node.as_ref()).val)</code></pre>
<p>  <strong>ä¸Šé¢çš„å‡½æ•°å’Œå–å¼•ç”¨æ“ä½œç¼ºä¸€ä¸å¯ï¼</strong></p>
</blockquote>
<br>

<h4 id="å®ç°-peek-back"><a href="#å®ç°-peek-back" class="headerlink" title="å®ç° peek_back()"></a><strong>å®ç° <code>peek_back()</code></strong></h4><p>å¯¹åº”çš„ï¼Œ<code>peek_back()</code>ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="rust">pub fn peek_back(&amp;self) -&gt; Option&lt;&amp;T&gt; {
  unsafe { self.tail.as_ref().map(|node| &amp;node.as_ref().val) }
}</code></pre>
<p>è¿™é‡Œä¸å†èµ˜è¿°ï¼</p>
<br>

<h4 id="å®ç°-peek-front-mut"><a href="#å®ç°-peek-front-mut" class="headerlink" title="å®ç° peek_front_mut()"></a><strong>å®ç° <code>peek_front_mut()</code></strong></h4><p>é™¤äº†è¿”å›å¼•ç”¨ç±»å‹çš„å…ƒç´ ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜è¦èƒ½è¿”å›å¯å˜å¼•ç”¨ç±»å‹ï¼š<code>Option&lt;&amp;mut T&gt;</code>ï¼š</p>
<p>ä½¿å¾—ç”¨æˆ·èƒ½å¤Ÿå¯¹é“¾è¡¨ä¸­çš„èŠ‚ç‚¹å…ƒç´ å€¼è¿›è¡Œä¿®æ”¹ï¼Œä½†æ˜¯ä¸çœŸæ­£è·å–å…ƒç´ çš„æ‰€æœ‰æƒï¼</p>
<p>å®ç° <code>peek_front()</code> çš„ä»£ç åŒæ ·éå¸¸ç®€æ´ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="rust">pub fn peek_front_mut(&amp;mut self) -&gt; Option&lt;&amp;mut T&gt; {
  unsafe { self.head.as_mut().map(|node| &amp;mut node.as_mut().val) }
}</code></pre>
<p>ç›¸æ¯”äºä»…è¿”å›å¼•ç”¨ç±»å‹ï¼ˆåªè¯»ï¼‰çš„æƒ…å†µï¼Œè¿™é‡Œçš„ä¿®æ”¹ä¸»è¦æ˜¯ï¼š</p>
<ul>
<li><code>as_ref</code> æ”¹ä¸ºäº† <code>as_mut</code>ï¼›</li>
<li><code>&amp;node</code> æ”¹ä¸ºäº† <code>&amp;mut node</code>ï¼›</li>
</ul>
<p>æ€è€ƒä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆè¿™é‡Œéœ€è¦å°†è¿™ä¹ˆå¤šçš„å¼•ç”¨æ”¹ä¸ºå¯å˜å¼•ç”¨å‘¢ï¼Ÿ</p>
<p>é¦–å…ˆï¼Œä½ éœ€è¦æ˜ç¡®ä¸€ç‚¹ï¼š</p>
<p><font color="#f00"><strong>åœ¨ Rust ä¸­ï¼Œå¦‚æœä¿®æ”¹ä¸€ä¸ªå®¹å™¨ä¸­çš„å…ƒç´ ï¼Œé¦–å…ˆè¿™ä¸ªå®¹å™¨éœ€è¦æ˜¯å¯å˜çš„ï¼</strong></font></p>
<p>é‚£ä¹ˆï¼Œ<code>head.as_mut()</code> å°±è·å–äº†ä¸€ä¸ªå¯å˜çš„è£¸æŒ‡é’ˆï¼ˆ<strong>å³ï¼Œè¿™ä¸ªè£¸æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜æ˜¯å¯å˜çš„ï¼Œè€Œä¸æ˜¯è¿™ä¸ªæŒ‡é’ˆå¯å˜ï¼</strong>ï¼‰ï¼›</p>
<p>è¿›è€Œï¼Œæ­¤æ—¶ node çš„ç±»å‹ä¸º <code>&amp;mut NonNull&lt;Node&lt;T&gt;&gt;</code>ï¼›</p>
<p>éšåï¼Œè°ƒç”¨ node çš„ <code>as_mut</code> æ–¹æ³•ï¼š</p>
<pre><code class="rust">#[stable(feature = &quot;nonnull&quot;, since = &quot;1.25.0&quot;)]
#[rustc_const_unstable(feature = &quot;const_ptr_as_ref&quot;, issue = &quot;91822&quot;)]
#[must_use]
#[inline]
pub const unsafe fn as_mut&lt;&#39;a&gt;(&amp;mut self) -&gt; &amp;&#39;a mut T {
  // SAFETY: the caller must guarantee that `self` meets all the
  // requirements for a mutable reference.
  unsafe { &amp;mut *self.as_ptr() }
}</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œè°ƒç”¨è£¸æŒ‡é’ˆçš„ <code>as_mut</code> æ–¹æ³•éœ€è¦ä¸€ä¸ªå¯å˜æŒ‡é’ˆ <code>&amp;mut self</code>ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¸Šé¢ä½¿ç”¨äº†<code>head.as_mut()</code>ï¼›</p>
<p>éšå  <code>node.as_mut</code> æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªè£¸æŒ‡é’ˆè§£å¼•ç”¨åçš„ Node çš„å¯å˜å¼•ç”¨ï¼š<code>&amp;mut Node&lt;T&gt;</code>ï¼›</p>
<p>æœ€åï¼Œ<code>&amp;mut node.as_mut().val</code> ç”Ÿæˆäº† <code>&amp;mut T</code>ï¼Œå³NodeèŠ‚ç‚¹å¯¹åº”çš„å¯å˜å¼•ç”¨ï¼</p>
<br>

<h4 id="å®ç°-peek-back-mut"><a href="#å®ç°-peek-back-mut" class="headerlink" title="å®ç° peek_back_mut()"></a><strong>å®ç° <code>peek_back_mut()</code></strong></h4><p>å¯¹åº”çš„ï¼Œ<code>peek_back_()</code>ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="rust">pub fn peek_back_mut(&amp;mut self) -&gt; Option&lt;&amp;mut T&gt; {
  unsafe { self.tail.as_mut().map(|node| &amp;mut node.as_mut().val) }
}</code></pre>
<p>è¿™é‡Œä¸å†èµ˜è¿°ï¼</p>
<br>

<h3 id="â‘¤-æ ¹æ®indexæŸ¥çœ‹å…ƒç´ ï¼šget-by-idx"><a href="#â‘¤-æ ¹æ®indexæŸ¥çœ‹å…ƒç´ ï¼šget-by-idx" class="headerlink" title="â‘¤ æ ¹æ®indexæŸ¥çœ‹å…ƒç´ ï¼šget_by_idx()"></a><strong>â‘¤ æ ¹æ®indexæŸ¥çœ‹å…ƒç´ ï¼š<code>get_by_idx()</code></strong></h3><p>æœ‰äº†æŸ¥çœ‹é¦–å°¾å…ƒç´ ï¼Œæˆ‘ä»¬è‡ªç„¶è¿˜éœ€è¦æ ¹æ® index ç´¢å¼•æŸ¥çœ‹ä»»æ„ä½ç½®çš„å…ƒç´ ï¼›</p>
<p>ä½†æ˜¯è¿™é‡Œéœ€è¦æ˜ç¡®ä¸€ç‚¹ï¼š</p>
<p><strong>apiè°ƒç”¨æ–¹å¾ˆæœ‰å¯èƒ½ä¼ å…¥äº†ä¸€ä¸ªéæ³•çš„indexå€¼ï¼Œå¦‚ï¼š-1ã€è¶…è¿‡é“¾è¡¨é•¿åº¦çš„å€¼ç­‰ï¼›</strong></p>
<p>è¿™ä¸ªæ—¶å€™æœ‰ä¸¤ç§å¤„ç†æ–¹æ³•ï¼š</p>
<ul>
<li>è¿”å› Noneï¼›</li>
<li>è¿”å›é”™è¯¯ï¼›</li>
</ul>
<p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬é€‰æ‹©è¿”å›é”™è¯¯ï¼š</p>
<p><strong>å› ä¸ºï¼Œå¦‚æœä»…ä»…è¿”å› Noneï¼Œapiè°ƒç”¨æ–¹ä¸èƒ½ç¡®å®šæ˜¯å› ä¸º index ä¼ é”™è€Œå¯¼è‡´çš„ Noneï¼Œè¿˜æ˜¯é“¾è¡¨æœ¬èº«å°±æ˜¯ç©ºçš„ï¼</strong></p>
<p>ä¸‹é¢æˆ‘ä»¬è¡¥å……ä¸€äº›å…³äº Rust ä¸­é”™è¯¯å¤„ç†çš„çŸ¥è¯†ï¼ˆ<strong>å·²ç»å¯¹è¿™ä¸ªå†…å®¹å¾ˆç†Ÿæ‚‰çš„åŒå­¦å¯ä»¥è·³è¿‡è¿™éƒ¨åˆ†</strong>ï¼‰ï¼</p>
<h4 id="è¡¥å……ï¼šRustä¸­çš„é”™è¯¯å¤„ç†"><a href="#è¡¥å……ï¼šRustä¸­çš„é”™è¯¯å¤„ç†" class="headerlink" title="è¡¥å……ï¼šRustä¸­çš„é”™è¯¯å¤„ç†"></a><strong>è¡¥å……ï¼šRustä¸­çš„é”™è¯¯å¤„ç†</strong></h4><p>ç›®å‰ï¼Œä¸»æµçš„é”™è¯¯å¤„ç†æ–¹æ³•ä¸»è¦åŒ…æ‹¬ï¼š</p>
<ul>
<li>try-catchï¼šJavaã€C++ï¼›</li>
<li>panic-recoverï¼šGoï¼›</li>
<li>error handlingï¼šGoï¼›</li>
<li>â€¦â€¦ï¼›</li>
</ul>
<blockquote>
<p>  è¯¦è§ï¼š</p>
<ul>
<li><a href="https://zh.wikipedia.org/wiki/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86" target="_blank" rel="noopener">å¼‚å¸¸å¤„ç†</a></li>
</ul>
</blockquote>
<p>æ€»çš„æ¥è¯´ï¼Œåœ¨ Rust ä¸­ä¸»è¦æœ‰ä¸¤ç§é”™è¯¯å¤„ç†æ–¹å¼ï¼ˆå’Œ Golang æ¯”è¾ƒç±»ä¼¼ï¼‰ï¼š</p>
<ul>
<li><strong>æ˜¾å¼çš„ <code>panic</code>ï¼šä¸»è¦ç”¨äºæµ‹è¯•ï¼Œä»¥åŠå¤„ç†ä¸å¯æ¢å¤çš„é”™è¯¯ï¼›ï¼ˆåœ¨åŸå‹å¼€å‘ä¸­è¿™å¾ˆæœ‰ç”¨ï¼Œæ¯”å¦‚ ç”¨æ¥æµ‹è¯•è¿˜æ²¡æœ‰å®ç°çš„å‡½æ•°ï¼Œä¸è¿‡è¿™æ—¶ä½¿ç”¨ <code>unimplemented</code> æ›´èƒ½è¡¨è¾¾æ„å›¾ï¼›ï¼‰</strong></li>
<li><strong>ä½¿ç”¨æšä¸¾ <code>Result</code>ï¼šå½“é”™è¯¯æœ‰å¯èƒ½å‘ç”Ÿï¼Œä¸”åº”å½“ç”±è°ƒç”¨è€…å¤„ç†æ—¶ä½¿ç”¨ï¼›</strong></li>
</ul>
<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½ä½¿ç”¨æšä¸¾ Resultï¼š</p>
<pre><code class="rust">#[derive(Copy, PartialEq, PartialOrd, Eq, Ord, Debug, Hash)]
#[must_use = &quot;this `Result` may be an `Err` variant, which should be handled&quot;]
#[rustc_diagnostic_item = &quot;Result&quot;]
#[stable(feature = &quot;rust1&quot;, since = &quot;1.0.0&quot;)]
pub enum Result&lt;T, E&gt; {
    /// Contains the success value
    #[lang = &quot;Ok&quot;]
    #[stable(feature = &quot;rust1&quot;, since = &quot;1.0.0&quot;)]
    Ok(#[stable(feature = &quot;rust1&quot;, since = &quot;1.0.0&quot;)] T),

    /// Contains the error value
    #[lang = &quot;Err&quot;]
    #[stable(feature = &quot;rust1&quot;, since = &quot;1.0.0&quot;)]
    Err(#[stable(feature = &quot;rust1&quot;, since = &quot;1.0.0&quot;)] E),
}</code></pre>
<p>å¯ä»¥è¯´ï¼Œ<a href="https://rustwiki.org/zh-CN/std/result/enum.Result.html" target="_blank" rel="noopener"><code>Result</code></a> æ˜¯ <a href="https://rustwiki.org/zh-CN/std/option/enum.Option.html" target="_blank" rel="noopener"><code>Option</code></a> ç±»å‹çš„æ›´ä¸°å¯Œçš„ç‰ˆæœ¬ï¼Œæè¿°çš„æ˜¯å¯èƒ½çš„<strong>é”™è¯¯</strong>ï¼Œè€Œä¸æ˜¯å¯èƒ½çš„<strong>ä¸å­˜åœ¨</strong>ï¼›</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>Result&lt;Tï¼ŒE&gt;</code> å¯ä»¥æœ‰ä¸¤ä¸ªç»“æœçš„å…¶ä¸­ä¸€ä¸ªï¼š</p>
<ul>
<li><code>Ok&lt;T&gt;</code>ï¼šæ‰¾åˆ° <code>T</code> å…ƒç´ ï¼›</li>
<li><code>Err&lt;E&gt;</code>ï¼šæ‰¾åˆ° <code>E</code> å…ƒç´ ï¼Œ<code>E</code> å³è¡¨ç¤ºé”™è¯¯çš„ç±»å‹ï¼›</li>
</ul>
<br>

<h4 id="è¡¥å……ï¼šRustä¸­è‡ªå®šä¹‰é”™è¯¯ç±»å‹"><a href="#è¡¥å……ï¼šRustä¸­è‡ªå®šä¹‰é”™è¯¯ç±»å‹" class="headerlink" title="è¡¥å……ï¼šRustä¸­è‡ªå®šä¹‰é”™è¯¯ç±»å‹"></a><strong>è¡¥å……ï¼šRustä¸­è‡ªå®šä¹‰é”™è¯¯ç±»å‹</strong></h4><p>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦è‡ªå®šä¹‰ä¸€äº›é”™è¯¯ç±»å‹ï¼Œå¦‚ï¼š<code>indexä¸åˆæ³•</code>ï¼›</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸ºæˆ‘ä»¬çš„ç±»å‹å®ç° <code>error::Error</code> Traitï¼š</p>
<pre><code class="rust">use std::{error, fmt};

#[derive(Debug, Clone)]
pub struct IndexOutOfRangeError;

impl fmt::Display for IndexOutOfRangeError {
    fn fmt(&amp;self, f: &amp;mut fmt::Formatter) -&gt; fmt::Result {
        write!(f, &quot;index out of range&quot;)
    }
}

impl error::Error for IndexOutOfRangeError {}</code></pre>
<p>ä¸Šé¢çš„ä»£ç å®šä¹‰äº†ä¸€ä¸ª <code>IndexOutOfRangeError</code> ç±»å‹ï¼Œå¹¶å®ç°äº† <code>error::Error</code> Traitï¼›</p>
<blockquote>
<p>  <strong><code>error::Error</code> ä¸­æœ‰è®¸å¤šæ–¹æ³•å¯ä»¥é‡å†™ä»¥æä¾›æ›´å¤šå…³äºé”™è¯¯çš„ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š</strong></p>
<ul>
<li>backtraceï¼›</li>
<li>descriptionï¼›</li>
<li>â€¦â€¦</li>
</ul>
</blockquote>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨æˆ‘ä»¬çš„ä»£ç ä¸­ä½¿ç”¨è¿™ä¸ªé”™è¯¯äº†ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="rust">pub fn get_by_idx(&amp;self, idx: usize) -&gt; Result&lt;Option&lt;&amp;T&gt;, Box&lt;dyn Error&gt;&gt; {
  ......
}</code></pre>
<blockquote>
<p>  æ›´å¤šå…³äº Rust ä¸­é”™è¯¯å¤„ç†è§ï¼š</p>
<ul>
<li><a href="https://rustwiki.org/zh-CN/rust-by-example/error.html" target="_blank" rel="noopener">é”™è¯¯å¤„ç†</a></li>
<li><a href="https://rustwiki.org/zh-CN/book/ch09-00-error-handling.html" target="_blank" rel="noopener">Rust å®˜æ–¹æ–‡æ¡£</a></li>
</ul>
</blockquote>
<br>

<h4 id="å®ç°ï¼šget-by-idxæ–¹æ³•"><a href="#å®ç°ï¼šget-by-idxæ–¹æ³•" class="headerlink" title="å®ç°ï¼šget_by_idxæ–¹æ³•"></a><strong>å®ç°ï¼šget_by_idxæ–¹æ³•</strong></h4><p>get_by_idxæ–¹æ³•çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="rust">pub fn get_by_idx(&amp;self, idx: usize) -&gt; Result&lt;Option&lt;&amp;T&gt;, Box&lt;dyn Error&gt;&gt; {
  let len = self.length;

  if idx &gt;= len {
    return Err(Box::new(IndexOutOfRangeError {}));
  }

  // Iterate towards the node at the given index, either from the start or the end,
  // depending on which would be faster.
  let offset_from_end = len - idx - 1;
  let mut cur;
  if idx &lt;= offset_from_end {
    // Head to Tail
    cur = self.head;
    for _ in 0..idx {
      match cur.take() {
        None =&gt; {
          cur = self.head;
        }
        Some(current) =&gt; unsafe {
          cur = current.as_ref().next;
        },
      }
    }
  } else {
    // Tail to Head
    cur = self.tail;
    for _ in 0..offset_from_end {
      match cur.take() {
        None =&gt; {
          cur = self.tail;
        }
        Some(current) =&gt; unsafe {
          cur = current.as_ref().prev;
        },
      }
    }
  }

  unsafe { Ok(cur.as_ref().map(|node| &amp;node.as_ref().val)) }
}</code></pre>
<p>ä¸‹é¢æ¥çœ‹ä¸€ä¸‹ä»£ç ï¼›</p>
<p>é¦–å…ˆï¼Œåˆ¤æ–­ç”¨æˆ·ä¼ å…¥çš„ç´¢å¼•indexæ˜¯å¦å¤§äºäº†é“¾è¡¨é•¿åº¦ï¼š <code>idx &gt;= len</code>ï¼›</p>
<blockquote>
<p>  <strong>æ³¨æ„ï¼šè¿™é‡Œå¹¶æ²¡æœ‰æ ¡éªŒç´¢å¼•å°äº0ï¼Œå› ä¸º <code>idx</code> æ˜¯ <code>usize</code> ç±»å‹çš„ï¼Œä¸€å®šä¸ä¼šå°äº0äº†ï¼</strong></p>
</blockquote>
<p>éšåï¼Œæˆ‘ä»¬è®¡ç®— <code>offset_from_end</code>ï¼Œæ¥åˆ¤æ–­æ˜¯ä»é“¾è¡¨å¤´éƒ¨åˆ° index è¿‘ï¼Œè¿˜æ˜¯å°¾éƒ¨è¿‘ï¼ˆ<strong>å……åˆ†åˆ©ç”¨æˆ‘ä»¬åŒå‘é“¾è¡¨çš„ä¼˜åŠ¿</strong>ï¼‰ï¼</p>
<h5 id="ä»å¤´éƒ¨å¯»æ‰¾å…ƒç´ "><a href="#ä»å¤´éƒ¨å¯»æ‰¾å…ƒç´ " class="headerlink" title="ä»å¤´éƒ¨å¯»æ‰¾å…ƒç´ "></a><strong>ä»å¤´éƒ¨å¯»æ‰¾å…ƒç´ </strong></h5><p>å¦‚æœ <code>idx &lt;= offset_from_end</code>ï¼Œè¯´æ˜ä»å¤´éƒ¨åˆ° index çš„è·ç¦»æ›´è¿‘ï¼š</p>
<pre><code class="rust">// Head to Tail
cur = self.head;
for _ in 0..idx {
  match cur.take() {
    None =&gt; {
      cur = self.head;
    }
    Some(current) =&gt; unsafe {
      cur = current.as_ref().next;
    },
  }
}</code></pre>
<p>é¦–å…ˆï¼Œä»£ç å°†é“¾è¡¨å¤´éƒ¨ <code>ç§»åŠ¨</code> ç»™äº† <code>cur</code>ï¼›</p>
<br>

<h6 id="è¡¥å……å†…å®¹ï¼šCopy-Trait"><a href="#è¡¥å……å†…å®¹ï¼šCopy-Trait" class="headerlink" title="è¡¥å……å†…å®¹ï¼šCopy Trait"></a><strong>è¡¥å……å†…å®¹ï¼šCopy Trait</strong></h6><p>çœ‹åˆ°è¿™é‡Œï¼Œæœ‰äººå°±ä¼šæœ‰ç–‘é—®äº†ï¼š<strong>Rust ä¸­çš„ <code>=</code> æ˜¯ <code>move</code> è¯­ä¹‰ï¼Œè¿™æ ·åšåŸé“¾è¡¨ä¸­çš„ head ä¸å°±å˜æˆç©ºå€¼äº†ï¼</strong></p>
<p>çš„ç¡®ï¼ŒRustä¸­çš„ <code>=</code> æ˜¯ <code>move</code> è¯­ä¹‰ï¼Œä½†æ˜¯<font color="#f00"><strong>åœ¨Rustä¸­å­˜åœ¨å¦ä¸¤ä¸ª Traitï¼š<code>Clone &amp; Copy</code>ï¼š</strong></font></p>
<pre><code class="rust">/// A common Trait for the ability to explicitly duplicate an object.
#[stable(feature = &quot;rust1&quot;, since = &quot;1.0.0&quot;)]
#[lang = &quot;clone&quot;]
#[rustc_diagnostic_item = &quot;Clone&quot;]
#[rustc_trivial_field_reads]
pub trait Clone: Sized {
    #[stable(feature = &quot;rust1&quot;, since = &quot;1.0.0&quot;)]
    #[must_use = &quot;cloning is often expensive and is not expected to have side effects&quot;]
    fn clone(&amp;self) -&gt; Self;

    #[inline]
    #[stable(feature = &quot;rust1&quot;, since = &quot;1.0.0&quot;)]
    fn clone_from(&amp;mut self, source: &amp;Self) {
        *self = source.clone()
    }
}


/// Types whose values can be duplicated simply by copying bits.
#[stable(feature = &quot;rust1&quot;, since = &quot;1.0.0&quot;)]
#[lang = &quot;copy&quot;]
#[rustc_unsafe_specialization_marker]
#[rustc_diagnostic_item = &quot;Copy&quot;]
pub trait Copy: Clone {
    // Empty.
}</code></pre>
<p>Clone å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯ç”±ä¸€ä¸ªç±»å‹çš„å®ä¾‹åˆ›å»ºå‡ºå¦ä¸€ä¸ªç›¸åŒç±»å‹çš„å®ä¾‹ï¼›</p>
<p>è€Œå®ç°Copyçš„ç±»å‹ï¼ˆ<strong>å®ç°Copyéœ€è¦å…ˆå®ç°Clone</strong>ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ç®€å•å­—èŠ‚copyçš„æ–¹å¼å¤åˆ¶ï¼›</p>
<p><font color="#f00"><strong>ä¸Cloneä¸åŒï¼ŒCopyæ–¹å¼æ˜¯éšå¼ä½œç”¨äºç±»å‹å˜é‡ï¼Œé€šè¿‡èµ‹å€¼è¯­å¥æ¥å®Œæˆï¼›</strong></font></p>
<blockquote>
<p>  <strong>è¿™ä¸€ç‚¹æœ‰äº›ç±»ä¼¼äº Java ä¸­çš„åŸºæœ¬ç±»å‹ï¼ˆå¦‚ï¼Œintã€doubleï¼‰ï¼›</strong></p>
<p>  <font color="#f00"><strong>å¹¶éæ‰€æœ‰çš„å¯¹è±¡éƒ½éœ€è¦ä½¿ç”¨å¯¹è±¡åŒ…è£…ï¼Œæœ‰äº›æ—¶å€™ï¼šç›´æ¥å¯¹ç±»å‹è¿›è¡Œå­—èŠ‚copyçš„æˆæœ¬è¦æ¯”ç”Ÿæˆä¸€ä¸ªæŒ‡å‘å¯¹è±¡çš„å¼•ç”¨æŒ‡é’ˆè¿˜è¦ä½ï¼</strong></font></p>
</blockquote>
<p>ä»¥ä¸‹é¢çš„ä»£ç ä¸ºä¾‹ï¼š</p>
<pre><code class="rust">let mut x = Some(1);
let y = x;
let z = x.take();
println!(&quot;{:?} {:?} {:?}&quot;, x, y, z); // None Some(1) Some(1)</code></pre>
<p>ä¸Šé¢çš„ <code>y = x</code> ä¸º Copy è¯­ä¹‰ï¼Œå› æ­¤æœ€ç»ˆã€yã€z éƒ½æ˜¯å­˜åœ¨å€¼çš„ï¼</p>
<blockquote>
<p>  <font color="#f00"><strong>æ³¨ï¼šåœ¨ Rust ä¸­é»˜è®¤æ˜¯ Move è¯­ä¹‰ï¼Œä½†æ˜¯å¦‚æœå®ç°äº† Copy Traitå°±ä¼šå˜ä¸º Copy è¯­ä¹‰ï¼›</strong></font></p>
<p>  <font color="#f00"><strong>å› æ­¤ï¼Œæ˜ç¡®ä¸€ä¸ªå˜é‡æ˜¯å¦å®ç°äº† Copy Trait æ˜¯éå¸¸é‡è¦çš„</strong></font></p>
</blockquote>
<p> <code>NonNull</code> ä¾¿å®ç°äº†Clone å’Œ Copy Traitï¼š</p>
<pre><code class="rust">#[stable(feature = &quot;nonnull&quot;, since = &quot;1.25.0&quot;)]
impl&lt;T: ?Sized&gt; Clone for NonNull&lt;T&gt; {
    #[inline]
    fn clone(&amp;self) -&gt; Self {
        *self
    }
}

#[stable(feature = &quot;nonnull&quot;, since = &quot;1.25.0&quot;)]
impl&lt;T: ?Sized&gt; Copy for NonNull&lt;T&gt; {}</code></pre>
<p>å› æ­¤ä¸Šé¢çš„ <code>cur = self.head;</code> æœ€ç»ˆä¼šå°†å˜é‡ <code>cur</code> ä¹Ÿèµ‹å€¼ä¸ºæŒ‡å‘é“¾è¡¨å¤´éƒ¨çš„è£¸æŒ‡é’ˆï¼›</p>
<blockquote>
<p>  <strong>è¡¥å……å†…å®¹ï¼šOption ä¸­çš„ take æ–¹æ³•ï¼š</strong></p>
<p>  <strong>å°† <code>Option&lt;T&gt;</code> ä¸­çš„å€¼ <code>T</code> å–å‡ºï¼Œå¦‚æœ Option ä¸º Noneï¼Œåˆ™è¿”å› Noneï¼›</strong> </p>
</blockquote>
<br>

<p>éšåï¼Œä»å¤´éƒ¨å¼€å§‹éå†ï¼Œç›´åˆ°ç¬¬ idx ä¸ªèŠ‚ç‚¹ï¼š</p>
<pre><code class="rust">for _ in 0..idx {
  match cur.take() {
    None =&gt; {
      cur = self.head;
    }
    Some(current) =&gt; unsafe {
      cur = current.as_ref().next;
    },
  }
}</code></pre>
<p>è¿™æ®µä»£ç æ¯”è¾ƒç®€å•ï¼Œæ‰§è¡Œå®Œåï¼Œcur å°±æŒ‡å‘äº†é“¾è¡¨ä¸­çš„ç¬¬ idx ä¸ªèŠ‚ç‚¹ï¼›</p>
<br>

<h5 id="ä»å°¾éƒ¨å¯»æ‰¾å…ƒç´ "><a href="#ä»å°¾éƒ¨å¯»æ‰¾å…ƒç´ " class="headerlink" title="ä»å°¾éƒ¨å¯»æ‰¾å…ƒç´ "></a><strong>ä»å°¾éƒ¨å¯»æ‰¾å…ƒç´ </strong></h5><p>å¦‚æœ idx èŠ‚ç‚¹ç¦»é“¾è¡¨å°¾éƒ¨æ¯”è¾ƒè¿‘ï¼Œåˆ™å°†ä¼šä»å°¾éƒ¨å‘å‰éå†ï¼›</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="rust">else {
  // Tail to Head
  cur = self.tail;
  for _ in 0..offset_from_end {
    match cur.take() {
      None =&gt; {
        cur = self.tail;
      }
      Some(current) =&gt; unsafe {
        cur = current.as_ref().prev;
      },
    }
  }
}</code></pre>
<p>è¿™ä¸€æ®µä»£ç ä¸ä»å¤´å¼€å§‹éå†æä¸ºç›¸ä¼¼ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ï¼</p>
<br>

<h5 id="è¿”å›ç¬¬-idx-ä¸ªå…ƒç´ "><a href="#è¿”å›ç¬¬-idx-ä¸ªå…ƒç´ " class="headerlink" title="è¿”å›ç¬¬ idx ä¸ªå…ƒç´ "></a><strong>è¿”å›ç¬¬ idx ä¸ªå…ƒç´ </strong></h5><p>ç»è¿‡ä¸Šé¢çš„å¤„ç†ï¼Œæœ€ç»ˆä¼šæ‰¾åˆ°æŒ‡å‘ç¬¬ idx ä¸ªå…ƒç´ çš„è£¸æŒ‡é’ˆï¼šcurï¼›</p>
<p>æœ€åï¼Œæˆ‘ä»¬è¿”å›è¿™ä¸ªæŒ‡é’ˆæŒ‡å‘çš„èŠ‚ç‚¹ä¸­çš„å€¼å³å¯ï¼š</p>
<pre><code class="rust">unsafe { Ok(cur.as_ref().map(|node| &amp;node.as_ref().val)) }</code></pre>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬çš„æ ¹æ® index æŸ¥çœ‹å…ƒç´ çš„æ–¹æ³•å·²ç»å®Œæˆï¼</p>
<br>

<h3 id="â‘¥-æ ¹æ®indexè·å–å¯å˜å…ƒç´ ï¼šget-by-idx-mut"><a href="#â‘¥-æ ¹æ®indexè·å–å¯å˜å…ƒç´ ï¼šget-by-idx-mut" class="headerlink" title="â‘¥ æ ¹æ®indexè·å–å¯å˜å…ƒç´ ï¼šget_by_idx_mut()"></a><strong>â‘¥ æ ¹æ®indexè·å–å¯å˜å…ƒç´ ï¼šget_by_idx_mut()</strong></h3><p>æœ‰äº†æ ¹æ® index è·å–åªè¯»å…ƒç´ çš„ <code>get_by_idx</code>ï¼Œå¾ˆè‡ªç„¶çš„æƒ³åˆ°è¿˜ä¼šæœ‰è·å–å¯å˜å…ƒç´ çš„ <code>get_by_idx_mut</code>ï¼›</p>
<p>ä¸ <code>get_by_idx</code> ä¸åŒï¼Œ<code>get_by_idx_mut</code> çš„ä½¿ç”¨åœºæ™¯åœ¨å†…éƒ¨å®ç°ä¸­ä¹Ÿä¼šè¢«å¤§é‡ç”¨åˆ°ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>æ ¹æ®å…ƒç´ æ’å…¥æŒ‡å®šçš„ index ä½ç½®ï¼›</li>
<li>åˆ é™¤æŒ‡å®š index ä½ç½®çš„å…ƒç´ ï¼›</li>
<li>â€¦â€¦</li>
</ul>
<p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°ä¸€ä¸ªå†…éƒ¨æ–¹æ³•ï¼šè¿”å›æŒ‡å‘ index å¯¹åº”èŠ‚ç‚¹çš„å¯å˜è£¸æŒ‡é’ˆæ¥è¾¾åˆ°ä»£ç å¤ç”¨çš„æ•ˆæœï¼š</p>
<pre><code class="rust"> fn _get_by_idx_mut(&amp;self, idx: usize) -&gt; Result&lt;Option&lt;NonNull&lt;Node&lt;T&gt;&gt;&gt;, Box&lt;dyn Error&gt;&gt; {
   let len = self.length;

   if idx &gt;= len {
     return Err(Box::new(IndexOutOfRangeError {}));
   }

   // Iterate towards the node at the given index, either from the start or the end,
   // depending on which would be faster.
   let offset_from_end = len - idx - 1;
   let mut cur;
   if idx &lt;= offset_from_end {
     // Head to Tail
     cur = self.head;
     for _ in 0..idx {
       match cur.take() {
         None =&gt; {
           cur = self.head;
         }
         Some(current) =&gt; unsafe {
           cur = current.as_ref().next;
         },
       }
     }
   } else {
     // Tail to Head
     cur = self.tail;
     for _ in 0..offset_from_end {
       match cur.take() {
         None =&gt; {
           cur = self.tail;
         }
         Some(current) =&gt; unsafe {
           cur = current.as_ref().prev;
         },
       }
     }
   }

   Ok(cur)
}</code></pre>
<p>ä»£ç ä¸ <code>get_by_idx</code> æ–¹æ³•å³ä¸ºç›¸ä¼¼ï¼Œåªæ˜¯æŠŠ cur å£°æ˜ä¸ºäº† mutï¼Œå¹¶ä¸”ç›´æ¥è¿”å› <code>Ok(cur)</code>ï¼</p>
<p>éšåï¼Œç›´æ¥ä½¿ç”¨è¿™ä¸ªå†…éƒ¨æ–¹æ³•å®ç°æˆ‘ä»¬çš„ <code>get_by_idx_mut</code> æ–¹æ³•ï¼š</p>
<pre><code class="rust">pub fn get_by_idx_mut(&amp;self, idx: usize) -&gt; Result&lt;Option&lt;&amp;mut T&gt;, Box&lt;dyn Error&gt;&gt; {
  let mut cur = self._get_by_idx_mut(idx)?;
  unsafe { Ok(cur.as_mut().map(|node| &amp;mut node.as_mut().val)) }
}</code></pre>
<br>

<h3 id="â‘¦-åœ¨æŒ‡å®šindex-å‰-æ’å…¥å…ƒç´ "><a href="#â‘¦-åœ¨æŒ‡å®šindex-å‰-æ’å…¥å…ƒç´ " class="headerlink" title="â‘¦ åœ¨æŒ‡å®šindex(å‰)æ’å…¥å…ƒç´ "></a><strong>â‘¦ åœ¨æŒ‡å®šindex(å‰)æ’å…¥å…ƒç´ </strong></h3><p>ç»è¿‡å‰é¢çš„ä¸€äº›é“ºå«ï¼Œè¿™é‡Œå®ç°çš„æ–¹æ³•å°±æ˜¾å¾—æ¯”è¾ƒå¸¸è§„äº†ï¼</p>
<p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="rust">pub fn insert_by_idx(&amp;mut self, idx: usize, data: T) -&gt; Result&lt;(), Box&lt;dyn Error&gt;&gt; {
  let len = self.length;

  if idx &gt; len {
    return Err(Box::new(IndexOutOfRangeError {}));
  }

  if idx == 0 {
    return Ok(self.push_front(data));
  } else if idx == len {
    return Ok(self.push_back(data));
  }

  unsafe {
    // Create Node
    let mut spliced_node = Box::new(Node::new(data));
    let before_node = self._get_by_idx_mut(idx - 1)?;
    let after_node = before_node.unwrap().as_mut().next;
    spliced_node.prev = before_node;
    spliced_node.next = after_node;
    let spliced_node = NonNull::new(Box::into_raw(spliced_node));

    // Insert Node
    before_node.unwrap().as_mut().next = spliced_node;
    after_node.unwrap().as_mut().prev = spliced_node;
  }

  self.length += 1;

  Ok(())
}</code></pre>
<p>é¦–å…ˆï¼Œå¦‚æœ idx å¤§äº lenï¼Œåˆ™è¿”å›é”™è¯¯ï¼ˆ<strong>è¿™é‡Œå¯ä»¥ç›¸ç­‰ï¼Œè¿™ç›¸å½“äºåœ¨é“¾è¡¨å°¾éƒ¨æ’å…¥ä¸€ä¸ªå…ƒç´ </strong>ï¼‰ï¼›</p>
<p>éšåï¼Œä¸ºäº†é¿å…ä¸€äº›æ ·æ¿ä»£ç ï¼š</p>
<ul>
<li><code>idx==0</code>å¯ä»¥è¢«ç®€åŒ–ä¸ºï¼špush_frontï¼›</li>
<li><code>idx == len</code>å¯ä»¥è¢«ç®€åŒ–ä¸ºï¼špush_backï¼›</li>
</ul>
<p>å¦‚æœæ˜¯åœ¨é“¾è¡¨çš„ä¸­é—´èŠ‚ç‚¹æ’å…¥å…ƒç´ ï¼Œåˆ™ï¼š</p>
<pre><code class="rust"> // Create Node
let mut spliced_node = Box::new(Node::new(data));
let before_node = self._get_by_idx_mut(idx - 1)?;
let after_node = before_node.unwrap().as_mut().next;
spliced_node.prev = before_node;
spliced_node.next = after_node;
let spliced_node = NonNull::new(Box::into_raw(spliced_node));

// Insert Node
before_node.unwrap().as_mut().next = spliced_node;
after_node.unwrap().as_mut().prev = spliced_node;</code></pre>
<p>é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„å…ƒç´ ï¼š<code>Box::new(Node::new(data))</code>ï¼›</p>
<p>éšåä½¿ç”¨æˆ‘ä»¬ä¹‹å‰å†™è¿‡çš„æ–¹æ³•ï¼š<code>self._get_by_idx_mut(idx - 1)?</code>ï¼Œå–å‡ºå°†è¦æ’å…¥çš„ index çš„å‰ä¸€ä¸ªå…ƒç´ ï¼šbefore_nodeï¼›</p>
<blockquote>
<p>  <strong>è¡¥å……çŸ¥è¯†ï¼š<code>?</code>æ“ä½œç¬¦</strong></p>
<p>  å¦‚æœä½ ä½¿ç”¨è¿‡ Kotlin ä½ å°±ä¼šå¯¹è¿™ä¸ªæ“ä½œç¬¦å¾ˆç†Ÿæ‚‰ï¼š</p>
<p>  <strong><code>?</code>æ“ä½œç¬¦æ”¾åœ¨ä¸€ä¸ªè¿”å› Result ç±»å‹çš„å‡½æ•°åï¼š</strong></p>
<ul>
<li><strong>å¦‚æœå‡½æ•°è¿”å› Errorï¼Œåˆ™è¯¥å‡½æ•°ä¼šç›´æ¥ return Errorï¼›</strong></li>
<li><strong>å¦åˆ™ï¼Œå‡½æ•°è°ƒç”¨æˆåŠŸï¼Œè¿”å›å‡½æ•°çš„è¿”å›å€¼ï¼›</strong></li>
</ul>
<p>  <strong><code>?</code>æ“ä½œç¬¦ç»å¸¸ç”¨åœ¨å¦‚æœè°ƒç”¨å‡½æ•°å‘ç”Ÿé”™è¯¯ï¼Œç›´æ¥è¿”å›é”™è¯¯çš„åœºæ™¯ï¼Œç”¨äºç®€åŒ–ä»£ç ï¼›</strong></p>
</blockquote>
<p>ç„¶åï¼Œé€šè¿‡ <code>let after_node = before_node.unwrap().as_mut().next;</code> è·å–å½“å‰ index å¤„çš„èŠ‚ç‚¹ï¼ˆ<strong>å› ä¸ºæ’å…¥æ–°èŠ‚ç‚¹åªéœ€è¦ä¿®æ”¹è¿™ä¸¤ä¸ªèŠ‚ç‚¹å³å¯ï¼</strong>ï¼‰ï¼›</p>
<p>æœ€åï¼Œä¿®æ”¹å¾…æ’å…¥çš„èŠ‚ç‚¹çš„ <code>prev</code> å’Œ <code>next</code>ï¼Œç„¶åå°†èŠ‚ç‚¹æ’å…¥ï¼š</p>
<pre><code class="rust">spliced_node.prev = before_node;
spliced_node.next = after_node;
let spliced_node = NonNull::new(Box::into_raw(spliced_node));

// Insert Node
before_node.unwrap().as_mut().next = spliced_node;
after_node.unwrap().as_mut().prev = spliced_node;</code></pre>
<blockquote>
<p>  <strong>æ³¨ï¼šè¿™é‡Œä½¿ç”¨ <code>unwrap()</code> ç›´æ¥è·å–èŠ‚ç‚¹çš„å€¼æ˜¯å› ä¸ºï¼Œæˆ‘ä»¬èƒ½å¤Ÿä¿è¯è¿™äº›èŠ‚ç‚¹ä¸€å®šä¸ä¸º Noneï¼</strong></p>
<p>  <strong>å¦åˆ™ä¼šäº§ç”Ÿ panic é”™è¯¯ï¼</strong></p>
</blockquote>
<br>

<h3 id="â‘§-åˆ é™¤indexå¤„çš„å…ƒç´ "><a href="#â‘§-åˆ é™¤indexå¤„çš„å…ƒç´ " class="headerlink" title="â‘§ åˆ é™¤indexå¤„çš„å…ƒç´ "></a><strong>â‘§ åˆ é™¤indexå¤„çš„å…ƒç´ </strong></h3><p>æœ‰äº†åœ¨ index å‰æ’å…¥å…ƒç´ ï¼Œä¸‹é¢æˆ‘ä»¬ç»§ç»­å®ç°åˆ é™¤ index å¤„å…ƒç´ çš„é€»è¾‘ï¼›</p>
<p>å’Œåœ¨ index å¤„æ’å…¥å…ƒç´ ç±»ä¼¼ï¼š</p>
<ul>
<li>å¦‚æœ <code>index &gt;= len</code>ï¼Œåˆ™æŠ¥é”™ï¼ˆæ­¤æ—¶ index æ²¡æœ‰å…ƒç´ ï¼Œæˆ‘ä»¬ä¹Ÿä¸èƒ½ç§»é™¤å…ƒç´ ï¼‰ï¼›</li>
<li>å¦‚æœ <code>idx == 0</code>ï¼Œè°ƒç”¨ pop_frontï¼›</li>
<li>å¦‚æœ <code>idx == len -1</code>ï¼Œè°ƒç”¨ pop_backï¼›</li>
</ul>
<p>å¦åˆ™ï¼Œè¿›å…¥ç§»é™¤åœ¨é“¾è¡¨å†…éƒ¨èŠ‚ç‚¹çš„é€»è¾‘ï¼›</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="rust">/// Removes the element at the given index and returns it.
///
/// This operation should compute in *O*(*n*) time.
pub fn remove_by_idx(&amp;mut self, idx: usize) -&gt; Result&lt;T, Box&lt;dyn Error&gt;&gt; {
  let len = self.length;

  if idx &gt;= len {
    return Err(Box::new(IndexOutOfRangeError {}));
  }

  if idx == 0 {
    return Ok(self.pop_front().unwrap());
  } else if idx == len - 1 {
    return Ok(self.pop_back().unwrap());
  };

  let cur = self._get_by_idx_mut(idx)?.unwrap();

  self.unlink_node(cur);

  unsafe {
    let unlinked_node = Box::from_raw(cur.as_ptr());
    Ok(unlinked_node.val)
  }
}</code></pre>
<p>å¦‚æœ index ä¸ºé“¾è¡¨å†…éƒ¨èŠ‚ç‚¹ï¼Œåˆ™åœ¨ç§»é™¤æ—¶ï¼š</p>
<p>é¦–å…ˆï¼Œé€šè¿‡ <code>self._get_by_idx_mut(idx)?.unwrap();</code> è·å–åœ¨ index å¤„çš„è£¸æŒ‡é’ˆï¼ˆå¾…ç§»é™¤èŠ‚ç‚¹å¯¹åº”æŒ‡é’ˆï¼‰ï¼›</p>
<p>éšåï¼Œè°ƒç”¨ <code>unlink_node</code> æ–¹æ³•å°†è¯¥èŠ‚ç‚¹ä»é“¾è¡¨ä¸­ç§»é™¤ï¼š</p>
<pre><code class="rust">/// Unlinks the specified node from the current list.
///
/// Warning: this will not check that the provided node belongs to the current list.
///
/// This method takes care not to create mutable references to `element`,
/// to maintain validity of aliasing pointers.
#[inline]
fn unlink_node(&amp;mut self, mut node: NonNull&lt;Node&lt;T&gt;&gt;) {
  let node = unsafe { node.as_mut() }; // this one is ours now, we can create an &amp;mut.

  // Not creating new mutable (unique!) references overlapping `element`.
  match node.prev {
    Some(prev) =&gt; unsafe { (*prev.as_ptr()).next = node.next },
    // this node is the head node
    None =&gt; self.head = node.next,
  };

  match node.next {
    Some(next) =&gt; unsafe { (*next.as_ptr()).prev = node.prev },
    // this node is the tail node
    None =&gt; self.tail = node.prev,
  };

  self.length -= 1;
}</code></pre>
<p><strong>unlink_node çš„é€»è¾‘éå¸¸ç®€å•ï¼Œå°±æ˜¯ï¼š</strong></p>
<p><strong>ä¿®æ”¹å¾…ç§»é™¤èŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹å’Œåä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œä½¿å¾—è‡ªèº«èŠ‚ç‚¹è¢«ç§»å‡ºåŸé“¾è¡¨ï¼</strong></p>
<p>æœ€åï¼Œä»£ç é€šè¿‡ï¼š<code>Box::from_raw</code> å°†è£¸æŒ‡é’ˆè¿˜åŸä¸ºå®é™…çš„ <code>Box&lt;Node&lt;T&gt;&gt;</code> ç±»å‹ï¼Œå¹¶å°†èŠ‚ç‚¹ä¸­çš„å…ƒç´ å€¼è¿”å›ï¼</p>
<pre><code class="rust">unsafe {
  let unlinked_node = Box::from_raw(cur.as_ptr());
  Ok(unlinked_node.val)
}</code></pre>
<blockquote>
<p>  <strong>æ³¨ï¼šremove_by_idx æ–¹æ³•ç­¾åä¸ºï¼š</strong></p>
<p>  <strong><code>remove_by_idx(&amp;mut self, idx: usize) -&gt; Result&lt;T, Box&lt;dyn Error&gt;&gt;</code></strong></p>
<p>  <font color="#f00"><strong>å³ï¼Œremove_by_idx æ–¹æ³•ä¼šç›´æ¥å°†èŠ‚ç‚¹ç§»é™¤ï¼Œå¹¶å°†åœ¨èŠ‚ç‚¹å­˜æ”¾å…ƒç´ çš„æ‰€æœ‰æƒè¿”å›ç»™æ–¹æ³•è°ƒç”¨è€…ï¼</strong></font></p>
</blockquote>
<br>

<h3 id="â‘¨-ä¸‰ç§è¿­ä»£å™¨çš„å®ç°ï¼šiterã€iter-mutå’Œinto-iter"><a href="#â‘¨-ä¸‰ç§è¿­ä»£å™¨çš„å®ç°ï¼šiterã€iter-mutå’Œinto-iter" class="headerlink" title="â‘¨ ä¸‰ç§è¿­ä»£å™¨çš„å®ç°ï¼šiterã€iter_mutå’Œinto_iter"></a><strong>â‘¨ ä¸‰ç§è¿­ä»£å™¨çš„å®ç°ï¼šiterã€iter_mutå’Œinto_iter</strong></h3><p>å¯¹åº”äº Rust å˜é‡å­˜åœ¨çš„ä¸‰ç§å½¢å¼ï¼ˆ<code>&amp;self</code>ã€<code>&amp;mut self</code>ã€<code>self</code>ï¼‰ï¼Œè¿­ä»£å™¨ä¹Ÿè¢«åˆ†ä¸ºäº†ä¸‰ç§ï¼š</p>
<ul>
<li><strong>IntoIterï¼šè·å–å…ƒç´ æ‰€æœ‰æƒçš„è¿­ä»£å™¨ï¼Œè¿­ä»£å™¨ä¼šè·å–åŸå®¹å™¨ä¸­å…¨éƒ¨å…ƒç´ æ‰€æœ‰æƒåˆ°è¿­ä»£å™¨ä¸­ï¼Œéšåè¢«æ¶ˆè€—æ‰ï¼›</strong></li>
<li><strong>Iterï¼šä¸å¯å˜å¼•ç”¨ç±»å‹çš„è¿­ä»£å™¨ï¼Œå³ï¼šå¯¹å®¹å™¨è¿›è¡Œåªè¯»è¿­ä»£ï¼›</strong></li>
<li><strong>IterMutï¼šå¯å˜å¼•ç”¨ç±»å‹çš„è¿­ä»£å™¨ï¼Œå³ï¼šä¸è·å–å®¹å™¨ä¸­å…ƒç´ çš„æ‰€æœ‰æƒï¼Œä½†æ˜¯è·å–å…ƒç´ çš„å¯å˜å¼•ç”¨è¿›è¡Œè¿­ä»£ï¼ˆå¯ä»¥åœ¨éå†æ—¶ä¿®æ”¹åŸå®¹å™¨ä¸­å…ƒç´ çš„å€¼ï¼‰ï¼›</strong></li>
</ul>
<h4 id="è¿­ä»£å™¨ç±»å‹å®šä¹‰"><a href="#è¿­ä»£å™¨ç±»å‹å®šä¹‰" class="headerlink" title="è¿­ä»£å™¨ç±»å‹å®šä¹‰"></a><strong>è¿­ä»£å™¨ç±»å‹å®šä¹‰</strong></h4><p>é¦–å…ˆæˆ‘ä»¬ä¸ºé“¾è¡¨å®šä¹‰è¿™ä¸‰ç§è¿­ä»£å™¨ç±»å‹ï¼š</p>
<pre><code class="rust">pub struct IntoIter&lt;T&gt; {
    list: LinkedList&lt;T&gt;,
}

pub struct Iter&lt;&#39;a, T: &#39;a&gt; {
    head: Option&lt;NonNull&lt;Node&lt;T&gt;&gt;&gt;,
    tail: Option&lt;NonNull&lt;Node&lt;T&gt;&gt;&gt;,
    len: usize,
    _marker: PhantomData&lt;&amp;&#39;a Node&lt;T&gt;&gt;,
}

pub struct IterMut&lt;&#39;a, T: &#39;a&gt; {
    head: Option&lt;NonNull&lt;Node&lt;T&gt;&gt;&gt;,
    tail: Option&lt;NonNull&lt;Node&lt;T&gt;&gt;&gt;,
    len: usize,
    _marker: PhantomData&lt;&amp;&#39;a mut Node&lt;T&gt;&gt;,
}</code></pre>
<p>å¯¹äº IntoIter çš„ç»“æ„å£°æ˜æ˜¯æ˜ç¡®çš„ï¼Œå› ä¸º IntoIter ä¼šè·å–æ•´ä¸ªé“¾è¡¨æ‰€æœ‰èŠ‚ç‚¹çš„æ‰€æœ‰æƒï¼Œå› æ­¤ç›´æ¥å°†é“¾è¡¨çš„æ‰€æœ‰æƒè½¬ç§»è‡³ IntoIter ä¸­å³å¯ï¼›</p>
<p>ä½†æ˜¯å¯¹äº Iter å’Œ IterMut è€Œè¨€ï¼Œæˆ‘ä»¬éœ€è¦ Copy å½“å‰é“¾è¡¨çš„å¤´èŠ‚ç‚¹å’Œå°¾èŠ‚ç‚¹ï¼Œè€Œéè·å–é“¾è¡¨çš„æ‰€æœ‰æƒï¼›</p>
<p>åŒæ—¶ï¼Œ<strong>å¯¹äº Iterator çš„ Item å¦‚æœæ˜¯å¼•ç”¨ç±»å‹ï¼Œåˆ™éœ€è¦æŒ‡å®šå¯¹åº”å…ƒç´ çš„ç”Ÿå‘½å‘¨æœŸï¼›</strong></p>
<p><strong>ä½†æ˜¯ç”±äº head å’Œ tail ä¸­å­˜æ”¾çš„æ˜¯è£¸æŒ‡é’ˆï¼ˆå³è¡¨ç¤ºï¼Œå…¶å†…å­˜åˆ†é…æ˜¯ç”±æˆ‘ä»¬æ¥ç®¡ç†çš„ï¼ï¼‰ï¼Œå› æ­¤æ­¤æ—¶å†æ¬¡éœ€è¦ä½¿ç”¨ <code>PhantomData</code> æ¥é¿å…ç¼–è¯‘å™¨å¯¹äºç”Ÿå‘½å‘¨æœŸçš„æ£€æŸ¥é—®é¢˜ï¼›</strong></p>
<p>ç›¸å¯¹åº”çš„ï¼Œä¸‹é¢æ˜¯åœ¨åŒå‘é“¾è¡¨ä¸­å®ç°çš„å„ä¸ªç±»å‹çš„è¿­ä»£å™¨çš„æ„é€ æ–¹æ³•ï¼š</p>
<pre><code class="rust">pub fn into_iter(self) -&gt; IntoIter&lt;T&gt; {
  IntoIter { list: self }
}

pub fn iter(&amp;self) -&gt; Iter&lt;&#39;_, T&gt; {
  Iter {
    head: self.head,
    tail: self.tail,
    len: self.length,
    _marker: PhantomData,
  }
}

pub fn iter_mut(&amp;mut self) -&gt; IterMut&lt;&#39;_, T&gt; {
  IterMut {
    head: self.head,
    tail: self.tail,
    len: self.length,
    _marker: PhantomData,
  }
}</code></pre>
<p>é™¤äº† IntoIter ç›´æ¥è·å–çš„é“¾è¡¨çš„æ‰€æœ‰æƒï¼ŒIter å’Œ IterMut éƒ½æ˜¯ä»…ä»… Copy è£¸æŒ‡é’ˆï¼›</p>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å¯¹ä¸‰ç§è¿­ä»£å™¨çš„å®šä¹‰å®Œæˆï¼Œä¸‹é¢æ¥å…·ä½“å®ç°æ¯ä¸€ç§è¿­ä»£å™¨ï¼›</p>
<br>

<h4 id="i-å®ç°IntoIter"><a href="#i-å®ç°IntoIter" class="headerlink" title="i.å®ç°IntoIter"></a><strong>i.å®ç°IntoIter</strong></h4><p>IntoIterçš„å®ç°éå¸¸ç®€å•ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»å®Œå…¨å°†é“¾è¡¨çš„æ‰€æœ‰æƒäº¤ç»™äº† IntoIterï¼›</p>
<p>å› æ­¤ï¼Œå¦‚æœéœ€è¦æ­£å‘éå†ï¼Œæˆ‘ä»¬ç›´æ¥è°ƒç”¨ pop_front å³å¯ï¼›è€Œå¦‚æœéœ€è¦åå‘éå†ï¼Œæˆ‘ä»¬åªéœ€è¦è°ƒç”¨ pop_backï¼›</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="rust">impl&lt;T&gt; Iterator for IntoIter&lt;T&gt; {
    type Item = T;

    #[inline]
    fn next(&amp;mut self) -&gt; Option&lt;Self::Item&gt; {
        self.list.pop_front()
    }

    #[inline]
    fn size_hint(&amp;self) -&gt; (usize, Option&lt;usize&gt;) {
        (self.list.length, Some(self.list.length))
    }
}

impl&lt;T&gt; DoubleEndedIterator for IntoIter&lt;T&gt; {
    #[inline]
    fn next_back(&amp;mut self) -&gt; Option&lt;Self::Item&gt; {
        self.list.pop_back()
    }
}</code></pre>
<p>ç”±äºåŒå‘é“¾è¡¨å¯ä»¥ä»ä¸¤ä¸ªæ–¹å‘è¿­ä»£ï¼Œå› æ­¤æˆ‘ä»¬ä¸º IntoIter åŒæ—¶å®ç°äº†ä¸¤ä¸ª Traitï¼š</p>
<ul>
<li><strong>Iteratorï¼šæ­£å‘è¿­ä»£å™¨ï¼›</strong></li>
<li><strong>DoubleEndedIteratorï¼šåå‘è¿­ä»£å™¨ï¼›</strong></li>
</ul>
<p>åœ¨å®ç° Iterator æ—¶ï¼š</p>
<p>é¦–å…ˆï¼Œ<code>type Item = T;</code> å£°æ˜äº†è¿­ä»£å™¨è¿”å›å€¼ç±»å‹ä¸º <code>T</code>;</p>
<p>è€Œ <code>next</code> å°±æ˜¯ç”¨ pop_front æ–¹æ³•å®ç°ï¼›</p>
<p>åŒç†ï¼ŒDoubleEndedIterator ä½¿ç”¨ pop_back æ–¹æ³•å®ç°ï¼›</p>
<p><font color="#f00"><strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</strong></font></p>
<p><font color="#f00"><strong>ç”±äº IntoIter è·å–äº†æ•´ä¸ªé“¾è¡¨çš„æ‰€æœ‰æƒï¼Œè€Œæˆ‘ä»¬æ˜¯é€šè¿‡è£¸æŒ‡é’ˆå®ç°çš„é“¾è¡¨ï¼Œå³æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ç®¡ç†è¿™éƒ¨åˆ†å†…å­˜ï¼›</strong></font></p>
<p><font color="#f00"><strong>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ä¸º IntoIter å®ç° Drop Traitï¼Œä»¥ç¡®ä¿åœ¨ IntoIter é€€å‡ºä½œç”¨åŸŸåï¼Œèƒ½å¤Ÿå‡†å¤‡çš„é‡Šæ”¾æ‰é‚£äº›è¿˜æ²¡æœ‰è¢« move å‡ºå»çš„å…ƒç´ ï¼</strong></font></p>
<p>å…·ä½“å®ç°ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="rust">impl&lt;T&gt; Drop for IntoIter&lt;T&gt; {
    fn drop(&amp;mut self) {
        // only need to ensure all our elements are read;
        // buffer will clean itself up afterwards.
        for _ in &amp;mut *self {}

        println!(&quot;IntoIter has been dropped!&quot;)
    }
}</code></pre>
<p>ä»£ç éå¸¸ç®€å•ï¼Œæˆ‘ä»¬ç›´æ¥é€šè¿‡ for å¾ªç¯å°† IntoIter ä¸­è¿˜æœªè¢«æ¶ˆè´¹çš„å…ƒç´ ç›´æ¥å–å‡ºæ¥ï¼Œç„¶åå¿½ç•¥æ‰å³å¯ï¼</p>
<blockquote>
<p>  <strong>æ³¨1ï¼š</strong></p>
<p>  <font color="#f00"><strong>è¿™é‡Œçš„ <code>for _ in &amp;mut *self {}</code> å®é™…ä¸Šå°±æ˜¯è°ƒç”¨çš„è¿­ä»£å™¨æœ¬èº«çš„ <code>next</code> æ–¹æ³•å»å–å…ƒç´ ï¼›</strong></font></p>
<p>  <font color="#f00"><strong>è€Œ <code>next</code> æ˜¯è°ƒç”¨çš„é“¾è¡¨çš„ pop_front æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æœ€ç»ˆä¼šè°ƒç”¨ <code>Box::from_raw</code> å°†è£¸æŒ‡é’ˆè½¬ä¸ºå…·ä½“çš„å…ƒç´ è¿”å›ï¼Œå› æ­¤å®ç°äº†å†…å­˜é‡Šæ”¾ï¼›</strong></font></p>
</blockquote>
<blockquote>
<p>  <strong>æ³¨2ï¼š</strong></p>
<p>  <font color="#f00"><strong>è¿™é‡Œæ‰€åšçš„ä¹Ÿä»…ä»…æ˜¯å°†å…ƒç´ å–å‡ºï¼Œå¹¶å¿½ç•¥ï¼ˆé€€å‡ºä½œç”¨åŸŸï¼‰ï¼›</strong></font></p>
<p>  <font color="#f00"><strong>å…·ä½“çš„å†…å­˜é‡Šæ”¾è¿˜è¦ä¾èµ–äºå…·ä½“çš„èŒƒå‹ç±»å‹ <code>T</code> æœ¬èº«ï¼</strong></font></p>
</blockquote>
<br>

<h4 id="ii-å®ç°Iter"><a href="#ii-å®ç°Iter" class="headerlink" title="ii.å®ç°Iter"></a><strong>ii.å®ç°Iter</strong></h4><p>ç›¸æ¯”äº IntoIterï¼Œåœ¨å®ç° Iter æ—¶ï¼Œæˆ‘ä»¬éœ€è¦è‡ªå·±æ‰‹åŠ¨ç»´æŠ¤ head å’Œ tail è£¸æŒ‡é’ˆï¼›</p>
<p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="rust">impl&lt;&#39;a, T&gt; Iterator for Iter&lt;&#39;a, T&gt; {
    type Item = &amp;&#39;a T;

    #[inline]
    fn next(&amp;mut self) -&gt; Option&lt;Self::Item&gt; {
        if self.len == 0 {
            None
        } else {
            self.head.map(|node| {
                self.len -= 1;

                unsafe {
                    let node = &amp;*node.as_ptr();
                    self.head = node.next;
                    &amp;node.val
                }
            })
        }
    }

    #[inline]
    fn size_hint(&amp;self) -&gt; (usize, Option&lt;usize&gt;) {
        (self.len, Some(self.len))
    }

    #[inline]
    fn last(mut self) -&gt; Option&lt;&amp;&#39;a T&gt; {
        self.next_back()
    }
}

impl&lt;&#39;a, T&gt; DoubleEndedIterator for Iter&lt;&#39;a, T&gt; {
    fn next_back(&amp;mut self) -&gt; Option&lt;Self::Item&gt; {
        if self.len == 0 {
            None
        } else {
            self.tail.map(|node| {
                self.len -= 1;

                unsafe {
                    // Need an unbound lifetime to get &#39;a
                    let node = &amp;*node.as_ptr();
                    self.tail = node.prev;
                    &amp;node.val
                }
            })
        }
    }
}</code></pre>
<p>æ­£å‘å’Œåå‘éå†å®ç°èµ·æ¥ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå…·ä½“çš„å®ç°é€»è¾‘è¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ï¼›</p>
<p><font color="#f00"><strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</strong></font></p>
<p><font color="#f00"><strong>å› ä¸º Iter æœ¬è´¨ä¸Šåªæ˜¯å¯¹æˆ‘ä»¬çš„é“¾è¡¨ä¸­çš„ headã€tail ä»¥åŠ length ç­‰å±æ€§è¿›è¡Œäº† Copyï¼Œè€Œå„ä¸ªå…ƒç´ çš„æ‰€æœ‰æƒä¾ç„¶åœ¨é“¾è¡¨ä¸­ï¼›</strong></font></p>
<p><font color="#f00"><strong>å¹¶ä¸”ï¼Œ headã€tail ä»¥åŠ length å®é™…ä¸Šéƒ½æ˜¯ä¸€ä¸ªæ•´å‹æ•°å­—ï¼›</strong></font></p>
<p><font color="#f00"><strong>å› æ­¤æˆ‘ä»¬ä¸éœ€è¦ä¸ºç‰¹åˆ«ä¸º Iter å®ç° Drop æ–¹æ³•ï¼Œå› ä¸º Iter ä¸­çš„æ‰€æœ‰ç±»å‹å‡å·²ç»ç”± Rust æ ‡å‡†åº“å®ç°äº† Dropï¼</strong></font></p>
<br>

<h4 id="iii-å®ç°IterMut"><a href="#iii-å®ç°IterMut" class="headerlink" title="iii.å®ç°IterMut"></a><strong>iii.å®ç°IterMut</strong></h4><p>IterMut çš„å®ç°å’Œ Iter çš„å®ç°å‡ ä¹å®Œå…¨ä¸€è‡´ï¼Œåªæ˜¯å°†ç±»å‹æ¢ä¸ºäº†ï¼š<code>type Item = &amp;&#39;a mut T</code>ï¼›</p>
<p>å…·ä½“å®ç°çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="rust">impl&lt;&#39;a, T&gt; Iterator for IterMut&lt;&#39;a, T&gt; {
    type Item = &amp;&#39;a mut T;

    #[inline]
    fn next(&amp;mut self) -&gt; Option&lt;Self::Item&gt; {
        if self.len == 0 {
            None
        } else {
            self.head.map(|node| {
                self.len -= 1;

                unsafe {
                    let node = &amp;mut *node.as_ptr();
                    self.head = node.next;
                    &amp;mut node.val
                }
            })
        }
    }

    #[inline]
    fn size_hint(&amp;self) -&gt; (usize, Option&lt;usize&gt;) {
        (self.len, Some(self.len))
    }

    #[inline]
    fn last(mut self) -&gt; Option&lt;&amp;&#39;a mut T&gt; {
        self.next_back()
    }
}

impl&lt;&#39;a, T&gt; DoubleEndedIterator for IterMut&lt;&#39;a, T&gt; {
    #[inline]
    fn next_back(&amp;mut self) -&gt; Option&lt;Self::Item&gt; {
        if self.len == 0 {
            None
        } else {
            self.tail.map(|node| {
                self.len -= 1;

                unsafe {
                    // Need an unbound lifetime to get &#39;a
                    let node = &amp;mut *node.as_ptr();
                    self.tail = node.prev;
                    &amp;mut node.val
                }
            })
        }
    }
}</code></pre>
<p>è¿™é‡Œä¸å†èµ˜è¿°ï¼</p>
<br>

<h3 id="â‘©-æ˜¯å¦åŒ…å«æŸå…ƒç´ ï¼šcontains"><a href="#â‘©-æ˜¯å¦åŒ…å«æŸå…ƒç´ ï¼šcontains" class="headerlink" title="â‘© æ˜¯å¦åŒ…å«æŸå…ƒç´ ï¼šcontains()"></a><strong>â‘© æ˜¯å¦åŒ…å«æŸå…ƒç´ ï¼šcontains()</strong></h3><p>å®ç°äº†è¿­ä»£å™¨ä¹‹åï¼Œæˆ‘ä»¬ä¾¿å¾ˆå®¹æ˜“é€šè¿‡è¿­ä»£å™¨æ¥éå†åˆ¤æ–­é“¾è¡¨ä¸­æ˜¯å¦åŒ…å«æŸä¸ªå…ƒç´ ï¼›</p>
<p>è¿™é‡Œæˆ‘ä»¬åªéœ€è¦åªè¯»æƒé™å³å¯ï¼Œå› æ­¤ä½¿ç”¨ iter è·å–ä¸å¯å˜å¼•ç”¨çš„è¿­ä»£å™¨å³å¯ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="rust">/// Returns `true` if the `LinkedList` contains an element equal to the given value.
///
/// This operation should compute in *O*(*n*) time.
///
/// # Examples
///
/// ```
/// use collection::list::linked_list::LinkedList;
///
/// let mut list = LinkedList::new();
///
/// list.push_back(0);
/// list.push_back(1);
/// list.push_back(2);
///
/// assert_eq!(list.contains(&amp;0), true);
/// assert_eq!(list.contains(&amp;10), false);
/// ```
pub fn contains(&amp;self, elem: &amp;T) -&gt; bool
where
T: PartialEq&lt;T&gt;,
{
  self.iter().any(|x| x == elem)
}</code></pre>
<p>ä»£ç éå¸¸ç®€å•ï¼Œè°ƒç”¨ä¸å¯å˜å¼•ç”¨è¿­ä»£å™¨ iter çš„ any æ–¹æ³•ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨å’Œ elem ç›¸ç­‰çš„å…ƒç´ ï¼›</p>
<p>ä»£ç è™½ç„¶å¾ˆç®€å•ï¼Œè¿™é‡Œè¿˜æ˜¯æœ‰ä¸¤ä¸ªå¯ä»¥è¡¥å……çš„å†…å®¹ï¼š</p>
<ul>
<li>Rust ä¸­å’Œæ¯”è¾ƒç›¸å…³çš„ Traitï¼šEqã€PartialOrdã€Ordç­‰ï¼›</li>
<li>å£°æ˜èŒƒå‹çº¦æŸï¼›</li>
</ul>
<p>ä¸‹é¢åˆ†åˆ«æ¥çœ‹ï¼›</p>
<h4 id="Rust-ä¸­å’Œæ¯”è¾ƒç›¸å…³çš„-Trait"><a href="#Rust-ä¸­å’Œæ¯”è¾ƒç›¸å…³çš„-Trait" class="headerlink" title="Rust ä¸­å’Œæ¯”è¾ƒç›¸å…³çš„ Trait"></a><strong>Rust ä¸­å’Œæ¯”è¾ƒç›¸å…³çš„ Trait</strong></h4><p>åœ¨ <code>core::cmp.rs</code> æ¨¡å—é‡Œå®šä¹‰äº†ç”¨äºä¸¤å€¼ä¹‹é—´æ¯”è¾ƒçš„å‡ ä¸ª Traitï¼Œåˆ†åˆ«æ˜¯:</p>
<ul>
<li><strong>PartialEq</strong></li>
<li><strong>Eq</strong></li>
<li><strong>PartialOrd</strong></li>
<li><strong>Ord</strong></li>
</ul>
<p>è¿™å››ä¸ª Trait ä¹‹é—´æœ‰è¿™æ ·ä¸€ä¸ªå…³ç³»:</p>
<ul>
<li>Eq åŸºäº PartialEqï¼Œå³ï¼š <code>pub trait Eq: PartialEq</code>ï¼›</li>
<li>PartialOrd åŸºäº PartialEqï¼Œå³ <code>pub trait PartialOrd: PartialEq</code>ï¼›</li>
<li>Ord åŸºäº Eq å’Œ PartialOrdï¼Œ <code>pub trait PartialOrd: Eq + PartialOrd&lt;Self&gt;</code>ï¼›</li>
</ul>
<p>åŒæ—¶è¿˜å®šä¹‰äº†æ¯”è¾ƒç»“æœ <code>Ordering</code> è¿™æ ·ä¸€ä¸ªæšä¸¾ç±»å‹ï¼š</p>
<pre><code class="rust">pub enum Ordering {
    Less = -1,
    Equal = 0,
    Greater = 1,
}</code></pre>
<p>ä¸‹é¢å…·ä½“æ¥çœ‹æ¯ä¸€ç§ Trait åˆ†åˆ«è¡¨ç¤ºä»€ä¹ˆï¼›</p>
<h5 id="éƒ¨åˆ†ç­‰ä»·å…³ç³»ï¼šPartialEq"><a href="#éƒ¨åˆ†ç­‰ä»·å…³ç³»ï¼šPartialEq" class="headerlink" title="éƒ¨åˆ†ç­‰ä»·å…³ç³»ï¼šPartialEq"></a><strong>éƒ¨åˆ†ç­‰ä»·å…³ç³»ï¼šPartialEq</strong></h5><p>å…ˆè¯´æœ€åŸºç¡€çš„ <code>PartialEq</code>, è¿™ä¸ª trait å®šä¹‰äº†ä¸¤ä¸ªæ–¹æ³•:</p>
<ul>
<li>eqï¼šä¸¤ä¸ªå€¼ç›¸ç­‰çš„è¯å°±è¿”å› <code>true</code>, éœ€è¦ä½¿ç”¨è€…è‡ªè¡Œå®šä¹‰è¯¥æ–¹æ³•ï¼›</li>
<li>neï¼š ä¸¤ä¸ªå€¼ä¸ç›¸ç­‰çš„è¯å°±è¿”å› <code>true</code>ï¼›</li>
</ul>
<p><code>PartialEq trait</code> å®ç°äº†<a href="https://en.wikipedia.org/wiki/Partial_equivalence_relation" target="_blank" rel="noopener">éƒ¨åˆ†ç­‰ä»·å…³ç³» Partial_equivalence_relation</a>ï¼Œè¿™ç§æ•°å€¼å…³ç³»æœ‰ä»¥ä¸‹ç‰¹æ€§:</p>
<ul>
<li>å¯¹ç§°æ€§ (symmetric): å¦‚æœ <code>a == b</code>, é‚£ä¹ˆ <code>b == a</code>ï¼›</li>
<li>å¯ä¼ é€’æ€§ (transitive): å¦‚æœ <code>a == b</code> ä¸” <code>b == c</code>, é‚£ä¹ˆ <code>a == c</code>ï¼›</li>
</ul>
<p>æ‰€æœ‰çš„åŸºæœ¬æ•°æ®ç±»å‹éƒ½å®ç°äº† <code>PartialEq trait</code>ï¼Œå®ƒä»¬éƒ½å®šä¹‰åœ¨ <a href="https://blog.biofan.org/2019/08/rust-cmp/cmp.rs" target="_blank" rel="noopener">cmp.rs</a> æºä»£ç æ–‡ä»¶é‡Œï¼›</p>
<p>å¹¶ä¸”ï¼Œå¹³æ—¶ä½¿ç”¨æ—¶åªéœ€è¦ç”¨ <code>#[derive]</code> çš„æ–¹æ³•å®ç°å³å¯ï¼Œå°±åƒè¿™æ ·:</p>
<pre><code class="rust">#[derive(PartialEq)]
pub struct Person {
    pub id: u32,
    pub name: String,
    pub height: f64,
}</code></pre>
<p>ç¼–è¯‘å™¨ä¼šé»˜è®¤å®ç°ç±»ä¼¼ä¸‹é¢çš„ä»£ç ï¼š</p>
<pre><code class="rust">impl PartialEq for Person {
    fn eq(&amp;self, other: &amp;Self) -&gt; bool {
        self.id == other.id &amp;&amp;
            self.name == other.name &amp;&amp;
            self.height == other.height
    }
}</code></pre>
<p>ä½†å¦‚æœæˆ‘ä»¬åœ¨æ¯”è¾ƒä¸¤ä¸ª <code>Person</code> æ—¶ï¼Œåªæƒ³é€šè¿‡ <code>id</code> å±æ€§æ¥ç¡®å®šæ˜¯ä¸æ˜¯åŒä¸€ä¸ªäººï¼Œåˆ™å¯ä»¥æ‰‹åŠ¨å®šä¹‰ <code>PartialEq Trait</code> çš„å®ç°ï¼š</p>
<pre><code class="rust">impl PartialEq for Person {
    fn eq(&amp;self, other: &amp;Self) -&gt; bool {
        self.id == other.id
    }
}</code></pre>
<br>

<h5 id="ç­‰ä»·å…³ç³»ï¼šEq"><a href="#ç­‰ä»·å…³ç³»ï¼šEq" class="headerlink" title="ç­‰ä»·å…³ç³»ï¼šEq"></a><strong>ç­‰ä»·å…³ç³»ï¼šEq</strong></h5><p><code>Eq Trait</code> å®ç°äº† <a href="https://en.wikipedia.org/wiki/Equivalence_relation" target="_blank" rel="noopener">ç­‰ä»·å…³ç³» Equivalence_relation</a>ï¼Œè¯¥æ•°å€¼å…³ç³»å…·æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š</p>
<ul>
<li>å¯¹ç§°æ€§ (symmetric): å¦‚æœ <code>a == b</code>, é‚£ä¹ˆ <code>b == a</code></li>
<li>å¯ä¼ é€’æ€§ (transitive): å¦‚æœ <code>a == b</code> ä¸” <code>b == c</code>, é‚£ä¹ˆ <code>a == c</code></li>
<li>è‡ªåæ€§ (reflexive): <code>a == a</code></li>
</ul>
<p><font color="#f00"><strong><code>Eq Trait</code> åŸºäº <code>PartialEq Trait</code>ï¼Œä½†åœ¨æ­¤ä¹‹ä¸Šå¹¶æ²¡æœ‰æ·»åŠ æ–°çš„æ–¹æ³•å®šä¹‰ï¼›</strong></font></p>
<p><font color="#f00"><strong>è¿™ä¸ª Trait åªæ˜¯ç”¨äºç»™ç¼–è¯‘å™¨æç¤ºï¼šè¿™æ˜¯ä¸ª <code>ç­‰ä»½å…³ç³»</code> è€Œä¸æ˜¯ä¸ª <code>éƒ¨åˆ†ç­‰ä»·å…³ç³»</code>ï¼› å› ä¸ºç¼–è¯‘å™¨å¹¶ä¸èƒ½æ£€æµ‹ <code>è‡ªåæ€§ (reflexive)</code>ï¼</strong></font></p>
<p><strong>ä¾‹å¦‚ï¼Œåœ¨æ ‡å‡†åº“ä¸­, åªæœ‰ f32 å’Œ f64 æ²¡æœ‰å®ç° <code>Eq Trait</code>, å› ä¸ºæµ®ç‚¹å€¼æœ‰ä¸¤ä¸ªç‰¹æ®Šçš„å€¼ï¼š</strong></p>
<ul>
<li><strong>NANï¼›</strong></li>
<li><strong>INFINITYï¼›</strong></li>
</ul>
<p><strong>å®ƒä»¬æœ¬èº«æ˜¯ä¸å¯æ¯”è¾ƒçš„ï¼Œå³ï¼š <code>NAN != NAN</code>ï¼›</strong></p>
<p>æˆ‘ä»¬å¯ä»¥æ¥æµ‹è¯•ä¸€ä¸‹:</p>
<pre><code class="rust">println!(&quot;NAN == NAN ? {}&quot;, std::f64::NAN == std::f64::NAN);</code></pre>
<p>æ‰“å°çš„ç»“æœæ˜¯ï¼š</p>
<pre><code>NAN == NAN ? false</code></pre><p>æ‰€ä»¥ï¼Œä¸Šé¢çš„ç¤ºä¾‹ä¸­å®šä¹‰çš„ <code>struct Person</code> æ˜¯æ— æ³•ç”¨ <code>#[derive(Eq)]</code> çš„æ–¹æ³•å®šä¹‰çš„ï¼š</p>
<pre><code class="rust">#[derive(Eq)]
struct Person {
    pub id: u32,
    pub name: String,
    pub height: f64,
}</code></pre>
<p>ç¼–è¯‘å™¨ä¼šæŠ¥å‡ºä»¥ä¸‹é”™è¯¯ï¼š</p>
<pre><code class="bash">188 |     height: f64,
    |     ^^^^^^^^^^^ the trait `std::cmp::Eq` is not implemented for `f64`
    |
    = note: required by `std::cmp::AssertParamIsEq`</code></pre>
<p>ä½†æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨å®ç°è¯¥ Traitï¼š</p>
<pre><code class="rust">struct Person {
    pub id: u32,
    pub name: String,
    pub height: f64,
}

impl Eq for Person {}</code></pre>
<br>

<h5 id="ååºå…³ç³»ï¼šPartialOrd"><a href="#ååºå…³ç³»ï¼šPartialOrd" class="headerlink" title="ååºå…³ç³»ï¼šPartialOrd"></a><strong>ååºå…³ç³»ï¼šPartialOrd</strong></h5><p><code>PartialOrd Trait</code> åŸºäº <code>PartialEq Trait</code> å®ç°ï¼Œå®ƒæ–°å®šä¹‰äº†å‡ ä¸ªæ–¹æ³•ï¼š</p>
<ul>
<li>partial_cmpï¼šéœ€è¦ä½¿ç”¨è€…å®ç°æœ¬æ–¹æ³•ï¼Œè¿”å›ä¸¤å€¼çš„æ¯”è¾ƒç»“æœï¼›</li>
<li>lt, le, gt, ge å·²ç»å®šä¹‰å¥½ï¼›</li>
</ul>
<p>ååºå…³ç³»æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š</p>
<ul>
<li>ä¸å¯¹ç§°æ€§ antisymmetry: å¦‚æœ <code>a &lt; b</code> é‚£ä¹ˆ <code>!(a &gt; b)</code>ï¼›</li>
<li>å¯ä¼ é€’æ€§ transitive: å¦‚æœ <code>a &lt; b</code> ä¸” <code>b &lt; c</code> é‚£ä¹ˆ <code>a &lt; c</code>ï¼›</li>
</ul>
<p><strong>æ ‡å‡†åº“é‡Œçš„æ‰€æœ‰åŸºæœ¬ç±»å‹éƒ½å·²å®ç°è¯¥ Traitï¼›</strong></p>
<p><strong>è‡ªå®šä¹‰ç±»å‹å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>#[derive]</code> çš„æ–¹å¼ç”±ç¼–è¯‘å™¨å®ç°è¯¥ Traitï¼›</strong></p>
<p><strong>æˆ–è€…ä¹Ÿå¯åƒä¸‹é¢è¿™æ ·æ‰‹åŠ¨å®ç°ï¼ˆè¿™é‡Œæ˜¯ä»¥èº«é«˜æ¥æ’åºçš„ï¼‰ï¼š</strong></p>
<pre><code class="rust">impl PartialOrd for Person {
    fn partial_cmp(&amp;self, other: &amp;Self) -&gt; Option&lt;std::cmp::Ordering&gt; {
        self.height.partial_cmp(&amp;other.height)
    }
}</code></pre>
<br>

<h5 id="å…¨åºå…³ç³»ï¼šOrd"><a href="#å…¨åºå…³ç³»ï¼šOrd" class="headerlink" title="å…¨åºå…³ç³»ï¼šOrd"></a><strong>å…¨åºå…³ç³»ï¼šOrd</strong></h5><p><code>Ord Trait</code> åŸºäº <code>PartialOrd Trait</code> å’Œ <code>Eq Trait</code> å®ç°ï¼Œå®ƒæ–°å®šä¹‰äº†å‡ ä¸ªæ–¹æ³•ï¼š</p>
<ul>
<li>cmpï¼šéœ€è¦ä½¿ç”¨è€…å®ç°æœ¬æ–¹æ³•ï¼Œè¿”å›ä¸¤å€¼çš„æ¯”è¾ƒç»“æœï¼›</li>
<li>max, min, clamp å·²ç»å®šä¹‰å¥½ï¼›</li>
</ul>
<p>å…¨åºå…³ç³»æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š</p>
<ul>
<li><font color="#f00"><strong>å®Œæ•´çš„ä¸å¯¹ç§°æ€§ (total antisymmetry): <code>a &lt; b</code>, <code>a == b</code>, <code>a &gt; b</code> è¿™ä¸‰ç§ç»“æœåªæœ‰ä¸€ä¸ªæ˜¯çœŸï¼›</strong></font></li>
<li><font color="#f00"><strong>å¯ä¼ é€’æ€§ (transitive): å¦‚æœ <code>a &lt; b</code> ä¸” <code>b &lt; c</code> é‚£ä¹ˆ <code>a &lt; c</code>ï¼›</strong></font></li>
</ul>
<p><strong>åœ¨æ ‡å‡†åº“ä¸­ï¼Œf32 å’Œ f64 æ²¡æœ‰å®ç° <code>Ord Trait</code>ï¼</strong></p>
<p><strong>åŒæ ·æ˜¯å› ä¸ºï¼š <code>NAN</code> å’Œ <code>INFINITY</code> çš„ ä¸ç¡®å®šæ€§ï¼Œ <code>NAN</code> å’Œ <code>INFINITY</code> æ— æ³•è·Ÿå…¶å®ƒæµ®ç‚¹å€¼æ¯”è¾ƒå¤§å°ï¼›</strong></p>
<blockquote>
<p>  <strong>æ›´è¯¦ç»†å…³äº Rust ä¸­çš„æ¯”è¾ƒå¯è§ï¼š</strong></p>
<ul>
<li><a href="https://blog.biofan.org/2019/08/rust-cmp/" target="_blank" rel="noopener">https://blog.biofan.org/2019/08/rust-cmp/</a></li>
<li><a href="https://en.wikipedia.org/wiki/Equivalence_relation" target="_blank" rel="noopener">Equivalence_relation</a></li>
<li><a href="https://en.wikipedia.org/wiki/Partial_equivalence_relation" target="_blank" rel="noopener">Partial_equivalence_relation</a></li>
<li><a href="https://en.wikipedia.org/wiki/Total_order" target="_blank" rel="noopener">Total_order</a></li>
<li><a href="https://blog.biofan.org/2019/08/rust-cmp/cmp.rs" target="_blank" rel="noopener">nightly ç‰ˆçš„ cmp.rs æºä»£ç </a></li>
<li><a href="https://wenku.baidu.com/view/58f21acdba4cf7ec4afe04a1b0717fd5360cb29a.html" target="_blank" rel="noopener">Part 3 Equivalence relations ç­‰ä»·å…³ç³»ä¸ååºå…³ç³»</a></li>
</ul>
</blockquote>
<br>

<h4 id="å£°æ˜èŒƒå‹çº¦æŸ"><a href="#å£°æ˜èŒƒå‹çº¦æŸ" class="headerlink" title="å£°æ˜èŒƒå‹çº¦æŸ"></a><strong>å£°æ˜èŒƒå‹çº¦æŸ</strong></h4><p>æœ‰äº›æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦é™å®šèŒƒå‹çš„å…·ä½“ç±»å‹å®ç°äº†ä¸€äº› Trait ä¹‹åæ‰èƒ½ç»‘å®šå¦ä¸€äº›æ–¹æ³•ï¼ˆæœ€ç»å…¸çš„ï¼šæˆ‘ä»¬éœ€è¦çº¦æŸä¸€ä¸ªèŒƒå‹å¯æ¯”è¾ƒæ‰èƒ½ä¸ºå…¶å®ç°æ’åºï¼‰ï¼›</p>
<p>æ­¤æ—¶æˆ‘ä»¬å°±éœ€è¦åœ¨è¯´å®ç°çš„æ–¹æ³•ä¸­å£°æ˜èŒƒå‹çº¦æŸï¼›</p>
<p>Rust ä¸­å®ç°èŒƒå‹çº¦æŸçš„æ–¹å¼æœ‰ä¸¤ç§ï¼š</p>
<pre><code class="rust">impl &lt;A: TraitB + TraitC, D: TraitE + TraitF&gt; MyTrait&lt;A, D&gt; for YourType {}

// å½“åˆ†åˆ«æŒ‡å®šæ³›å‹çš„ç±»å‹å’Œçº¦æŸæ—¶ï¼Œä½¿ç”¨ where ä¼šæ›´æ¸…æ™°

impl &lt;A, D&gt; MyTrait&lt;A, D&gt; for YourType where
    A: TraitB + TraitC,
    D: TraitE + TraitF {}</code></pre>
<blockquote>
<p>  <strong>å…¶å®ç›®å‰ Golang ä¸­çš„èŒƒå‹ä¹Ÿæ˜¯é‡‡ç”¨äº†è¿™ç§æ–¹å¼æ¥å¯¹ç±»å‹åšé™åˆ¶ï¼›</strong></p>
<p>  <strong>ä½†æ˜¯ Golang ä¸­çš„èŒƒå‹å’Œ Rust ä¸­è¿˜æ˜¯éå¸¸ä¸ä¸€æ ·çš„ï¼</strong></p>
</blockquote>
<p><font color="#f00"><strong>Rust ä¸­çš„èŒƒå‹å’Œ C++ çš„å®ç°æ–¹å¼éå¸¸ç±»ä¼¼ï¼Œå³ï¼š</strong></font></p>
<p><font color="#f00"><strong>å¯¹æ¯ä¸€ç§å…·ä½“ç±»å‹ç”Ÿæˆå…¶å¯¹åº”çš„ä»£ç ï¼Œè€Œéç±»ä¼¼äº Java ä¸­çš„ç±»å‹æ“¦é™¤åè¿›è¡Œç±»å‹è½¬æ¢ï¼Œä»è€Œå®ç°äº†ï¼š<code>é›¶æˆæœ¬æŠ½è±¡</code>ï¼›</strong></font></p>
<p><font color="#f00"><strong>åŒæ—¶ï¼ŒRust åœ¨ç¼–è¯‘æ—¶ä¼šåˆ†æç©¶ç«Ÿæœ‰å“ªäº›ç±»å‹æ»¡è¶³äº†èŒƒå‹çº¦æŸï¼Œè€Œåªä¸ºé‚£äº›æ»¡è¶³äº†çº¦æŸçš„å…·ä½“ç±»å‹å®ç°æ–¹æ³•ï¼</strong></font></p>
<br>

<h3 id="â‘ª-ä¸ºå®ç°Debugå…ƒç´ çš„é“¾è¡¨å®ç°éå†è¾“å‡ºï¼štraverse"><a href="#â‘ª-ä¸ºå®ç°Debugå…ƒç´ çš„é“¾è¡¨å®ç°éå†è¾“å‡ºï¼štraverse" class="headerlink" title="â‘ª ä¸ºå®ç°Debugå…ƒç´ çš„é“¾è¡¨å®ç°éå†è¾“å‡ºï¼štraverse()"></a><strong>â‘ª ä¸ºå®ç°Debugå…ƒç´ çš„é“¾è¡¨å®ç°éå†è¾“å‡ºï¼štraverse()</strong></h3><p>ç»è¿‡ä¸Šé¢å¯¹èŒƒå‹çº¦æŸçš„è®²è§£ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºå®ç°äº† Debug Trait çš„ã€ç±»å‹ä¸ºèŒƒå‹ <code>&lt;T&gt;</code> å…ƒç´ å®ç°éå†æ‰“å°çš„æ–¹æ³•ï¼š</p>
<pre><code class="rust">impl&lt;T: Debug&gt; LinkedList&lt;T&gt; {
    pub fn traverse(&amp;self) {
        print!(&quot;{{ ");
        for (idx, x) in self.iter().enumerate() {
            print!(" [{}: {:?}] ", idx, *x)
        }
        println!(" }}&quot;);
    }
}</code></pre>
<p>æ­¤æ—¶ï¼š</p>
<p><strong>å¦‚æœå…·ä½“çš„ç±»å‹ T å®ç°äº† Debug Traitï¼Œåˆ™ Rust ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨çš„ä¸ºè£…æœ‰è¯¥ç±»å‹çš„é“¾è¡¨ç”Ÿæˆä¸Šé¢çš„æ–¹æ³•ï¼›</strong></p>
<p><strong>è€Œå¦‚æœç±»å‹ T å¹¶æœªå®ç° Debug Traitï¼Œæ­¤æ—¶ Rust ç¼–è¯‘å™¨ä¸ä¼šä¸ºå…¶å¯¹åº”çš„é“¾è¡¨ç±»å‹ç”Ÿæˆä¸Šé¢çš„æ–¹ï¼Œæ­¤æ—¶å¦‚æœåœ¨æ­¤é“¾è¡¨ä¸Šè°ƒç”¨äº† traverse æ–¹æ³•ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼Œä»è€Œä¿è¯äº†æ­£ç¡®çš„ç±»å‹çº¦æŸï¼</strong></p>
<p>åœ¨è¿™é‡Œï¼Œå¯èƒ½æœ‰äº›åŒå­¦ä¼šæœ‰ä¸€äº›ç–‘é—®ï¼šä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨ <code>#[derive]</code> è®©ç¼–è¯‘å™¨è‡ªåŠ¨å¸®æˆ‘ä»¬ç”Ÿæˆæ‰“å°é“¾è¡¨çš„æ–¹æ³•ï¼Ÿ</p>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code class="rust">#[derive(Debug)]
impl&lt;T&gt; LinkedList&lt;T&gt; {
  ......
}</code></pre>
<p>ç„¶è€Œï¼Œè¿™æ˜¯ä¸å¯èƒ½çš„ï¼</p>
<p>å› ä¸ºåœ¨æˆ‘ä»¬çš„åŒå‘é“¾è¡¨ä¸­ï¼šç›¸é‚»çš„ä¸¤ä¸ªèŠ‚ç‚¹å‡ä¸ºå¾ªç¯å¼•ç”¨ï¼</p>
<p><strong>å³ï¼šèŠ‚ç‚¹A â†” èŠ‚ç‚¹B</strong></p>
<p>å› æ­¤å¦‚æœä½¿ç”¨ç¼–è¯‘å™¨ä¸ºæˆ‘ä»¬ç”Ÿæˆçš„ä»£ç ï¼Œæˆ‘ä»¬å°†ä¼šé™·å…¥æ­»å¾ªç¯ï¼Œæ°¸è¿œä¹Ÿæ— æ³•é€€å‡ºè¾“å‡ºå¾ªç¯ï¼</p>
<blockquote>
<p>  å…³äºå¼•ç”¨å¾ªç¯ï¼Œè§ï¼š</p>
<ul>
<li><a href="https://kaisery.github.io/trpl-zh-cn/ch15-06-reference-cycles.html#å¼•ç”¨å¾ªç¯ä¸å†…å­˜æ³„æ¼" target="_blank" rel="noopener">å¼•ç”¨å¾ªç¯ä¸å†…å­˜æ³„æ¼</a></li>
</ul>
</blockquote>
<br>

<h3 id="â‘«-é‡Šæ”¾é“¾è¡¨Drop-Traitå’Œ-clear-æ–¹æ³•"><a href="#â‘«-é‡Šæ”¾é“¾è¡¨Drop-Traitå’Œ-clear-æ–¹æ³•" class="headerlink" title="â‘« é‡Šæ”¾é“¾è¡¨Drop Traitå’Œ clear()æ–¹æ³•"></a><strong>â‘« é‡Šæ”¾é“¾è¡¨Drop Traitå’Œ clear()æ–¹æ³•</strong></h3><p>å›é¡¾ä¹‹å‰ï¼Œæˆ‘ä»¬ä¸º IntoIter å®ç°äº† Drop Traitï¼›</p>
<p>è¿™æ˜¯å› ä¸ºï¼š <strong>IntoIter è·å–äº†é“¾è¡¨çš„å®Œæ•´æ‰€æœ‰æƒï¼Œå› æ­¤éœ€è¦ä»£æ›¿é“¾è¡¨ç®¡ç†å…¶å†…éƒ¨å…ƒç´ çš„å†…å­˜ï¼ˆæˆ–è€…è¯´æ˜¯ç”Ÿå‘½å‘¨æœŸï¼‰ï¼›</strong></p>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬<strong>è¿˜éœ€è¦ä¸ºé“¾è¡¨æœ¬èº«å®ç° Drop Traitï¼š</strong></p>
<p><font color="#f00"><strong>ä»¥ç¡®ä¿åœ¨é“¾è¡¨é€€å‡ºå…¶ä½œç”¨åŸŸåï¼ˆæ­¤åå†ä¹Ÿæ— æ³•è®¿é—®æ­¤é“¾è¡¨ï¼‰ï¼Œå†…éƒ¨å…ƒç´ çš„å†…å­˜èƒ½å¤Ÿæ­£å¸¸çš„è¢«é‡Šæ”¾ï¼›</strong></font></p>
<p>è¿™é‡Œåœ¨å®ç°æ—¶ï¼Œå‚è€ƒäº† Rust æºç ä¸­ LinkedList ä¸­ Drop Traitçš„å®ç°ï¼š</p>
<pre><code class="rust">impl&lt;T&gt; Drop for LinkedList&lt;T&gt; {
    fn drop(&amp;mut self) {
        struct DropGuard&lt;&#39;a, T&gt;(&amp;&#39;a mut LinkedList&lt;T&gt;);

        impl&lt;&#39;a, T&gt; Drop for DropGuard&lt;&#39;a, T&gt; {
            fn drop(&amp;mut self) {
                // Continue the same loop we do below. This only runs when a destructor has
                // panicked. If another one panics this will abort.
                while self.0.pop_front().is_some() {}
            }
        }

        while let Some(node) = self.pop_front() {
            let guard = DropGuard(self);
            drop(node);
            mem::forget(guard);
        }

        println!(&quot;LinkedList dropped!&quot;)
    }
}</code></pre>
<p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª DropGuardï¼Œå…¶å†…éƒ¨åªæœ‰ LinkedList ç±»å‹çš„å±æ€§ï¼Œå¹¶å†æ¬¡ä¸ºå…¶ä¹Ÿå®ç°äº† Drop Traitï¼š</p>
<pre><code class="rust">impl&lt;&#39;a, T&gt; Drop for DropGuard&lt;&#39;a, T&gt; {
  fn drop(&amp;mut self) {
    // Continue the same loop we do below. This only runs when a destructor has
    // panicked. If another one panics this will abort.
    while self.0.pop_front().is_some() {}
  }
}</code></pre>
<p>æ­¤å¤„å¦‚æ­¤è®¾è®¡çš„åŸå› æ˜¯ï¼š</p>
<p>ç¡®ä¿åœ¨æ‰§è¡Œä¸‹é¢è¿™æ®µé‡Šæ”¾é“¾è¡¨å…ƒç´ å ç”¨å†…å­˜çš„ä»£ç æ—¶ï¼š</p>
<pre><code class="rust">while let Some(node) = self.pop_front() {
  let guard = DropGuard(self);
  drop(node);
  mem::forget(guard);
}

println!(&quot;LinkedList dropped!&quot;)</code></pre>
<p>å¦‚æœå‡ºç°äº† panicï¼Œåˆ™æ­¤æ—¶ DropGuard å¯ä»¥å†æ¬¡å°è¯•é‡Šæ”¾å†…å­˜ï¼›</p>
<p>è€Œé‡Šæ”¾é“¾è¡¨å…ƒç´ æœ¬èº«çš„ä»£ç éå¸¸ç®€å•ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ï¼›</p>
<p>ä¸ºé“¾è¡¨å®ç°äº† Drop Trait ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆç®€å•çš„ä¸ºå…¶å®ç° clear æ–¹æ³•ï¼Œè€Œæ— éœ€æ‹…å¿ƒå†…å­˜æ³„éœ²ï¼Œä¸‹é¢æˆ‘ä»¬æ¥å®ç° clear æ–¹æ³•ï¼›</p>
<br>

<h4 id="å®ç°clear-æ–¹æ³•"><a href="#å®ç°clear-æ–¹æ³•" class="headerlink" title="å®ç°clear()æ–¹æ³•"></a><strong>å®ç°clear()æ–¹æ³•</strong></h4><p>clear æ–¹æ³•éå¸¸ç®€å•ï¼š</p>
<pre><code class="rust">pub fn clear(&amp;mut self) {
  *self = Self::new();
}</code></pre>
<p>è¿™æ˜¯å¾—ç›Šäºæˆ‘ä»¬ä¸ºåŒå‘é“¾è¡¨å®ç°äº† Drop Traitï¼›</p>
<p>å› æ­¤ï¼Œ<strong>æˆ‘ä»¬å¯ä»¥ç›´æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºåŒå‘é“¾è¡¨æ¥ç›´æ¥è¦†ç›–åŸé“¾è¡¨ï¼Œæ¥å®ç° clear() æ–¹æ³•ï¼›</strong></p>
<p><strong>è€ŒåŸé“¾è¡¨åœ¨é€€å‡ºä½œç”¨åŸŸä¹‹åä¼šè‡ªåŠ¨è°ƒç”¨å…¶ drop æ–¹æ³•ï¼Œæ¸…ç©ºå†…éƒ¨çš„èŠ‚ç‚¹ä»¥åŠå¯¹åº”å…ƒç´ ï¼Œé‡Šæ”¾å†…å­˜ï¼</strong></p>
<br>

<h2 id="ä¸ºé“¾è¡¨æ·»åŠ æµ‹è¯•ç”¨ä¾‹"><a href="#ä¸ºé“¾è¡¨æ·»åŠ æµ‹è¯•ç”¨ä¾‹" class="headerlink" title="ä¸ºé“¾è¡¨æ·»åŠ æµ‹è¯•ç”¨ä¾‹"></a><strong>ä¸ºé“¾è¡¨æ·»åŠ æµ‹è¯•ç”¨ä¾‹</strong></h2><p>åœ¨ Rust ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿çš„æ·»åŠ æµ‹è¯•ç”¨ä¾‹ï¼ˆç”šè‡³æ˜¯åœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­ï¼‰ï¼›</p>
<p>ä¸‹é¢æ˜¯ä¸ºé“¾è¡¨æ·»åŠ çš„ä¸€äº›æµ‹è¯•ç”¨ä¾‹ï¼š</p>
<pre><code class="rust">#[cfg(test)]
mod test {
    use crate::list::linked_list::LinkedList;

    #[test]
    fn test_compiling() {}

    #[test]
    fn test_push_and_pop() {
        let mut list = _new_list_i32();

        assert_eq!(list.length, 5);
        list.traverse();

        assert_eq!(list.pop_front(), Some(-1));
        assert_eq!(list.pop_back(), Some(i32::MAX));

        assert_eq!(list.length, 3);
        list.traverse();
    }

    #[test]
    fn test_peak() {
        let mut list = _new_list_string();

        assert_eq!(list.peek_front(), Some(&amp;String::from(&quot;abc&quot;)));
        assert_eq!(list.peek_back(), Some(&amp;String::from(&quot;hij&quot;)));

        let cur = list.peek_front_mut();
        assert_eq!(cur, Some(&amp;mut String::from(&quot;abc&quot;)));
        cur.map(|x| x.push(&#39; &#39;));

        let cur = list.peek_back_mut();
        assert_eq!(cur, Some(&amp;mut String::from(&quot;hij&quot;)));
        cur.map(|x| x.push(&#39; &#39;));

        assert_eq!(list.peek_front(), Some(&amp;String::from(&quot;abc &quot;)));
        assert_eq!(list.peek_back(), Some(&amp;String::from(&quot;hij &quot;)));
        assert_eq!(list.length, 3);

        list.traverse();
    }

    #[test]
    fn test_get_idx() {
        let list = _new_list_i32();

        assert_eq!(list.get_by_idx(2).unwrap(), Some(&amp;456));
        assert_eq!(list.get_by_idx(3).unwrap(), Some(&amp;789));

        print!(&quot;before change: &quot;);
        list.traverse();
        let cur = list.get_by_idx_mut(2).unwrap().unwrap();
        assert_eq!(cur, &amp;mut 456);

        *cur &lt;&lt;= 1;
        print!(&quot;after change: &quot;);
        list.traverse();

        assert_eq!(list.get_by_idx(2).unwrap(), Some(&amp;(456 &lt;&lt; 1)));
    }

    #[test]
    fn test_get_idx_err() {
        let list = _new_list_i32();

        assert!(list.get_by_idx(99).is_err());
        assert!(list.get_by_idx_mut(99).is_err());
    }

    #[test]
    fn test_insert_idx() {
        let mut list = LinkedList::new();

        list.push_back(String::from(&quot;1&quot;));
        list.push_back(String::from(&quot;2&quot;));
        list.push_back(String::from(&quot;3&quot;));

        list.insert_by_idx(1, String::from(&quot;99&quot;)).unwrap();
        list.traverse();

        assert_eq!(list.get_by_idx(0).unwrap(), Some(&amp;String::from(&quot;1&quot;)));
        assert_eq!(list.get_by_idx(1).unwrap(), Some(&amp;String::from(&quot;99&quot;)));
    }

    #[test]
    fn test_insert_idx_err() {
        let mut list = LinkedList::new();

        assert!(list.insert_by_idx(99, String::from(&quot;99&quot;)).is_err());
    }

    #[test]
    fn test_remove_idx() {
        let mut list = LinkedList::new();

        list.push_back(String::from(&quot;1&quot;));
        list.push_back(String::from(&quot;2&quot;));
        list.push_back(String::from(&quot;3&quot;));

        let removed = list.remove_by_idx(1).unwrap();
        list.traverse();

        assert_eq!(removed, String::from(&quot;2&quot;));

        assert_eq!(list.get_by_idx(0).unwrap(), Some(&amp;String::from(&quot;1&quot;)));
        assert_eq!(list.get_by_idx(1).unwrap(), Some(&amp;String::from(&quot;3&quot;)));
    }

    #[test]
    fn test_remove_idx_err() {
        let mut list: LinkedList&lt;i32&gt; = LinkedList::new();

        assert!(list.remove_by_idx(99).is_err());
    }

    #[test]
    fn test_contains() {
        let list = _new_list_i32();

        assert!(list.contains(&amp;-1));
        assert!(!list.contains(&amp;-2));
    }

    #[test]
    fn test_clear() {
        let mut list = _new_list_zst();

        assert_eq!(list.length(), 3);

        list.clear();

        assert_eq!(list.length(), 0);
    }

    #[test]
    fn test_iterator() {
        let mut list1 = _new_list_i32();

        print!(&quot;before change: &quot;);
        list1.traverse();
        list1.iter_mut().for_each(|x| *x = *x - 1);
        print!(&quot;after change: &quot;);
        list1.traverse();

        let list2 = _new_list_string();
        let list2_to_len = list2.into_iter().map(|x| x.len()).collect::&lt;Vec&lt;usize&gt;&gt;();
        println!(
            &quot;transform list2 into len vec, list2_to_len: {:?}&quot;,
            list2_to_len
        );

        // Compiling err:
        // list2.traverse()
    }

    struct ZeroSizeType {}

    fn _new_list_i32() -&gt; LinkedList&lt;i32&gt; {
        let mut list = LinkedList::new();

        list.push_front(456);
        list.push_front(123);
        list.push_back(789);
        list.push_front(-1);
        list.push_back(i32::MAX);

        list
    }

    fn _new_list_string() -&gt; LinkedList&lt;String&gt; {
        let mut list = LinkedList::new();

        list.push_front(String::from(&quot;def&quot;));
        list.push_front(String::from(&quot;abc&quot;));
        list.push_back(String::from(&quot;hij&quot;));

        list
    }

    fn _new_list_zst() -&gt; LinkedList&lt;ZeroSizeType&gt; {
        let mut list = LinkedList::new();

        list.push_front(ZeroSizeType {});
        list.push_front(ZeroSizeType {});
        list.push_back(ZeroSizeType {});

        list
    }
}</code></pre>
<p>æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å³å¯è¿›è¡Œæµ‹è¯•ï¼š</p>
<pre><code class="bash">$ cargo test      
   Compiling collection v0.1.0 (/Users/kylinkzhang/self-workspace/rust-learn/collection)
    Finished test [unoptimized + debuginfo] target(s) in 1.18s
     Running unittests (target/debug/deps/collection-617cd44adb150cd7)

running 12 tests
test list::linked_list::test::test_contains ... ok
test list::linked_list::test::test_clear ... ok
test list::linked_list::test::test_compiling ... ok
test list::linked_list::test::test_insert_idx_err ... ok
test list::linked_list::test::test_get_idx ... ok
test list::linked_list::test::test_get_idx_err ... ok
test list::linked_list::test::test_insert_idx ... ok
test list::linked_list::test::test_peak ... ok
test list::linked_list::test::test_remove_idx ... ok
test list::linked_list::test::test_remove_idx_err ... ok
test list::linked_list::test::test_iterator ... ok
test list::linked_list::test::test_push_and_pop ... ok

test result: ok. 12 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

   Doc-tests collection

running 2 tests
test src/list/linked_list.rs - list::linked_list::LinkedList&lt;T&gt;::contains (line 289) ... ok
test src/list/linked_list.rs - list::linked_list::LinkedList&lt;T&gt;::peek_front (line 141) ... ok

test result: ok. 2 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 1.39s</code></pre>
<p>é™¤äº†ä¼šæ‰§è¡Œç”± <code>mod test</code> å£°æ˜çš„æµ‹è¯•ç”¨ä¾‹ä¹‹å¤–ï¼Œ<code>cargo test</code> è¿˜ä¼šæµ‹è¯•ä»£ç æ³¨é‡Šä¸­çš„æµ‹è¯•ç”¨ä¾‹ï¼›</p>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code class="rust">/// Returns `true` if the `LinkedList` contains an element equal to the given value.
///
/// This operation should compute in *O*(*n*) time.
///
/// # Examples
///
/// ```
/// use collection::list::linked_list::LinkedList;
///
/// let mut list = LinkedList::new();
///
/// list.push_back(0);
/// list.push_back(1);
/// list.push_back(2);
///
/// assert_eq!(list.contains(&amp;0), true);
/// assert_eq!(list.contains(&amp;10), false);
/// ```
pub fn contains(&amp;self, elem: &amp;T) -&gt; bool
where
T: PartialEq&lt;T&gt;,
{
  self.iter().any(|x| x == elem)
}</code></pre>
<p>å¦å¤–ï¼Œéå¸¸å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘åœ¨æµ‹è¯•ç”¨ä¾‹ä¸­<strong>ç‰¹åˆ«åŠ å…¥äº†å¯¹ ZST(Zero-Size Type) çš„æµ‹è¯•ï¼›</strong></p>
<p>è¿™ä¸ªæµ‹è¯•æ˜¯éå¸¸é‡è¦çš„ï¼Œå› ä¸ºåœ¨ Rust ä¸­å……æ–¥ç€å¤§é‡<a href="https://nomicon.purewhite.io/exotic-sizes.html#é›¶å¤§å°ç±»å‹-zsts" target="_blank" rel="noopener">é›¶å¤§å°ç±»å‹ (ZSTs)</a>ï¼</p>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code class="rust">struct Nothing; // æ— å­—æ®µæ„å‘³ç€æ²¡æœ‰å¤§å°

// æ‰€æœ‰å­—æ®µéƒ½æ— å¤§å°æ„å‘³ç€æ•´ä¸ªç»“æ„ä½“æ— å¤§å°ï¼
struct LotsOfNothing {
    foo: Nothing,
    qux: (),      // ç©ºå…ƒç»„æ— å¤§å°
    baz: [u8; 0], // ç©ºæ•°ç»„æ— å¤§å°
}</code></pre>
<p>å°±å…¶æœ¬èº«è€Œè¨€ï¼Œé›¶å°ºå¯¸ç±»å‹ï¼ˆZSTsï¼‰ç”±äºæ˜¾è€Œæ˜“è§çš„åŸå› æ˜¯ç›¸å½“æ— ç”¨çš„ï¼›ç„¶è€Œï¼Œå°±åƒ Rust ä¸­è®¸å¤šå¥‡æ€ªçš„å¸ƒå±€é€‰æ‹©ä¸€æ ·ï¼Œå®ƒä»¬çš„æ½œåŠ›åœ¨é€šç”¨è¯­å¢ƒä¸­å¾—ä»¥å®ç°ï¼š</p>
<p><font color="#f00"><strong>åœ¨ Rust ä¸­ï¼Œä»»ä½•äº§ç”Ÿæˆ–å­˜å‚¨ ZST çš„æ“ä½œéƒ½å¯ä»¥è¢«ç®€åŒ–ä¸ºæ— æ“ä½œï¼ˆno-opï¼‰ï¼</strong></font></p>
<p>é¦–å…ˆï¼Œå­˜å‚¨å®ƒç”šè‡³æ²¡æœ‰æ„ä¹‰â€”â€”å®ƒä¸å ç”¨ä»»ä½•ç©ºé—´ï¼›å¦å¤–ï¼Œè¿™ç§ç±»å‹çš„å€¼åªæœ‰ä¸€ä¸ªï¼Œæ‰€ä»¥ä»»ä½•åŠ è½½å®ƒçš„æ“ä½œéƒ½å¯ä»¥ç›´æ¥å‡­ç©ºäº§ç”Ÿå®ƒâ€”â€”è¿™ä¹Ÿæ˜¯ä¸€ä¸ªæ— æ“ä½œï¼ˆno-opï¼‰ï¼Œå› ä¸ºå®ƒä¸å ç”¨ä»»ä½•ç©ºé—´ï¼›</p>
<p>è¿™æ–¹é¢æœ€æç«¯çš„ä¾‹å­ä¹‹ä¸€æ˜¯ Set å’Œ Mapï¼š</p>
<p>ç»™å®šä¸€ä¸ª<code>Map&lt;Key, Value&gt;</code>ï¼Œé€šå¸¸å¯ä»¥å®ç°ä¸€ä¸ª<code>Set&lt;Key&gt;</code>ï¼Œä½œä¸º<code>Map&lt;Key, UselessJunk&gt;</code>çš„ä¸€ä¸ªè–„å°è£…ï¼›</p>
<p>åœ¨è®¸å¤šè¯­è¨€ä¸­ï¼Œè¿™ä»ç„¶éœ€è¦ä¸ºæ— ç”¨çš„å°è£…åˆ†é…ç©ºé—´ï¼Œå¹¶è¿›è¡Œå­˜å‚¨å’ŒåŠ è½½æ— ç”¨å°è£…çš„å·¥ä½œï¼Œç„¶åå°†å…¶ä¸¢å¼ƒï¼›å› ä¸ºï¼Œé€šå¸¸æƒ…å†µä¸‹å¯¹äºç¼–è¯‘å™¨æ¥è¯´ï¼Œåˆ†æè¿™äº›ç±»å‹æ˜¯å¦æ˜¯æœ‰ç”¨çš„ï¼Œæ˜¯éå¸¸å›°éš¾çš„ï¼</p>
<p><strong>ç„¶è€Œåœ¨ Rust ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è¯´<code>Set&lt;Key&gt; = Map&lt;Key, ()&gt;</code>ï¼</strong></p>
<p><font color="#f00"><strong>è€Œ Rust å¯ä»¥é™æ€åœ°çŸ¥é“æ¯ä¸ªåŠ è½½å’Œå­˜å‚¨éƒ½æ˜¯æ— ç”¨çš„ï¼Œè€Œä¸”æ²¡æœ‰åˆ†é…æœ‰ä»»ä½•å¤§å°ï¼›å…¶ç»“æœæ˜¯ï¼Œå•ä¾‹åŒ–çš„ä»£ç åŸºæœ¬ä¸Šæ˜¯ HashSet çš„è‡ªå®šä¹‰å®ç°ï¼Œè€Œæ²¡æœ‰ä»»ä½• HashMap è¦æ”¯æŒå€¼æ‰€å¸¦æ¥çš„å¼€é”€ï¼</strong></font></p>
<p><font color="#f00"><strong>å®‰å…¨çš„ä»£ç ä¸éœ€è¦æ‹…å¿ƒ ZSTï¼Œä½†æ˜¯ Unsafe Rust å¿…é¡»å°å¿ƒæ²¡æœ‰å¤§å°çš„ç±»å‹çš„åæœï¼ç‰¹åˆ«æ˜¯ï¼ŒæŒ‡é’ˆåç§»æ˜¯æ— æ“ä½œçš„ï¼Œè€Œåˆ†é…å™¨é€šå¸¸<a href="https://doc.rust-lang.org/std/alloc/trait.GlobalAlloc.html#tymethod.alloc" target="_blank" rel="noopener">éœ€è¦ä¸€ä¸ªéé›¶çš„å¤§å°</a>ï¼›</strong></font></p>
<p><font color="#f00"><strong>å› æ­¤åœ¨è®¾è®¡æ—¶éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼šå¯¹ ZST çš„å¼•ç”¨ï¼ˆåŒ…æ‹¬ç©ºç‰‡ï¼‰ï¼Œå°±åƒæ‰€æœ‰å…¶ä»–çš„å¼•ç”¨ä¸€æ ·ï¼Œå¿…é¡»æ˜¯éç©ºçš„ï¼Œå¹¶ä¸”é€‚å½“åœ°å¯¹é½ï¼</strong></font></p>
<p><font color="#f00"><strong>è§£å¼•ç”¨ ZST çš„ç©ºæŒ‡é’ˆæˆ–æœªå¯¹é½æŒ‡é’ˆæ˜¯<a href="https://nomicon.purewhite.io/what-unsafe-does.html" target="_blank" rel="noopener">æœªå®šä¹‰çš„è¡Œä¸º</a>ï¼Œå°±åƒå…¶ä»–ç±»å‹çš„å¼•ç”¨ä¸€æ ·ï¼›</strong></font></p>
<blockquote>
<p>  æ›´å¤šå…³äº ZST è§ï¼š</p>
<ul>
<li><a href="https://nomicon.purewhite.io/exotic-sizes.html#éæ­£å¸¸å¤§å°çš„ç±»å‹" target="_blank" rel="noopener">éæ­£å¸¸å¤§å°çš„ç±»å‹</a></li>
</ul>
</blockquote>
<br>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h2><p>å‘¼å‘¼~ï¼ä½ ç»ˆäºåœ¨ Rust ä¸­å®ç°äº†ä¸€ä¸ªä»¤äººæ»¡æ„çš„åŒå‘é“¾è¡¨ï¼Œå¹¶åŠ å…¥äº†å¤§é‡çš„æµ‹è¯•ç”¨ä¾‹æ¥ä¿è¯å…¶é€»è¾‘çš„æ­£ç¡®æ€§ï¼</p>
<p>ç»è¿‡äº†å®ç°è¿™ä¸ªåŒå‘é“¾è¡¨ï¼Œæˆ‘æƒ³ä½ åº”è¯¥èƒ½å­¦åˆ°ä¸‹é¢è¿™ä¹ˆå¤šå†…å®¹ï¼š</p>
<ul>
<li>Unsafe ç”¨æ³•ï¼›</li>
<li>é€†å˜ã€åå˜å’Œä¸å˜ï¼›</li>
<li>Rust ä¸­éƒ¨åˆ†ç±»å‹çš„ç”¨æ³•ï¼š<ul>
<li>NonNullï¼›</li>
<li>PhantomDataï¼›</li>
<li>Optionï¼›</li>
<li>â€¦â€¦</li>
</ul>
</li>
<li>Rust ä¸­çš„å¸¸ç”¨ Traitï¼š<ul>
<li>Defaultï¼›</li>
<li>Copyï¼›</li>
<li>Cloneï¼›</li>
<li>â€¦â€¦</li>
</ul>
</li>
<li>Rustä¸­çš„æ¯”è¾ƒï¼š<ul>
<li>PartialEq</li>
<li>Eq</li>
<li>PartialOrd</li>
<li>Ord</li>
</ul>
</li>
<li>Rust ä¸­çš„ å•å…ƒæµ‹è¯•ã€æ–‡æ¡£æµ‹è¯•ä»¥åŠæ–‡æ¡£æ³¨é‡Šï¼›</li>
<li>Rust ä¸­çš„ä¸‰ç§è¿­ä»£å™¨ï¼šIntoIterã€Iter å’Œ IterMutï¼›</li>
<li>Rust ä¸­çš„é”™è¯¯å¤„ç†ä»¥åŠå¦‚ä½•è‡ªå®šä¹‰é”™è¯¯ç±»å‹ï¼›</li>
<li>â€¦â€¦</li>
</ul>
<br>

<h1 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a><strong>é™„å½•</strong></h1><p>æºä»£ç ï¼š</p>
<ul>
<li><a href="https://github.com/JasonkayZK/rust-learn/blob/algorithm/collection/src/list/linked_list.rs" target="_blank" rel="noopener">https://github.com/JasonkayZK/rust-learn/blob/algorithm/collection/src/list/linked_list.rs</a></li>
<li><a href="https://github.com/JasonkayZK/rust-learn/tree/algorithm/too-many-lists" target="_blank" rel="noopener">https://github.com/JasonkayZK/rust-learn/tree/algorithm/too-many-lists</a></li>
</ul>
<p>ç›¸å…³ä¹¦ç±æ¨èï¼š</p>
<ul>
<li><a href="https://doc.rust-lang.org/book/#the-rust-programming-language" target="_blank" rel="noopener">The Rust Programming Language</a></li>
<li><a href="https://course.rs/" target="_blank" rel="noopener">Rustè¯­è¨€åœ£ç»(Rustæ•™ç¨‹ Rust Course)</a></li>
<li><a href="https://rust-unofficial.github.io/too-many-lists/index.html#learn-rust-with-entirely-too-many-linked-lists" target="_blank" rel="noopener">Learn Rust With Entirely Too Many Linked Lists</a></li>
<li><a href="https://doc.rust-lang.org/nomicon/" target="_blank" rel="noopener">The Rustonomicon</a></li>
<li><a href="https://exphp.github.io/unsafe-gotchas/intro.html" target="_blank" rel="noopener">Unsafe Gotchas</a></li>
</ul>
<br>

  </article>

  <div id="like-container" style="text-align: center">
    <div class="like-feed">
      <p>è§‰å¾—æœ¬æ–‡ä¸é”™å°±ç‚¹ä¸ª<span>â™¥</span>å†èµ°å§~</p>
      <div class="like-img">
        <div class="like-heart" id="like" rel="like"></div>
        <div class="like-count" id="like-count"></div>
      </div>
    </div>
  </div>

  <!-- æ–‡ç« åˆ†äº« -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>
  <div class="social-share" data-mode="prepend" data-disabled="tencent,diandian"></div>
  <br>

  
  
<div class="nexmoe-post-copyright">
<i class="mdui-list-item-icon nexmoefont icon-info-circle"></i>
<strong>æœ¬æ–‡ä½œè€…ï¼š</strong>Jasonkay<br>
<strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="https://jasonkayzk.github.io/2022/02/20/ä½¿ç”¨Rustå®ç°ä¸€ä¸ªåŒå‘é“¾è¡¨/" title="https://jasonkayzk.github.io/2022/02/20/ä½¿ç”¨Rustå®ç°ä¸€ä¸ªåŒå‘é“¾è¡¨/" target="_blank" rel="noopener">https://jasonkayzk.github.io/2022/02/20/ä½¿ç”¨Rustå®ç°ä¸€ä¸ªåŒå‘é“¾è¡¨/</a><br>

  <strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬æ–‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/cn/deed.zh" target="_blank">CC BY-NC-SA 3.0 CN</a> åè®®è¿›è¡Œè®¸å¯

</div>


  

  <!-- å¢åŠ é¢è¯•ç‚¹å‡»æ ‡é¢˜æ‰æ˜¾ç¤ºç­”æ¡ˆç­‰æ•ˆæœ! -->
  <!-- <script type="text/javascript">
    $(".question").click(function () {
      var a = $(".answer").eq($(".question").index(this));
      a.is(".answer_shown") ? a.animate({ 'opacity': '1' }, 800).removeClass("answer_shown") : a.animate({ 'opacity': '0' }, 800).addClass("answer_shown");
    });
  </script> -->
  <!-- <style>
    .answer_shown {
      opacity: 0;
    }
  </style> -->

  <!-- åŠ è½½åšå®¢ç‚¹èµåŠŸèƒ½ -->
  <script>
    function ajax(options) {
      return new Promise(function (resolve, reject) {
        $.ajax(options).done(resolve).fail(reject);
      });
    }

    var docName = $('meta[property="og:title"]').attr('content');
    
    // è·³è¿‡localhost
    if (location.hostname !== 'localhost') {
      // åˆå§‹åŒ–
      ajax({
        url: "https://service-rvqf6dam-1257829547.gz.apigw.tencentcs.com/blog_like/",
        type: 'post',
        contentType: 'application/json; charset=utf-8',
        data: JSON.stringify({
          "actionId": "get",
          "docName": docName
        })
      }).then(
        function fulfillHandler(data) {
          $('#like-count').text(data.likeNum);
        },
        function rejectHandler(jqXHR, textStatus, errorThrown) {
          $('#like-count').text(0);
          console.log(jqXHR, textStatus, errorThrown);
        }
      ).catch(function errorHandler(error) {
        $('#like-count').text(0);
        console.log(error);
      });

      $(document).ready(function () {
        $(".like-heart").on("click", function () {
          var heart = $(this);
          var likeCount = $("#like-count" + heart.attr("id").split("like")[1]);
          var intCount = parseInt(likeCount.html());
          var rel = heart.attr("rel");

          if (rel === "like") {
            likeCount.html(intCount + 1);
            heart.addClass("like-heartAnimation").attr("rel", "unlike");
            ajax({
              url: "https://service-rvqf6dam-1257829547.gz.apigw.tencentcs.com/blog_like/",
              type: 'post',
              contentType: 'application/json; charset=utf-8',
              data: JSON.stringify({
                "actionId": "add",
                "docName": docName
              })
            }).catch(function errorHandler(error) {
              console.log(error);
            });
          } else {
            likeCount.html(intCount - 1);
            heart.removeClass("like-heartAnimation").attr("rel", "like");
            heart.css("background-position", "left");
            ajax({
              url: "https://service-rvqf6dam-1257829547.gz.apigw.tencentcs.com/blog_like/",
              type: 'post',
              contentType: 'application/json; charset=utf-8',
              data: JSON.stringify({
                "actionId": "subtract",
                "docName": docName
              })
            }).catch(function errorHandler(error) {
              console.log(error);
            });
          }
        }).on("mouseleave", function () {
          $(this).css("background-position", "");
        });
      });
    }
  </script>
  <style>
    #like-container {
      margin: 0 auto;
      width: 100%;
    }

    .like-img {
      width: 200px;
      height: 100px;
      display: inline-block;
    }

    .like-heart {
      float: left;
      background: url(/images/web_heart_animation.png);
      background-position: left;
      background-repeat: no-repeat;
      height: 50px;
      width: 120px;
      left: -14px;
      background-size: 2900%;
    }

    .like-count {
      float: left;
      font-family: 'Georgia', Times, Times New Roman, serif;
      font-size: 35px;
      color: #999999;
      text-align: left;
      height: 50px;
      width: 50px;
      line-height: 44px;
    }

    .like-heart:hover,
    .like-heart:focus {
      background-position: right;
    }

    @-webkit-keyframes heartBlast {
      0% {
        background-position: left;
      }

      100% {
        background-position: right;
      }
    }

    @keyframes heartBlast {
      0% {
        background-position: left;
      }

      100% {
        background-position: right;
      }
    }

    .like-heartAnimation {
      display: inline-block;
      -webkit-animation-name: heartBlast;
      animation-name: heartBlast;
      -webkit-animation-duration: .8s;
      animation-duration: .8s;
      -webkit-animation-iteration-count: 1;
      animation-iteration-count: 1;
      -webkit-animation-timing-function: steps(28);
      animation-timing-function: steps(28);
      background-position: right;
    }

    .like-feed {
      height: 90px;
      margin-bottom: 20px;
      text-align: center
    }

    .like-feed p {
      font-family: 'microsoft yahei', 'Georgia';
      font-size: 25px;
    }

    .like-feed span {
      font-size: 30px;
      color: #D33115;
    }
  </style>

  <section class="nexmoe-comment">
    <div class="utterances"></div>
<style>
    .v .vwrap {
      border: 1px dashed #c4bfbf
    }
  
    .v .vwrap .vheader .vinput {
      border-bottom: 1px dashed #c4bfbf
    }
</style>
<script src="https://utteranc.es/client.js" repo="JasonkayZK/JasonkayZK.github.io" issue-term="title" label="commentâœ¨ğŸ’¬âœ¨" theme="github-light" crossorigin="anonymous" async>
</script>

</section>
</div>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/mdui@0.4.3/dist/js/mdui.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
 
    <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>


 
    <script src="https://cdn.jsdelivr.net/npm/smoothscroll-for-websites@1.4.9/SmoothScroll.min.js"></script>


<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.16.2/build/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script src="/js/app.js?v=1770725320885"></script>
<script src="https://cdn.jsdelivr.net/npm/lazysizes@5.1.0/lazysizes.min.js"></script>




  
    <!-- Google Analytics -->
<script>
    window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
    ga('create', 'G-1NWK4EEKDF', 'auto');
    ga('send', 'pageview');
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>






    <!-- baidu Analytics -->
<script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?5f5ec71a32c11ff54dff64d0341017b0";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
</script>

</body>

<!-- é¡µé¢ç‚¹å‡»å°çº¢å¿ƒ -->
<!-- 
<script type="text/javascript">
  !function (e, t, a) { function n() { c(".heart{width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: fixed;}.heart:after{top: -5px;}.heart:before{left: -5px;}"), o(), r() } function r() { for (var e = 0; e < d.length; e++)d[e].alpha <= 0 ? (t.body.removeChild(d[e].el), d.splice(e, 1)) : (d[e].y--, d[e].scale += .004, d[e].alpha -= .013, d[e].el.style.cssText = "left:" + d[e].x + "px;top:" + d[e].y + "px;opacity:" + d[e].alpha + ";transform:scale(" + d[e].scale + "," + d[e].scale + ") rotate(45deg);background:" + d[e].color + ";z-index:99999"); requestAnimationFrame(r) } function o() { var t = "function" == typeof e.onclick && e.onclick; e.onclick = function (e) { t && t(), i(e) } } function i(e) { var a = t.createElement("div"); a.className = "heart", d.push({ el: a, x: e.clientX - 5, y: e.clientY - 5, scale: 1, alpha: 1, color: s() }), t.body.appendChild(a) } function c(e) { var a = t.createElement("style"); a.type = "text/css"; try { a.appendChild(t.createTextNode(e)) } catch (t) { a.styleSheet.cssText = e } t.getElementsByTagName("head")[0].appendChild(a) } function s() { return "rgb(" + ~~(255 * Math.random()) + "," + ~~(255 * Math.random()) + "," + ~~(255 * Math.random()) + ")" } var d = []; e.requestAnimationFrame = function () { return e.requestAnimationFrame || e.webkitRequestAnimationFrame || e.mozRequestAnimationFrame || e.oRequestAnimationFrame || e.msRequestAnimationFrame || function (e) { setTimeout(e, 1e3 / 60) } }(), n() }(window, document);
</script>
 -->
 
<script>
  // è¿›åº¦æ¡åŠ è½½: nprogress
  NProgress.start()
  NProgress.done()
</script>

<script type="text/javascript" defer>
  $(document).ready(function () {
    $.goup({
      trigger: 100,
      bottomOffset: 50,
      locationOffset: 50,
      title: '0%',
      titleAsText: true
    });
    $(".goup-container").css("background", "#64dcf0 none repeat scroll 0% 0%").css("opacity", 0.9);
    $(".goup-text").css("font-weight", 600).css("opacity", 0.9);
  });

  $(document).scroll(function () {
    var d_h = $(document).height();
    var c_h = $(window).height();
    var c_t_h = $(window).scrollTop();
    var schedule = c_t_h / (d_h - c_h - 0.5);
    var str = Number(schedule * 100).toFixed();
    str += "%";
    $(".goup-text").text(str);
  });
</script>

<!-- ç«™å†…é€šçŸ¥ -->
<script src="/js/notification.js"></script>
<script>
  'use strict';

  (function () {
    $(function () {
      $('.position').click(function (event) {
        var el = $(event.target);
        $('.position').removeClass('selected');
        el.addClass('selected');
        position = el.attr('data-position');
      });
    });
  });

  var position = 2;
  // å…³é—­ç™¾æ¯«ç§’æ•°
  var closeTime = 50;
  var notifyFunc = function () {
    // Notification.create(
    //   //Â Title
    //   "Tencentå†…æ¨ä¸­ğŸ“§",
    //   //Â Text
    //   "ç®€å†æŠ•é€’å¤„ï¼š<BR/><a href='/hiring/'>ç®€å†æŠ•é€’</a>",
    //   //Â Illustration
    //   "/images/avatar4.jpg",
    //   //Â Effect
    //   'fadeInRight',
    //   //Â PositionÂ 1, 2,Â 3,Â 4
    //   position,
    //   closeTime
    // );
    // setTimeout(() => {
    //   Notification.create(
    //     "èµ„æºä¸‹è½½âš¡",
    //     "ä¼ é€é—¨ï¼š<BR/><a href='/sharing/'>æ–‡ä»¶åˆ†äº«</a>",
    //     "/images/avatar4.jpg",
    //     'fadeInRight',
    //     position,
    //     closeTime
    //   )
    // }, 350);
    setTimeout(() => {
      Notification.create(
        "RSSè®¢é˜…ğŸ“¢",
        "ä¼ é€é—¨ï¼š<BR/><a href='/atom.xml'>RSSè®¢é˜…</a>",
        "/images/avatar4.jpg",
        'fadeInRight',
        position,
        closeTime
      )
    }, 0);
    setTimeout(() => {
        Notification.create(
        "åœ¨çº¿ç¾¤èŠğŸ’­",
        "ä¼ é€é—¨ï¼š<BR/><a href='/chat/'>ç•…æ‰€æ¬²è¨€</a>",
        "/images/avatar4.jpg",
        'fadeInRight',
        position,
        closeTime
      )
    }, 350);
    setTimeout(() => {
        Notification.create(
        // "è·‘æ­¥å¥èº«ğŸƒ",
        // "ä¼ é€é—¨ï¼š<BR/><a href='/running/'>è·‘æ­¥å¥èº«</a>",
        "æ‘„å½±åˆ†äº«ğŸ“·",
        "ä¼ é€é—¨ï¼š<BR/><a href='http://159.75.131.252:32352/'>æ‘„å½±åˆ†äº«</a>",
        "/images/avatar4.jpg",
        'fadeInRight',
        position,
        closeTime
      )
    }, 700);
  };

  (function once() {
    if (sessionStorage.getItem('load') == null) {
      notifyFunc();
      sessionStorage.setItem('load', false);
    } else {
      return;
    }
  })();
</script>
<script>
  $(document).on("click", ".dismiss", function (e) {
    Notification.hide(e.currentTarget.classList[1].split('-')[1]);
  })
</script>

</html>